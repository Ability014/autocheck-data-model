[0m00:29:48.512206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6F4B60F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6F739EF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6F3A0CDC0>]}


============================== 00:29:48.516216 | 58dd94a7-df49-4141-a953-fbfef9e36eb0 ==============================
[0m00:29:48.516216 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:29:48.517998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:48.519000 [info ] [MainThread]: dbt version: 1.7.11
[0m00:29:48.521212 [info ] [MainThread]: python version: 3.9.13
[0m00:29:48.522220 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m00:29:48.523324 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m00:29:49.520440 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m00:29:49.522280 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m00:29:49.523287 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thinkbook 14\venv\dbt_jaffle_shop\dbt_project.yml
[0m00:29:49.524287 [info ] [MainThread]: adapter type: snowflake
[0m00:29:49.525286 [info ] [MainThread]: adapter version: 1.7.3
[0m00:29:49.590118 [info ] [MainThread]: Configuration:
[0m00:29:49.598994 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:29:49.600560 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:29:49.601556 [info ] [MainThread]: Required dependencies:
[0m00:29:49.603581 [debug] [MainThread]: Executing "git --help"
[0m00:29:49.631271 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:29:49.632278 [debug] [MainThread]: STDERR: "b''"
[0m00:29:49.632278 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:29:49.634122 [info ] [MainThread]: Connection:
[0m00:29:49.635149 [info ] [MainThread]:   account: sx05674.europe-west2.gcp
[0m00:29:49.636844 [info ] [MainThread]:   user: AIRBYTE014
[0m00:29:49.638166 [info ] [MainThread]:   database: FIRST_DE_PROJ
[0m00:29:49.639162 [info ] [MainThread]:   warehouse: AIRBYTE_WAREHOUSE
[0m00:29:49.640171 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m00:29:49.641257 [info ] [MainThread]:   schema: PUBLIC
[0m00:29:49.642154 [info ] [MainThread]:   authenticator: None
[0m00:29:49.644145 [info ] [MainThread]:   oauth_client_id: None
[0m00:29:49.646238 [info ] [MainThread]:   query_tag: None
[0m00:29:49.647237 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:29:49.648235 [info ] [MainThread]:   host: None
[0m00:29:49.649236 [info ] [MainThread]:   port: None
[0m00:29:49.650220 [info ] [MainThread]:   proxy_host: None
[0m00:29:49.652226 [info ] [MainThread]:   proxy_port: None
[0m00:29:49.652867 [info ] [MainThread]:   protocol: None
[0m00:29:49.653865 [info ] [MainThread]:   connect_retries: 1
[0m00:29:49.654892 [info ] [MainThread]:   connect_timeout: None
[0m00:29:49.655896 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:29:49.657002 [info ] [MainThread]:   retry_all: False
[0m00:29:49.657875 [info ] [MainThread]:   insecure_mode: False
[0m00:29:49.659869 [info ] [MainThread]:   reuse_connections: None
[0m00:29:49.660870 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:29:49.661974 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:29:49.663978 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:29:49.665206 [debug] [MainThread]: On debug: select 1 as id
[0m00:29:49.665206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:51.156996 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:29:51.168536 [debug] [MainThread]: On debug: Close
[0m00:29:51.606955 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:29:51.608231 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:29:51.610231 [debug] [MainThread]: Command `dbt debug` succeeded at 00:29:51.610231 after 3.19 seconds
[0m00:29:51.611234 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:29:51.612360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6F4B60F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6982EDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6982F49A0>]}
[0m00:29:51.613715 [debug] [MainThread]: Flushing usage events
[0m00:31:06.589107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B952FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B83ECEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B83ECC10>]}


============================== 00:31:06.593104 | b72462a8-39e8-4325-b5f5-cd7c7417988c ==============================
[0m00:31:06.593104 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:31:06.595116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:31:07.806806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b72462a8-39e8-4325-b5f5-cd7c7417988c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B83ECF40>]}
[0m00:31:07.893184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b72462a8-39e8-4325-b5f5-cd7c7417988c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DCB5F820>]}
[0m00:31:07.897454 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:31:07.910417 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:31:07.915584 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:31:07.916651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b72462a8-39e8-4325-b5f5-cd7c7417988c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DCD01280>]}
[0m00:31:09.700361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b72462a8-39e8-4325-b5f5-cd7c7417988c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DD2B20D0>]}
[0m00:31:09.724923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b72462a8-39e8-4325-b5f5-cd7c7417988c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DD1C0C70>]}
[0m00:31:09.726294 [info ] [MainThread]: Found 2 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:31:09.726921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b72462a8-39e8-4325-b5f5-cd7c7417988c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DD1C0340>]}
[0m00:31:09.728922 [info ] [MainThread]: 
[0m00:31:09.730908 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:31:09.734182 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:31:09.748849 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:31:09.749830 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:31:09.750850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:13.360032 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.0 seconds
[0m00:31:13.362301 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:31:13.734212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_FIRST_DE_PROJ, now create_FIRST_DE_PROJ_PUBLIC)
[0m00:31:13.746549 [debug] [ThreadPool]: Creating schema "database: "FIRST_DE_PROJ"
schema: "PUBLIC"
"
[0m00:31:13.754615 [debug] [ThreadPool]: Using snowflake connection "create_FIRST_DE_PROJ_PUBLIC"
[0m00:31:13.754615 [debug] [ThreadPool]: On create_FIRST_DE_PROJ_PUBLIC: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "create_FIRST_DE_PROJ_PUBLIC"} */
create schema if not exists FIRST_DE_PROJ.PUBLIC
[0m00:31:13.754615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:31:15.082941 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b3b7a3-0000-7ef4-0000-d21d00075a6a
[0m00:31:15.083941 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:31:15.085932 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m00:31:15.085932 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:31:15.086933 [debug] [ThreadPool]: On create_FIRST_DE_PROJ_PUBLIC: Close
[0m00:31:15.603968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:15.606089 [debug] [MainThread]: Connection 'create_FIRST_DE_PROJ_PUBLIC' was properly closed.
[0m00:31:15.606601 [info ] [MainThread]: 
[0m00:31:15.607752 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.88 seconds (5.88s).
[0m00:31:15.609778 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m00:31:15.613734 [debug] [MainThread]: Command `dbt seed` failed at 00:31:15.613145 after 9.09 seconds
[0m00:31:15.613734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0B952FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DCD019D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0DD2CAE80>]}
[0m00:31:15.614757 [debug] [MainThread]: Flushing usage events
[0m00:31:47.173221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D30F0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D2149910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D3957F40>]}


============================== 00:31:47.177563 | 90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10 ==============================
[0m00:31:47.177563 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:31:47.180025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:31:48.336524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6738730>]}
[0m00:31:48.413548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F682BDC0>]}
[0m00:31:48.420454 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:31:48.423973 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:31:48.508980 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:31:48.510956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6918340>]}
[0m00:31:49.594335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6EB10D0>]}
[0m00:31:49.606705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6E216A0>]}
[0m00:31:49.607707 [info ] [MainThread]: Found 2 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:31:49.609719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6CC28E0>]}
[0m00:31:49.612050 [info ] [MainThread]: 
[0m00:31:49.613648 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:31:49.616082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:31:49.617101 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:31:49.617101 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:31:49.630698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:50.664245 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m00:31:50.666614 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:31:51.023485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:31:51.026895 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:31:51.026895 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:31:51.035989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:31:52.113222 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 1.0 seconds
[0m00:31:52.115671 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:31:52.810062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6918820>]}
[0m00:31:52.819188 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:31:52.821205 [info ] [MainThread]: 
[0m00:31:52.827362 [debug] [Thread-1  ]: Began running node seed.dbt_jaffle_shop.customers
[0m00:31:52.828893 [debug] [Thread-2  ]: Began running node seed.dbt_jaffle_shop.orders
[0m00:31:52.829924 [info ] [Thread-1  ]: 1 of 3 START seed file RAW.customers ........................................... [RUN]
[0m00:31:52.832827 [info ] [Thread-2  ]: 2 of 3 START seed file RAW.orders .............................................. [RUN]
[0m00:31:52.835179 [debug] [Thread-1  ]: Acquiring new snowflake connection 'seed.dbt_jaffle_shop.customers'
[0m00:31:52.836763 [debug] [Thread-2  ]: Acquiring new snowflake connection 'seed.dbt_jaffle_shop.orders'
[0m00:31:52.838161 [debug] [Thread-1  ]: Began compiling node seed.dbt_jaffle_shop.customers
[0m00:31:52.838760 [debug] [Thread-2  ]: Began compiling node seed.dbt_jaffle_shop.orders
[0m00:31:52.840763 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.customers (compile): 00:31:52.839771 => 00:31:52.839771
[0m00:31:52.841974 [debug] [Thread-2  ]: Timing info for seed.dbt_jaffle_shop.orders (compile): 00:31:52.841768 => 00:31:52.841768
[0m00:31:52.842996 [debug] [Thread-1  ]: Began executing node seed.dbt_jaffle_shop.customers
[0m00:31:52.843995 [debug] [Thread-2  ]: Began executing node seed.dbt_jaffle_shop.orders
[0m00:31:52.889588 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.customers"
[0m00:31:52.902775 [debug] [Thread-2  ]: Using snowflake connection "seed.dbt_jaffle_shop.orders"
[0m00:31:52.903670 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.customers"} */
create table FIRST_DE_PROJ.RAW.customers (ID integer,FIRST_NAME text,LAST_NAME text)
[0m00:31:52.904681 [debug] [Thread-2  ]: On seed.dbt_jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.orders"} */
create table FIRST_DE_PROJ.RAW.orders (ID integer,USER_ID integer,ORDER_DATE date,STATUS text)
[0m00:31:52.905675 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:31:52.907242 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:31:53.925809 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:31:53.951308 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.customers"
[0m00:31:53.951308 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.customers"} */
BEGIN
[0m00:31:53.985856 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:31:53.985856 [debug] [Thread-2  ]: Using snowflake connection "seed.dbt_jaffle_shop.orders"
[0m00:31:53.985856 [debug] [Thread-2  ]: On seed.dbt_jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.orders"} */
BEGIN
[0m00:31:54.190972 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:31:54.192985 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:31:54.195985 [debug] [Thread-2  ]: Using snowflake connection "seed.dbt_jaffle_shop.orders"
[0m00:31:54.198982 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.customers"
[0m00:31:54.199972 [debug] [Thread-2  ]: On seed.dbt_jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.orders"} */
insert into FIRST_DE_PROJ.RAW.orders (ID, USER_ID, ORDER_DATE, STATUS) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%...
[0m00:31:54.201980 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.customers"} */
insert into FIRST_DE_PROJ.RAW.customers (ID, FIRST_NAME, LAST_NAME) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%...
[0m00:31:55.464095 [debug] [Thread-1  ]: SQL status: SUCCESS 100 in 1.0 seconds
[0m00:31:55.465087 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.customers"
[0m00:31:55.465597 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.customers"} */
COMMIT
[0m00:31:55.519267 [debug] [Thread-2  ]: SQL status: SUCCESS 99 in 1.0 seconds
[0m00:31:55.520279 [debug] [Thread-2  ]: Using snowflake connection "seed.dbt_jaffle_shop.orders"
[0m00:31:55.521246 [debug] [Thread-2  ]: On seed.dbt_jaffle_shop.orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.orders"} */
COMMIT
[0m00:31:55.850801 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:31:55.851811 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:31:55.871825 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.dbt_jaffle_shop.orders"
[0m00:31:55.873665 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbt_jaffle_shop.customers"
[0m00:31:55.914846 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.customers (execute): 00:31:52.843995 => 00:31:55.914846
[0m00:31:55.916831 [debug] [Thread-2  ]: Timing info for seed.dbt_jaffle_shop.orders (execute): 00:31:52.857694 => 00:31:55.915852
[0m00:31:55.918247 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.customers: Close
[0m00:31:55.918824 [debug] [Thread-2  ]: On seed.dbt_jaffle_shop.orders: Close
[0m00:31:56.271366 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F705C640>]}
[0m00:31:56.286912 [info ] [Thread-1  ]: 1 of 3 OK loaded seed file RAW.customers ....................................... [[32mINSERT 100[0m in 3.44s]
[0m00:31:56.288121 [debug] [Thread-1  ]: Finished running node seed.dbt_jaffle_shop.customers
[0m00:31:56.289376 [debug] [Thread-1  ]: Began running node seed.dbt_jaffle_shop.payments
[0m00:31:56.290396 [info ] [Thread-1  ]: 3 of 3 START seed file RAW.payments ............................................ [RUN]
[0m00:31:56.293478 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.customers, now seed.dbt_jaffle_shop.payments)
[0m00:31:56.294501 [debug] [Thread-1  ]: Began compiling node seed.dbt_jaffle_shop.payments
[0m00:31:56.295075 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.payments (compile): 00:31:56.295075 => 00:31:56.295075
[0m00:31:56.295075 [debug] [Thread-1  ]: Began executing node seed.dbt_jaffle_shop.payments
[0m00:31:56.307096 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.payments"
[0m00:31:56.308124 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.payments: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.payments"} */
create table FIRST_DE_PROJ.RAW.payments (ID integer,ORDERID integer,PAYMENTMETHOD text,STATUS text,AMOUNT integer,CREATED date)
[0m00:31:56.309100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:31:56.427868 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F7077670>]}
[0m00:31:56.428948 [info ] [Thread-2  ]: 2 of 3 OK loaded seed file RAW.orders .......................................... [[32mINSERT 99[0m in 3.59s]
[0m00:31:56.430570 [debug] [Thread-2  ]: Finished running node seed.dbt_jaffle_shop.orders
[0m00:31:57.156476 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:31:57.156476 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.payments"
[0m00:31:57.156476 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.payments: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.payments"} */
BEGIN
[0m00:31:57.394538 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:31:57.402632 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.payments"
[0m00:31:57.403655 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.payments: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.payments"} */
insert into FIRST_DE_PROJ.RAW.payments (ID, ORDERID, PAYMENTMETHOD, STATUS, AMOUNT, CREATED) values
            (%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s,%s),(%s,%s,%s,%s,...
[0m00:31:58.108126 [debug] [Thread-1  ]: SQL status: SUCCESS 120 in 1.0 seconds
[0m00:31:58.108126 [debug] [Thread-1  ]: Using snowflake connection "seed.dbt_jaffle_shop.payments"
[0m00:31:58.118228 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.payments: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "seed.dbt_jaffle_shop.payments"} */
COMMIT
[0m00:31:58.554410 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m00:31:58.565091 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.dbt_jaffle_shop.payments"
[0m00:31:58.570118 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.payments (execute): 00:31:56.296097 => 00:31:58.569116
[0m00:31:58.571096 [debug] [Thread-1  ]: On seed.dbt_jaffle_shop.payments: Close
[0m00:31:58.921792 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90f2dad8-90e3-4fb7-9fd9-c9e2f65fde10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F709B4C0>]}
[0m00:31:58.921792 [info ] [Thread-1  ]: 3 of 3 OK loaded seed file RAW.payments ........................................ [[32mINSERT 120[0m in 2.63s]
[0m00:31:58.927118 [debug] [Thread-1  ]: Finished running node seed.dbt_jaffle_shop.payments
[0m00:31:58.930141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:31:58.930141 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:31:58.931139 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:31:58.932140 [debug] [MainThread]: Connection 'seed.dbt_jaffle_shop.payments' was properly closed.
[0m00:31:58.932140 [debug] [MainThread]: Connection 'seed.dbt_jaffle_shop.orders' was properly closed.
[0m00:31:58.933382 [info ] [MainThread]: 
[0m00:31:58.934753 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.32 seconds (9.32s).
[0m00:31:58.936769 [debug] [MainThread]: Command end result
[0m00:31:58.947962 [info ] [MainThread]: 
[0m00:31:58.948963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:31:58.950957 [info ] [MainThread]: 
[0m00:31:58.952474 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:31:58.954458 [debug] [MainThread]: Command `dbt seed` succeeded at 00:31:58.954458 after 11.85 seconds
[0m00:31:58.955456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D30F0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6BB6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193F6C4E160>]}
[0m00:31:58.956463 [debug] [MainThread]: Flushing usage events
[0m00:34:06.441974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D10B00EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0F9ACBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0F9AC8B0>]}


============================== 00:34:06.448003 | 76acfce2-9103-47db-9e16-c0d1f3537bbe ==============================
[0m00:34:06.448003 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:34:06.450154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m customer_orders', 'send_anonymous_usage_stats': 'True'}
[0m00:34:07.641800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D0F9CB430>]}
[0m00:34:07.726589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3424E490>]}
[0m00:34:07.728309 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:34:07.738186 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:34:07.885388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:34:07.886386 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\customer_orders.sql
[0m00:34:08.005246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D346430D0>]}
[0m00:34:08.017462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D344A4EB0>]}
[0m00:34:08.018467 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:34:08.019460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D344A4E50>]}
[0m00:34:08.020676 [info ] [MainThread]: 
[0m00:34:08.022695 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:08.025153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:34:08.028235 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:34:08.028235 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:34:08.040030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:14.218190 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.0 seconds
[0m00:34:14.231533 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:34:14.877491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:34:14.880935 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:34:14.880935 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:34:14.880935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:15.911511 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 1.0 seconds
[0m00:34:15.914506 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:34:16.692285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D34324130>]}
[0m00:34:16.694286 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:34:16.696289 [info ] [MainThread]: 
[0m00:34:16.701281 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:34:16.702365 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW.customer_orders ................................ [RUN]
[0m00:34:16.704446 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:34:16.705456 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:34:16.707110 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:34:16.709790 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:34:16.706084 => 00:34:16.708781
[0m00:34:16.710797 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:34:16.736927 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.customer_orders"
[0m00:34:16.740926 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.customer_orders"
[0m00:34:16.741682 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.customer_orders"} */
create or replace   view FIRST_DE_PROJ.RAW.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m00:34:16.742706 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:34:17.922005 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b3b7a6-0000-7ef4-0000-d21d00075ac6
[0m00:34:17.923026 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m00:34:17.924030 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:34:16.711308 => 00:34:17.923026
[0m00:34:17.924030 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: Close
[0m00:34:19.774084 [debug] [Thread-1  ]: Database Error in model customer_orders (models\customer_orders.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\customer_orders.sql
[0m00:34:19.775085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76acfce2-9103-47db-9e16-c0d1f3537bbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D347F4670>]}
[0m00:34:19.776088 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model RAW.customer_orders ....................... [[31mERROR[0m in 3.07s]
[0m00:34:19.777087 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:34:19.780091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:19.780091 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:34:19.781097 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:34:19.782559 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.customer_orders' was properly closed.
[0m00:34:19.784088 [info ] [MainThread]: 
[0m00:34:19.785088 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.76 seconds (11.76s).
[0m00:34:19.787089 [debug] [MainThread]: Command end result
[0m00:34:19.801210 [info ] [MainThread]: 
[0m00:34:19.802987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:34:19.803533 [info ] [MainThread]: 
[0m00:34:19.804632 [error] [MainThread]:   Database Error in model customer_orders (models\customer_orders.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\customer_orders.sql
[0m00:34:19.806497 [info ] [MainThread]: 
[0m00:34:19.808427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:34:19.811446 [debug] [MainThread]: Command `dbt run` failed at 00:34:19.810857 after 13.43 seconds
[0m00:34:19.812021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D10B00EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3424E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D341A6A30>]}
[0m00:34:19.813208 [debug] [MainThread]: Flushing usage events
[0m00:37:12.300341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE46A80F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4592CE20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4592CC10>]}


============================== 00:37:12.304865 | fa83e248-d7ea-4147-8922-df6978814e42 ==============================
[0m00:37:12.304865 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:37:12.308907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m customer_orders', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:37:13.434397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE492AE880>]}
[0m00:37:13.514045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A0F0640>]}
[0m00:37:13.514045 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:37:13.530084 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:37:13.672095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:13.673109 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\customer_orders.sql
[0m00:37:13.808602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A5C30D0>]}
[0m00:37:13.819791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE492C67F0>]}
[0m00:37:13.820794 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:37:13.822453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A0B3C10>]}
[0m00:37:13.823461 [info ] [MainThread]: 
[0m00:37:13.826415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:13.828611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:37:13.831623 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:37:13.831623 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:37:13.831623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:21.994431 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 8.0 seconds
[0m00:37:21.996952 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:37:22.536621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:37:22.547026 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:37:22.548198 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:37:22.549210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:23.710821 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 1.0 seconds
[0m00:37:23.710821 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:37:24.989395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A184C40>]}
[0m00:37:24.989395 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:37:24.994895 [info ] [MainThread]: 
[0m00:37:24.999444 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:37:25.000462 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW.customer_orders ................................ [RUN]
[0m00:37:25.003268 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:37:25.004270 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:37:25.007269 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:37:25.008263 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:37:25.005279 => 00:37:25.008263
[0m00:37:25.009271 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:37:25.034911 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.customer_orders"
[0m00:37:25.039682 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.customer_orders"
[0m00:37:25.039682 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.customer_orders"} */
create or replace   view FIRST_DE_PROJ.RAW.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM first_de_proj.raw.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from first_de_proj.raw.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join first_de_proj.raw.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from first_de_proj.raw.customers C 
left join first_de_proj.raw.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m00:37:25.040684 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:37:26.742547 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b3b7a9-0000-7ef4-0000-d21d00075ad6
[0m00:37:26.743207 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'FIRST_DE_PROJ.RAW.PAYMENT' does not exist or not authorized.
[0m00:37:26.744364 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:37:25.010282 => 00:37:26.744305
[0m00:37:26.745551 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: Close
[0m00:37:27.190427 [debug] [Thread-1  ]: Database Error in model customer_orders (models\customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_DE_PROJ.RAW.PAYMENT' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\customer_orders.sql
[0m00:37:27.191425 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa83e248-d7ea-4147-8922-df6978814e42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A7756A0>]}
[0m00:37:27.192557 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model RAW.customer_orders ....................... [[31mERROR[0m in 2.19s]
[0m00:37:27.194425 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:37:27.196405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:27.197432 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:37:27.197432 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:37:27.198430 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.customer_orders' was properly closed.
[0m00:37:27.198430 [info ] [MainThread]: 
[0m00:37:27.200279 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 13.37 seconds (13.37s).
[0m00:37:27.202297 [debug] [MainThread]: Command end result
[0m00:37:27.212847 [info ] [MainThread]: 
[0m00:37:27.214180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:37:27.215192 [info ] [MainThread]: 
[0m00:37:27.217413 [error] [MainThread]:   Database Error in model customer_orders (models\customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'FIRST_DE_PROJ.RAW.PAYMENT' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\customer_orders.sql
[0m00:37:27.218418 [info ] [MainThread]: 
[0m00:37:27.219417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:37:27.221410 [debug] [MainThread]: Command `dbt run` failed at 00:37:27.221410 after 14.99 seconds
[0m00:37:27.222414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE46A80F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A0F0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE6A276850>]}
[0m00:37:27.223169 [debug] [MainThread]: Flushing usage events
[0m00:38:43.092411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342B11F430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023429FCC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023429FCC820>]}


============================== 00:38:43.097923 | 544cc9a2-7934-47ab-a831-6bf0c74aed6a ==============================
[0m00:38:43.097923 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:38:43.099435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m customer_orders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:38:44.266837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023429FEBF10>]}
[0m00:38:44.334422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344E943B20>]}
[0m00:38:44.334422 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:38:44.357472 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:38:44.497299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:44.498322 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\customer_orders.sql
[0m00:38:44.626663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344EC630D0>]}
[0m00:38:44.639660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344E836A00>]}
[0m00:38:44.640659 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:38:44.642642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344E836EE0>]}
[0m00:38:44.643652 [info ] [MainThread]: 
[0m00:38:44.646646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:38:44.648587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:38:44.662641 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:38:44.663164 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:38:44.663904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:51.292329 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 7.0 seconds
[0m00:38:51.294552 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:38:51.821682 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:38:51.830066 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:38:51.831066 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:38:51.832066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:53.030030 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 1.0 seconds
[0m00:38:53.033054 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:38:53.785428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344E7FA3D0>]}
[0m00:38:53.787144 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:38:53.788820 [info ] [MainThread]: 
[0m00:38:53.797128 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:38:53.798324 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW.customer_orders ................................ [RUN]
[0m00:38:53.801154 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:38:53.802874 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:38:53.807073 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:38:53.809217 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:38:53.804112 => 00:38:53.808637
[0m00:38:53.810505 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:38:53.846097 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.customer_orders"
[0m00:38:53.849979 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.customer_orders"
[0m00:38:53.851091 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.customer_orders"} */
create or replace   view FIRST_DE_PROJ.RAW.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM first_de_proj.raw.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from first_de_proj.raw.payments
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join first_de_proj.raw.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from first_de_proj.raw.customers C 
left join first_de_proj.raw.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m00:38:53.852207 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:38:55.603064 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:38:55.622895 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:38:53.811303 => 00:38:55.622895
[0m00:38:55.622895 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: Close
[0m00:38:56.982616 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '544cc9a2-7934-47ab-a831-6bf0c74aed6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344EE15C70>]}
[0m00:38:56.983960 [info ] [Thread-1  ]: 1 of 1 OK created sql view model RAW.customer_orders ........................... [[32mSUCCESS 1[0m in 3.18s]
[0m00:38:56.986751 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:38:56.988763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:56.990218 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:38:56.990218 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:38:56.991358 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.customer_orders' was properly closed.
[0m00:38:56.991358 [info ] [MainThread]: 
[0m00:38:56.992991 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.35 seconds (12.35s).
[0m00:38:56.995420 [debug] [MainThread]: Command end result
[0m00:38:57.005414 [info ] [MainThread]: 
[0m00:38:57.006437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:57.008413 [info ] [MainThread]: 
[0m00:38:57.009414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:38:57.011499 [debug] [MainThread]: Command `dbt run` succeeded at 00:38:57.011499 after 13.98 seconds
[0m00:38:57.013043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002342B11F430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023429FEBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002344E909340>]}
[0m00:38:57.014048 [debug] [MainThread]: Flushing usage events
[0m00:16:09.057423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B2D6A08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B2C54D070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B2C54D100>]}


============================== 00:16:09.065060 | d0700439-ce98-4131-9a66-8cac73ced787 ==============================
[0m00:16:09.065060 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:16:09.066933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m customer_orders', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:16:14.501378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B2C5696D0>]}
[0m00:16:14.609839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B50CCDC40>]}
[0m00:16:14.612641 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:16:14.616666 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:16:15.635234 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m00:16:15.635234 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\Legacy\_sources.yml
[0m00:16:15.638055 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\Legacy\customer_orders.sql
[0m00:16:15.638055 [debug] [MainThread]: Partial parsing: deleted file: dbt_jaffle_shop://models\customer_orders.sql
[0m00:16:15.833606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B511C80D0>]}
[0m00:16:15.848808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B50F4FB80>]}
[0m00:16:15.849809 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:16:15.850806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B50F4FA90>]}
[0m00:16:15.851910 [info ] [MainThread]: 
[0m00:16:15.854402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:16:15.856937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:16:15.857950 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:16:15.857950 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:16:15.871065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:20.541351 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 5.0 seconds
[0m00:16:20.543371 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:16:20.903573 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:16:20.914636 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:16:20.914636 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:16:20.915875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:21.726302 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 1.0 seconds
[0m00:16:21.729805 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:16:22.069062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B50DEE310>]}
[0m00:16:22.069062 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:16:22.078291 [info ] [MainThread]: 
[0m00:16:22.094770 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:16:22.095350 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW.customer_orders ................................ [RUN]
[0m00:16:22.098356 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:16:22.099355 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:16:22.103487 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:16:22.105484 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:16:22.099355 => 00:16:22.105484
[0m00:16:22.106489 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:16:22.134244 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.customer_orders"
[0m00:16:22.138541 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.customer_orders"
[0m00:16:22.139918 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.customer_orders"} */
create or replace   view FIRST_DE_PROJ.RAW.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM FIRST_DE_PROJ.RAW.payments as orders --first_de_proj.raw.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from FIRST_DE_PROJ.RAW.payments --first_de_proj.raw.payments
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join FIRST_DE_PROJ.RAW.customers as C --first_de_proj.raw.customers C 
on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from first_de_proj.raw.customers C 
left join FIRST_DE_PROJ.RAW.orders as orders --first_de_proj.raw.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m00:16:22.139918 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:16:23.295551 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b3bd34-0000-7f66-0000-d21d000824aa
[0m00:16:23.296100 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'ORDERS.USER_ID'
[0m00:16:23.297205 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:16:22.106489 => 00:16:23.297205
[0m00:16:23.298272 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: Close
[0m00:16:23.719117 [debug] [Thread-1  ]: Database Error in model customer_orders (models\Legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'ORDERS.USER_ID'
  compiled Code at target\run\dbt_jaffle_shop\models\Legacy\customer_orders.sql
[0m00:16:23.719117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0700439-ce98-4131-9a66-8cac73ced787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B50EBD520>]}
[0m00:16:23.719117 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model RAW.customer_orders ....................... [[31mERROR[0m in 1.62s]
[0m00:16:23.725824 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:16:23.728829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:23.730307 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:16:23.730307 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:16:23.731681 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.customer_orders' was properly closed.
[0m00:16:23.731681 [info ] [MainThread]: 
[0m00:16:23.733003 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m00:16:23.735018 [debug] [MainThread]: Command end result
[0m00:16:23.746236 [info ] [MainThread]: 
[0m00:16:23.747239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:16:23.749234 [info ] [MainThread]: 
[0m00:16:23.750292 [error] [MainThread]:   Database Error in model customer_orders (models\Legacy\customer_orders.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'ORDERS.USER_ID'
  compiled Code at target\run\dbt_jaffle_shop\models\Legacy\customer_orders.sql
[0m00:16:23.751499 [info ] [MainThread]: 
[0m00:16:23.752503 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:16:23.755501 [debug] [MainThread]: Command `dbt run` failed at 00:16:23.754510 after 14.79 seconds
[0m00:16:23.755501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B2D6A08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B50CCDC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015B5144ADF0>]}
[0m00:16:23.756700 [debug] [MainThread]: Flushing usage events
[0m00:17:11.497078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DBE03880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DE62E3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DACAC3A0>]}


============================== 00:17:11.502595 | 804d89e3-b803-452f-a81a-4349754e88f7 ==============================
[0m00:17:11.502595 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:17:11.504400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m customer_orders', 'send_anonymous_usage_stats': 'True'}
[0m00:17:12.643356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF4C19A0>]}
[0m00:17:12.718519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF4F3490>]}
[0m00:17:12.725738 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:17:12.728754 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:17:12.866266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:17:12.867725 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Legacy\customer_orders.sql
[0m00:17:12.987835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF94C0D0>]}
[0m00:17:13.001968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF723220>]}
[0m00:17:13.001968 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:17:13.003966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF7230D0>]}
[0m00:17:13.004977 [info ] [MainThread]: 
[0m00:17:13.007106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:13.010284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:17:13.013150 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:17:13.013150 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:17:13.013150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:14.016438 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m00:17:14.032579 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:17:14.344623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:17:14.346315 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:17:14.346315 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:17:14.355819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:15.070079 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 1.0 seconds
[0m00:17:15.072088 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:17:15.418138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF47A640>]}
[0m00:17:15.418138 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:17:15.434156 [info ] [MainThread]: 
[0m00:17:15.438748 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:17:15.439765 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW.customer_orders ................................ [RUN]
[0m00:17:15.442264 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:17:15.443746 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:17:15.447749 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:17:15.449860 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:17:15.443746 => 00:17:15.449860
[0m00:17:15.451199 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:17:15.478850 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.customer_orders"
[0m00:17:15.482175 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.customer_orders"
[0m00:17:15.483670 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.customer_orders"} */
create or replace   view FIRST_DE_PROJ.RAW.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM FIRST_DE_PROJ.RAW.orders as orders --first_de_proj.raw.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from FIRST_DE_PROJ.RAW.payments --first_de_proj.raw.payments
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join FIRST_DE_PROJ.RAW.customers as C --first_de_proj.raw.customers C 
on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from first_de_proj.raw.customers C 
left join FIRST_DE_PROJ.RAW.orders as orders --first_de_proj.raw.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m00:17:15.484693 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:17:16.876703 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:17:16.899946 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:17:15.451199 => 00:17:16.899498
[0m00:17:16.900787 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: Close
[0m00:17:17.265516 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '804d89e3-b803-452f-a81a-4349754e88f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF925640>]}
[0m00:17:17.266526 [info ] [Thread-1  ]: 1 of 1 OK created sql view model RAW.customer_orders ........................... [[32mSUCCESS 1[0m in 1.82s]
[0m00:17:17.268514 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:17:17.271865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:17.272598 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:17:17.273587 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:17:17.274584 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.customer_orders' was properly closed.
[0m00:17:17.274584 [info ] [MainThread]: 
[0m00:17:17.276576 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m00:17:17.277579 [debug] [MainThread]: Command end result
[0m00:17:17.288781 [info ] [MainThread]: 
[0m00:17:17.290801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:17:17.292807 [info ] [MainThread]: 
[0m00:17:17.294437 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:17:17.296420 [debug] [MainThread]: Command `dbt run` succeeded at 00:17:17.296420 after 5.86 seconds
[0m00:17:17.297520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7DBE03880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF4CC070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF470D90>]}
[0m00:17:17.297699 [debug] [MainThread]: Flushing usage events
[0m00:17:27.543649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228714C3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873CE7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873CE7910>]}


============================== 00:17:27.547332 | 4437e23a-3851-4351-ad4c-1f8de8a5e81e ==============================
[0m00:17:27.547332 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:17:27.549278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:17:28.742610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4437e23a-3851-4351-ad4c-1f8de8a5e81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873CE7940>]}
[0m00:17:28.835150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4437e23a-3851-4351-ad4c-1f8de8a5e81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022873CFF1F0>]}
[0m00:17:28.836921 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:17:28.839424 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:17:28.967875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:28.967875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:28.978235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4437e23a-3851-4351-ad4c-1f8de8a5e81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287FED3F10>]}
[0m00:17:28.984801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4437e23a-3851-4351-ad4c-1f8de8a5e81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287FE14280>]}
[0m00:17:28.985828 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:17:28.986830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4437e23a-3851-4351-ad4c-1f8de8a5e81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287FE14340>]}
[0m00:17:28.989035 [info ] [MainThread]: 
[0m00:17:28.991192 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:17:28.995105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:17:29.011056 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:17:29.012123 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:17:29.013045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:30.035013 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 1.0 seconds
[0m00:17:30.037033 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:17:30.370120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4437e23a-3851-4351-ad4c-1f8de8a5e81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287FCF9E50>]}
[0m00:17:30.370120 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:17:30.378623 [info ] [MainThread]: 
[0m00:17:30.384780 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:17:30.384780 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:17:30.386759 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:17:30.388688 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.my_first_dbt_model'
[0m00:17:30.389667 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:17:30.391257 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:17:30.394273 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:17:30.401739 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.my_first_dbt_model"
[0m00:17:30.403748 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:17:30.392282 => 00:17:30.402757
[0m00:17:30.405658 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:17:30.406699 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_first_dbt_model (compile): 00:17:30.394273 => 00:17:30.406699
[0m00:17:30.407785 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:17:30.407785 => 00:17:30.407785
[0m00:17:30.409910 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:17:30.411907 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:17:30.412904 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_first_dbt_model (execute): 00:17:30.412904 => 00:17:30.412904
[0m00:17:30.413926 [debug] [Thread-1  ]: Began running node seed.dbt_jaffle_shop.customers
[0m00:17:30.415874 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:17:30.417927 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.customer_orders, now seed.dbt_jaffle_shop.customers)
[0m00:17:30.419049 [debug] [Thread-2  ]: Began running node seed.dbt_jaffle_shop.orders
[0m00:17:30.420423 [debug] [Thread-1  ]: Began compiling node seed.dbt_jaffle_shop.customers
[0m00:17:30.421905 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.my_first_dbt_model, now seed.dbt_jaffle_shop.orders)
[0m00:17:30.424901 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.customers (compile): 00:17:30.422921 => 00:17:30.424901
[0m00:17:30.426563 [debug] [Thread-2  ]: Began compiling node seed.dbt_jaffle_shop.orders
[0m00:17:30.427502 [debug] [Thread-1  ]: Began executing node seed.dbt_jaffle_shop.customers
[0m00:17:30.431962 [debug] [Thread-2  ]: Timing info for seed.dbt_jaffle_shop.orders (compile): 00:17:30.429014 => 00:17:30.431962
[0m00:17:30.432962 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.customers (execute): 00:17:30.432962 => 00:17:30.432962
[0m00:17:30.434966 [debug] [Thread-2  ]: Began executing node seed.dbt_jaffle_shop.orders
[0m00:17:30.435992 [debug] [Thread-1  ]: Finished running node seed.dbt_jaffle_shop.customers
[0m00:17:30.437795 [debug] [Thread-2  ]: Timing info for seed.dbt_jaffle_shop.orders (execute): 00:17:30.437795 => 00:17:30.437795
[0m00:17:30.439264 [debug] [Thread-1  ]: Began running node seed.dbt_jaffle_shop.payments
[0m00:17:30.441278 [debug] [Thread-2  ]: Finished running node seed.dbt_jaffle_shop.orders
[0m00:17:30.443510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.customers, now seed.dbt_jaffle_shop.payments)
[0m00:17:30.445482 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:17:30.446916 [debug] [Thread-1  ]: Began compiling node seed.dbt_jaffle_shop.payments
[0m00:17:30.448098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.orders, now model.dbt_jaffle_shop.my_second_dbt_model)
[0m00:17:30.449108 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.payments (compile): 00:17:30.449108 => 00:17:30.449108
[0m00:17:30.452829 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:17:30.453854 [debug] [Thread-1  ]: Began executing node seed.dbt_jaffle_shop.payments
[0m00:17:30.457081 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.my_second_dbt_model"
[0m00:17:30.458780 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.payments (execute): 00:17:30.457081 => 00:17:30.457081
[0m00:17:30.461784 [debug] [Thread-1  ]: Finished running node seed.dbt_jaffle_shop.payments
[0m00:17:30.462779 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:17:30.463795 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_second_dbt_model (compile): 00:17:30.453854 => 00:17:30.463173
[0m00:17:30.465171 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.payments, now test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m00:17:30.466313 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:17:30.467211 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:17:30.468476 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_second_dbt_model (execute): 00:17:30.468229 => 00:17:30.468229
[0m00:17:30.482853 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:17:30.484856 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:17:30.486302 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:17:30.488314 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.my_second_dbt_model, now test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m00:17:30.489322 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:17:30.489322 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 00:17:30.469213 => 00:17:30.489322
[0m00:17:30.501124 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m00:17:30.501978 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:17:30.503980 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 00:17:30.503980 => 00:17:30.503980
[0m00:17:30.505459 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:17:30.506471 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:17:30.507471 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 00:17:30.490308 => 00:17:30.506471
[0m00:17:30.509605 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m00:17:30.510349 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:17:30.511350 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:17:30.512209 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 00:17:30.512209 => 00:17:30.512209
[0m00:17:30.514476 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m00:17:30.519769 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:17:30.520525 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:17:30.522085 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m00:17:30.523283 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 00:17:30.513227 => 00:17:30.523104
[0m00:17:30.524298 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:17:30.526298 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:17:30.527298 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m00:17:30.532589 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 00:17:30.527298 => 00:17:30.527298
[0m00:17:30.534271 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:17:30.535741 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 00:17:30.526298 => 00:17:30.535741
[0m00:17:30.536758 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:17:30.537760 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 00:17:30.536758 => 00:17:30.536758
[0m00:17:30.538769 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:17:30.540748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:30.541737 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:17:30.542748 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m00:17:30.543762 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m00:17:30.546742 [debug] [MainThread]: Command end result
[0m00:17:30.704538 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m00:17:30.704538 [info ] [MainThread]: Building catalog
[0m00:17:30.710310 [debug] [ThreadPool]: Acquiring new snowflake connection 'FIRST_DE_PROJ.information_schema'
[0m00:17:30.713130 [debug] [ThreadPool]: Using snowflake connection "FIRST_DE_PROJ.information_schema"
[0m00:17:30.713130 [debug] [ThreadPool]: On FIRST_DE_PROJ.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "FIRST_DE_PROJ.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from FIRST_DE_PROJ.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_first_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('payments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customer_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_second_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('orders')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from FIRST_DE_PROJ.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_first_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('payments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customer_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_second_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('orders')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m00:17:30.724328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:34.669606 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 4.0 seconds
[0m00:17:34.672257 [debug] [ThreadPool]: On FIRST_DE_PROJ.information_schema: Close
[0m00:17:35.023371 [info ] [MainThread]: Catalog written to C:\Users\Thinkbook 14\venv\dbt_jaffle_shop\target\catalog.json
[0m00:17:35.026285 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:17:35.025735 after 7.55 seconds
[0m00:17:35.026832 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:17:35.027939 [debug] [MainThread]: Connection 'FIRST_DE_PROJ.information_schema' was properly closed.
[0m00:17:35.028536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228714C3EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002287FED3A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228150589D0>]}
[0m00:17:35.029617 [debug] [MainThread]: Flushing usage events
[0m00:17:44.351788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D945D0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D96E0BAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D94D938B0>]}


============================== 00:17:44.355526 | 109363f1-025b-4b83-ba8a-7a9089892460 ==============================
[0m00:17:44.355526 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:17:44.357606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:45.501868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '109363f1-025b-4b83-ba8a-7a9089892460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D9347C760>]}
[0m00:17:45.586043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '109363f1-025b-4b83-ba8a-7a9089892460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DB7BF39D0>]}
[0m00:21:02.635811 [error] [MainThread]: Encountered an error:

[0m00:21:02.680990 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m00:21:02.694720 [debug] [MainThread]: Command `dbt docs serve` failed at 00:21:02.694720 after 198.40 seconds
[0m00:21:02.694720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D945D0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DB7CCF040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DB7D9D2B0>]}
[0m00:21:02.696223 [debug] [MainThread]: Flushing usage events
[0m00:21:33.569172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002AD908E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020029C3B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020029C3BBB0>]}


============================== 00:21:33.574161 | 94dbca8d-b712-44ba-8508-78b8ee6b10f0 ==============================
[0m00:21:33.574161 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:21:33.576751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:21:34.731810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002D5BD880>]}
[0m00:21:34.813507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002D5BD850>]}
[0m00:21:34.824190 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:21:34.833059 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:21:34.977126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:34.978131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:34.983701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E772DF0>]}
[0m00:21:34.995734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E6B0220>]}
[0m00:21:34.996737 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:21:34.998981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E6B0040>]}
[0m00:21:35.000144 [info ] [MainThread]: 
[0m00:21:35.002142 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:35.004144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ'
[0m00:21:35.020059 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ"
[0m00:21:35.021054 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ"} */
show terse schemas in database FIRST_DE_PROJ
    limit 10000
[0m00:21:35.022277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:42.031675 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 7.0 seconds
[0m00:21:42.033685 [debug] [ThreadPool]: On list_FIRST_DE_PROJ: Close
[0m00:21:42.391061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:21:42.398834 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:21:42.400849 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:21:42.401679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:43.425161 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 1.0 seconds
[0m00:21:43.428219 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:21:43.815254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E4324C0>]}
[0m00:21:43.816315 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:21:43.817317 [info ] [MainThread]: 
[0m00:21:43.823300 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:21:43.825303 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:21:43.826308 [info ] [Thread-1  ]: 1 of 3 START sql view model RAW.customer_orders ................................ [RUN]
[0m00:21:43.829789 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:21:43.827772 [info ] [Thread-2  ]: 2 of 3 START sql table model RAW.my_first_dbt_model ............................ [RUN]
[0m00:21:43.830788 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:21:43.832611 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.my_first_dbt_model'
[0m00:21:43.833601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:21:43.840098 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:21:43.845188 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.my_first_dbt_model"
[0m00:21:43.846621 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:21:43.832611 => 00:21:43.846022
[0m00:21:43.847633 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:21:43.848618 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_first_dbt_model (compile): 00:21:43.841322 => 00:21:43.848618
[0m00:21:43.881177 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.customer_orders"
[0m00:21:43.881177 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:21:43.908759 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.customer_orders"
[0m00:21:43.911017 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.my_first_dbt_model"
[0m00:21:43.912351 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.customer_orders"} */
create or replace   view FIRST_DE_PROJ.RAW.customer_orders
  
   as (
    WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM FIRST_DE_PROJ.RAW.orders as orders --first_de_proj.raw.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from FIRST_DE_PROJ.RAW.payments --first_de_proj.raw.payments
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join FIRST_DE_PROJ.RAW.customers as C --first_de_proj.raw.customers C 
on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from first_de_proj.raw.customers C 
left join FIRST_DE_PROJ.RAW.orders as orders --first_de_proj.raw.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
  );
[0m00:21:43.913503 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:21:43.916896 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.my_first_dbt_model"
[0m00:21:43.918416 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.my_first_dbt_model"} */
create or replace transient table FIRST_DE_PROJ.RAW.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m00:21:43.918975 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m00:21:45.048047 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:21:45.072031 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:21:43.849617 => 00:21:45.072031
[0m00:21:45.073028 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.customer_orders: Close
[0m00:21:45.450204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020029C3BDF0>]}
[0m00:21:45.450204 [info ] [Thread-1  ]: 1 of 3 OK created sql view model RAW.customer_orders ........................... [[32mSUCCESS 1[0m in 1.62s]
[0m00:21:45.454738 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:21:45.576698 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:21:45.592768 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_first_dbt_model (execute): 00:21:43.884234 => 00:21:45.592768
[0m00:21:45.593764 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.my_first_dbt_model: Close
[0m00:21:45.927528 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E4584C0>]}
[0m00:21:45.928529 [info ] [Thread-2  ]: 2 of 3 OK created sql table model RAW.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.09s]
[0m00:21:45.930529 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:21:45.932528 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:21:45.933527 [info ] [Thread-1  ]: 3 of 3 START sql view model RAW.my_second_dbt_model ............................ [RUN]
[0m00:21:45.934594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.customer_orders, now model.dbt_jaffle_shop.my_second_dbt_model)
[0m00:21:45.935534 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:21:45.939530 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.my_second_dbt_model"
[0m00:21:45.940588 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.my_second_dbt_model (compile): 00:21:45.935534 => 00:21:45.940588
[0m00:21:45.941528 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:21:45.945528 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.my_second_dbt_model"
[0m00:21:45.947650 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.my_second_dbt_model"
[0m00:21:45.948477 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "node_id": "model.dbt_jaffle_shop.my_second_dbt_model"} */
create or replace   view FIRST_DE_PROJ.RAW.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from FIRST_DE_PROJ.RAW.my_first_dbt_model
where id = 1
  );
[0m00:21:45.948477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:21:47.111358 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m00:21:47.115547 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.my_second_dbt_model (execute): 00:21:45.942638 => 00:21:47.115547
[0m00:21:47.115547 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.my_second_dbt_model: Close
[0m00:21:47.490775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94dbca8d-b712-44ba-8508-78b8ee6b10f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E906A30>]}
[0m00:21:47.491779 [info ] [Thread-1  ]: 3 of 3 OK created sql view model RAW.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 1.56s]
[0m00:21:47.493980 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:21:47.495976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:47.497605 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ' was properly closed.
[0m00:21:47.497605 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:21:47.498631 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.my_second_dbt_model' was properly closed.
[0m00:21:47.498631 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.my_first_dbt_model' was properly closed.
[0m00:21:47.499632 [info ] [MainThread]: 
[0m00:21:47.501788 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 12.50 seconds (12.50s).
[0m00:21:47.503783 [debug] [MainThread]: Command end result
[0m00:21:47.515182 [info ] [MainThread]: 
[0m00:21:47.516178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:47.517180 [info ] [MainThread]: 
[0m00:21:47.518179 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:21:47.520174 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:47.520174 after 14.02 seconds
[0m00:21:47.521295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002AD908E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002D5BD850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E7ABFA0>]}
[0m00:21:47.522299 [debug] [MainThread]: Flushing usage events
[0m00:21:57.001089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD5270EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7A97340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7A97910>]}


============================== 00:21:57.006232 | df318d4c-484f-414e-97ef-d16308a3bebf ==============================
[0m00:21:57.006232 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:21:57.007863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m00:21:58.186661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df318d4c-484f-414e-97ef-d16308a3bebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7A97940>]}
[0m00:21:58.273910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df318d4c-484f-414e-97ef-d16308a3bebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD7AAF1F0>]}
[0m00:21:58.273910 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:21:58.284584 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m00:21:58.411585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:58.411585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:58.416404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df318d4c-484f-414e-97ef-d16308a3bebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF8C51F10>]}
[0m00:21:58.426421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df318d4c-484f-414e-97ef-d16308a3bebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF8B95280>]}
[0m00:21:58.427414 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m00:21:58.428693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df318d4c-484f-414e-97ef-d16308a3bebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF8B95340>]}
[0m00:21:58.430692 [info ] [MainThread]: 
[0m00:21:58.432574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:58.435554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_FIRST_DE_PROJ_RAW'
[0m00:21:58.437353 [debug] [ThreadPool]: Using snowflake connection "list_FIRST_DE_PROJ_RAW"
[0m00:21:58.437353 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "list_FIRST_DE_PROJ_RAW"} */
show terse objects in FIRST_DE_PROJ.RAW limit 10000
[0m00:21:58.451237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:59.599037 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 1.0 seconds
[0m00:21:59.602553 [debug] [ThreadPool]: On list_FIRST_DE_PROJ_RAW: Close
[0m00:21:59.992854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df318d4c-484f-414e-97ef-d16308a3bebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF8A7AE50>]}
[0m00:21:59.993890 [info ] [MainThread]: Concurrency: 2 threads (target='dev')
[0m00:21:59.995900 [info ] [MainThread]: 
[0m00:22:00.000901 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.customer_orders
[0m00:22:00.001898 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:22:00.003964 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.customer_orders'
[0m00:22:00.005965 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.my_first_dbt_model'
[0m00:22:00.006945 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.customer_orders
[0m00:22:00.007946 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:22:00.012811 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.customer_orders"
[0m00:22:00.017986 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.my_first_dbt_model"
[0m00:22:00.019984 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (compile): 00:22:00.007946 => 00:22:00.019984
[0m00:22:00.022079 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.customer_orders
[0m00:22:00.022987 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_first_dbt_model (compile): 00:22:00.013983 => 00:22:00.022846
[0m00:22:00.025190 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.customer_orders (execute): 00:22:00.024433 => 00:22:00.024433
[0m00:22:00.026673 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:22:00.028990 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.customer_orders
[0m00:22:00.030401 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_first_dbt_model (execute): 00:22:00.028990 => 00:22:00.028990
[0m00:22:00.030988 [debug] [Thread-1  ]: Began running node seed.dbt_jaffle_shop.customers
[0m00:22:00.032988 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.my_first_dbt_model
[0m00:22:00.034992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.customer_orders, now seed.dbt_jaffle_shop.customers)
[0m00:22:00.036529 [debug] [Thread-2  ]: Began running node seed.dbt_jaffle_shop.orders
[0m00:22:00.037522 [debug] [Thread-1  ]: Began compiling node seed.dbt_jaffle_shop.customers
[0m00:22:00.040283 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.my_first_dbt_model, now seed.dbt_jaffle_shop.orders)
[0m00:22:00.043819 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.customers (compile): 00:22:00.041371 => 00:22:00.043819
[0m00:22:00.044820 [debug] [Thread-2  ]: Began compiling node seed.dbt_jaffle_shop.orders
[0m00:22:00.045815 [debug] [Thread-1  ]: Began executing node seed.dbt_jaffle_shop.customers
[0m00:22:00.050818 [debug] [Thread-2  ]: Timing info for seed.dbt_jaffle_shop.orders (compile): 00:22:00.046815 => 00:22:00.050818
[0m00:22:00.052472 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.customers (execute): 00:22:00.051926 => 00:22:00.051926
[0m00:22:00.053486 [debug] [Thread-2  ]: Began executing node seed.dbt_jaffle_shop.orders
[0m00:22:00.055759 [debug] [Thread-1  ]: Finished running node seed.dbt_jaffle_shop.customers
[0m00:22:00.057490 [debug] [Thread-2  ]: Timing info for seed.dbt_jaffle_shop.orders (execute): 00:22:00.056919 => 00:22:00.056919
[0m00:22:00.058808 [debug] [Thread-1  ]: Began running node seed.dbt_jaffle_shop.payments
[0m00:22:00.061811 [debug] [Thread-2  ]: Finished running node seed.dbt_jaffle_shop.orders
[0m00:22:00.063050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.customers, now seed.dbt_jaffle_shop.payments)
[0m00:22:00.064051 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:22:00.065054 [debug] [Thread-1  ]: Began compiling node seed.dbt_jaffle_shop.payments
[0m00:22:00.066066 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.orders, now model.dbt_jaffle_shop.my_second_dbt_model)
[0m00:22:00.068469 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.payments (compile): 00:22:00.066066 => 00:22:00.068469
[0m00:22:00.070470 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:22:00.070470 [debug] [Thread-1  ]: Began executing node seed.dbt_jaffle_shop.payments
[0m00:22:00.076056 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.my_second_dbt_model"
[0m00:22:00.077060 [debug] [Thread-1  ]: Timing info for seed.dbt_jaffle_shop.payments (execute): 00:22:00.076056 => 00:22:00.076056
[0m00:22:00.079060 [debug] [Thread-1  ]: Finished running node seed.dbt_jaffle_shop.payments
[0m00:22:00.080061 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:22:00.081060 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_second_dbt_model (compile): 00:22:00.072421 => 00:22:00.081060
[0m00:22:00.083350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly seed.dbt_jaffle_shop.payments, now test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710)
[0m00:22:00.084053 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:22:00.085056 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:22:00.086214 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.my_second_dbt_model (execute): 00:22:00.086214 => 00:22:00.086214
[0m00:22:00.099086 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m00:22:00.101057 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.my_second_dbt_model
[0m00:22:00.103064 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:22:00.104064 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 00:22:00.087059 => 00:22:00.104064
[0m00:22:00.106065 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.my_second_dbt_model, now test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321)
[0m00:22:00.107057 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:22:00.107057 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:22:00.109064 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 00:22:00.108066 => 00:22:00.108066
[0m00:22:00.116076 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321"
[0m00:22:00.117061 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m00:22:00.119075 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:22:00.120062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778)
[0m00:22:00.121065 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:22:00.122085 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 00:22:00.109064 => 00:22:00.122085
[0m00:22:00.125057 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m00:22:00.129700 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:22:00.130710 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 00:22:00.130710 => 00:22:00.130710
[0m00:22:00.133718 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321
[0m00:22:00.134469 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:22:00.135470 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 00:22:00.123148 => 00:22:00.134469
[0m00:22:00.137586 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_my_first_dbt_model_id.16e066b321, now test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493)
[0m00:22:00.138618 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:22:00.139640 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:22:00.140642 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 00:22:00.139640 => 00:22:00.139640
[0m00:22:00.142637 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m00:22:00.148439 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778
[0m00:22:00.149450 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 00:22:00.140642 => 00:22:00.149450
[0m00:22:00.150517 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:22:00.151558 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 00:22:00.151505 => 00:22:00.151505
[0m00:22:00.152573 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m00:22:00.154569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:00.155566 [debug] [MainThread]: Connection 'list_FIRST_DE_PROJ_RAW' was properly closed.
[0m00:22:00.155566 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m00:22:00.157075 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m00:22:00.159106 [debug] [MainThread]: Command end result
[0m00:22:00.172109 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m00:22:00.172317 [info ] [MainThread]: Building catalog
[0m00:22:00.175323 [debug] [ThreadPool]: Acquiring new snowflake connection 'FIRST_DE_PROJ.information_schema'
[0m00:22:00.182573 [debug] [ThreadPool]: Using snowflake connection "FIRST_DE_PROJ.information_schema"
[0m00:22:00.182573 [debug] [ThreadPool]: On FIRST_DE_PROJ.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "dev", "connection_name": "FIRST_DE_PROJ.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from FIRST_DE_PROJ.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('payments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customer_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_first_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_second_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('orders')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from FIRST_DE_PROJ.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('payments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customer_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_first_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('my_second_dbt_model')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('orders')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m00:22:00.192352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:03.856984 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 4.0 seconds
[0m00:22:03.868576 [debug] [ThreadPool]: On FIRST_DE_PROJ.information_schema: Close
[0m00:22:04.274998 [info ] [MainThread]: Catalog written to C:\Users\Thinkbook 14\venv\dbt_jaffle_shop\target\catalog.json
[0m00:22:04.277018 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:22:04.277018 after 7.34 seconds
[0m00:22:04.278041 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:22:04.279065 [debug] [MainThread]: Connection 'FIRST_DE_PROJ.information_schema' was properly closed.
[0m00:22:04.279895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD5270EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF8DA1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF8DE6A90>]}
[0m00:22:04.280159 [debug] [MainThread]: Flushing usage events
[0m00:22:12.487837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E682F3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E6AB2CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E68B10E80>]}


============================== 00:22:12.492583 | e79af848-a790-43ae-b177-14caf97dda8b ==============================
[0m00:22:12.492583 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:22:12.494287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\venv\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m00:22:13.703289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e79af848-a790-43ae-b177-14caf97dda8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E6ABB4E80>]}
[0m00:22:13.787062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e79af848-a790-43ae-b177-14caf97dda8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0BB16AF0>]}
[0m00:22:49.077612 [error] [MainThread]: Encountered an error:

[0m00:22:49.081649 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m00:22:49.087926 [debug] [MainThread]: Command `dbt docs serve` failed at 00:22:49.087926 after 36.67 seconds
[0m00:22:49.089399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E682F3880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0BACFAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0BADF220>]}
[0m00:22:49.090403 [debug] [MainThread]: Flushing usage events
[0m23:47:28.344880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80335f1c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8031a16cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8031a16c50>]}


============================== 23:47:28.351686 | 8e97a164-75ef-4aad-83d8-91f51897d9a5 ==============================
[0m23:47:28.351686 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:47:28.354181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:47:28.356811 [info ] [MainThread]: dbt version: 1.7.11
[0m23:47:28.359015 [info ] [MainThread]: python version: 3.10.14
[0m23:47:28.361314 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:47:28.363665 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m23:47:28.366861 [info ] [MainThread]: Using profiles dir at /home/airflow/.dbt
[0m23:47:28.369613 [info ] [MainThread]: Using profiles.yml file at /home/airflow/.dbt/profiles.yml
[0m23:47:28.371890 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_jaffle_shop/dbt_project.yml
[0m23:47:28.508834 [info ] [MainThread]: Configuration:
[0m23:47:28.510954 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m23:47:28.513462 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:47:28.515286 [info ] [MainThread]: Required dependencies:
[0m23:47:28.517658 [debug] [MainThread]: Executing "git --help"
[0m23:47:28.544528 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:47:28.546597 [debug] [MainThread]: STDERR: "b''"
[0m23:47:28.548806 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:47:28.550985 [info ] [MainThread]: Connection test skipped since no profile was found
[0m23:47:28.553251 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:47:28.554994 [info ] [MainThread]: dbt looked for a profiles.yml file in /home/airflow/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m23:47:28.557628 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.2330198, "process_user_time": 3.016088, "process_kernel_time": 0.090482, "process_mem_max_rss": "105584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:47:28.559524 [debug] [MainThread]: Command `dbt debug` failed at 23:47:28.559177 after 0.24 seconds
[0m23:47:28.561281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80335f1c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8031a17fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8031a17be0>]}
[0m23:47:28.563163 [debug] [MainThread]: Flushing usage events
[0m23:48:52.358308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8f0785b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8d31fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8d31fc70>]}


============================== 23:48:52.365718 | 888a8957-1942-492c-a5fa-d40a9e94306b ==============================
[0m23:48:52.365718 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:48:52.368597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/dbt_jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir=/opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:52.372458 [info ] [MainThread]: dbt version: 1.7.11
[0m23:48:52.374785 [info ] [MainThread]: python version: 3.10.14
[0m23:48:52.377210 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:48:52.379662 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m23:48:52.405386 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m23:48:52.407838 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m23:48:52.410007 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_jaffle_shop/dbt_project.yml
[0m23:48:52.539134 [info ] [MainThread]: Configuration:
[0m23:48:52.541760 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m23:48:52.544024 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:48:52.546316 [info ] [MainThread]: Required dependencies:
[0m23:48:52.548326 [debug] [MainThread]: Executing "git --help"
[0m23:48:52.552137 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:48:52.553896 [debug] [MainThread]: STDERR: "b''"
[0m23:48:52.556122 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:48:52.558323 [info ] [MainThread]: Connection test skipped since no profile was found
[0m23:48:52.560480 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:48:52.563119 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbt_jaffle_shop'


[0m23:48:52.566264 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.3058954, "process_user_time": 2.934879, "process_kernel_time": 0.070598, "process_mem_max_rss": "105608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:48:52.568923 [debug] [MainThread]: Command `dbt debug` failed at 23:48:52.568475 after 0.31 seconds
[0m23:48:52.570849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8f0785b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8d2ff250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8d2fc400>]}
[0m23:48:52.572637 [debug] [MainThread]: Flushing usage events
[0m23:49:59.497732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28b1fbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2894bfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2894bfc70>]}


============================== 23:49:59.504540 | 35b83c57-f7bb-4bcb-b2ed-2f55f6fd8277 ==============================
[0m23:49:59.504540 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:49:59.506757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/dbt_jaffle_shop/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir=/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:59.510040 [info ] [MainThread]: dbt version: 1.7.11
[0m23:49:59.512013 [info ] [MainThread]: python version: 3.10.14
[0m23:49:59.514163 [info ] [MainThread]: python path: /usr/local/bin/python
[0m23:49:59.516106 [info ] [MainThread]: os info: Linux-5.10.16.3-microsoft-standard-WSL2-x86_64-with-glibc2.36
[0m23:50:00.575992 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m23:50:00.578625 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m23:50:00.580576 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/dbt_jaffle_shop/dbt_project.yml
[0m23:50:00.584100 [info ] [MainThread]: adapter type: snowflake
[0m23:50:00.587101 [info ] [MainThread]: adapter version: 1.7.3
[0m23:50:00.718745 [info ] [MainThread]: Configuration:
[0m23:50:00.721157 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:50:00.724013 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:50:00.726439 [info ] [MainThread]: Required dependencies:
[0m23:50:00.729209 [debug] [MainThread]: Executing "git --help"
[0m23:50:00.733112 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:50:00.735350 [debug] [MainThread]: STDERR: "b''"
[0m23:50:00.737235 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:50:00.739587 [info ] [MainThread]: Connection:
[0m23:50:00.741726 [info ] [MainThread]:   account: sx05674.europe-west2.gcp
[0m23:50:00.743851 [info ] [MainThread]:   user: AIRBYTE014
[0m23:50:00.745995 [info ] [MainThread]:   database: FIRST_DE_PROJ
[0m23:50:00.748118 [info ] [MainThread]:   warehouse: AIRBYTE_WAREHOUSE
[0m23:50:00.750965 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m23:50:00.753334 [info ] [MainThread]:   schema: RAW
[0m23:50:00.755587 [info ] [MainThread]:   authenticator: None
[0m23:50:00.757964 [info ] [MainThread]:   oauth_client_id: None
[0m23:50:00.760442 [info ] [MainThread]:   query_tag: None
[0m23:50:00.762613 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:50:00.764799 [info ] [MainThread]:   host: None
[0m23:50:00.767780 [info ] [MainThread]:   port: None
[0m23:50:00.770599 [info ] [MainThread]:   proxy_host: None
[0m23:50:00.773257 [info ] [MainThread]:   proxy_port: None
[0m23:50:00.775868 [info ] [MainThread]:   protocol: None
[0m23:50:00.778262 [info ] [MainThread]:   connect_retries: 1
[0m23:50:00.780580 [info ] [MainThread]:   connect_timeout: None
[0m23:50:00.783299 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:50:00.785801 [info ] [MainThread]:   retry_all: False
[0m23:50:00.788239 [info ] [MainThread]:   insecure_mode: False
[0m23:50:00.791284 [info ] [MainThread]:   reuse_connections: None
[0m23:50:00.794476 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m23:50:00.797859 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:50:00.802807 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:50:00.805561 [debug] [MainThread]: On debug: select 1 as id
[0m23:50:00.807879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:14.578987 [debug] [MainThread]: SQL status: SUCCESS 1 in 14.0 seconds
[0m23:50:14.582913 [debug] [MainThread]: On debug: Close
[0m23:50:14.910504 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:50:14.912938 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:50:14.916134 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 15.481351, "process_user_time": 4.195633, "process_kernel_time": 2.022715, "process_mem_max_rss": "227368", "process_in_blocks": "200", "process_out_blocks": "1112"}
[0m23:50:14.918584 [debug] [MainThread]: Command `dbt debug` succeeded at 23:50:14.918112 after 15.48 seconds
[0m23:50:14.922212 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:50:14.926194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb28b1fbb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb289473250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2592c0eb0>]}
[0m23:50:14.928641 [debug] [MainThread]: Flushing usage events
[0m18:40:26.565109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3AF708E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B39FCA9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3D7B4B50>]}


============================== 18:40:26.574098 | 7a06819a-5701-40bd-b4f8-2ccc986a5713 ==============================
[0m18:40:26.574098 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:40:26.576103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:40:26.578096 [info ] [MainThread]: dbt version: 1.7.11
[0m18:40:26.579097 [info ] [MainThread]: python version: 3.9.13
[0m18:40:26.581092 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m18:40:26.583498 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m18:40:34.606919 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m18:40:34.608568 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m18:40:34.610594 [info ] [MainThread]: Using dbt_project.yml file at C:\airflow\dbt\dbt_jaffle_shop\dbt_project.yml
[0m18:40:34.615172 [info ] [MainThread]: adapter type: snowflake
[0m18:40:34.617148 [info ] [MainThread]: adapter version: 1.7.3
[0m18:40:34.827579 [info ] [MainThread]: Configuration:
[0m18:40:34.830581 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:40:34.832322 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:40:34.834348 [info ] [MainThread]: Required dependencies:
[0m18:40:34.836757 [debug] [MainThread]: Executing "git --help"
[0m18:40:34.883297 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:40:34.886085 [debug] [MainThread]: STDERR: "b''"
[0m18:40:34.889197 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:40:34.892416 [info ] [MainThread]: Connection:
[0m18:40:34.895637 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m18:40:34.899339 [info ] [MainThread]:   user: AIRBYTE014
[0m18:40:34.902694 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m18:40:34.905680 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m18:40:34.908777 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m18:40:34.911860 [info ] [MainThread]:   schema: RAW
[0m18:40:34.915614 [info ] [MainThread]:   authenticator: None
[0m18:40:34.919552 [info ] [MainThread]:   oauth_client_id: None
[0m18:40:34.922252 [info ] [MainThread]:   query_tag: None
[0m18:40:34.926018 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:40:34.930016 [info ] [MainThread]:   host: None
[0m18:40:34.933723 [info ] [MainThread]:   port: None
[0m18:40:34.937410 [info ] [MainThread]:   proxy_host: None
[0m18:40:34.941126 [info ] [MainThread]:   proxy_port: None
[0m18:40:34.945308 [info ] [MainThread]:   protocol: None
[0m18:40:34.949972 [info ] [MainThread]:   connect_retries: 1
[0m18:40:34.953347 [info ] [MainThread]:   connect_timeout: None
[0m18:40:34.956413 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:40:34.960625 [info ] [MainThread]:   retry_all: False
[0m18:40:34.966570 [info ] [MainThread]:   insecure_mode: False
[0m18:40:34.971142 [info ] [MainThread]:   reuse_connections: None
[0m18:40:34.974240 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m18:40:34.979628 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:40:34.983050 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:40:34.985566 [debug] [MainThread]: On debug: select 1 as id
[0m18:40:34.987692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:40:38.918088 [debug] [MainThread]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:40:38.920975 [debug] [MainThread]: On debug: Close
[0m18:40:39.462143 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:40:39.465029 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:40:39.468810 [debug] [MainThread]: Command `dbt debug` succeeded at 18:40:39.468107 after 13.04 seconds
[0m18:40:39.470600 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:40:39.472540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B3AF708E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B5E5ECAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B5E62AE80>]}
[0m18:40:39.475755 [debug] [MainThread]: Flushing usage events
[0m22:04:40.693533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67022BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672C6D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672C6D2B0>]}


============================== 22:04:40.704483 | 11f20e90-c7e3-4b03-9cfe-49f34c48a095 ==============================
[0m22:04:40.704483 [info ] [MainThread]: Running with dbt=1.7.13
[0m22:04:40.707439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:40.710044 [info ] [MainThread]: dbt version: 1.7.13
[0m22:04:40.712923 [info ] [MainThread]: python version: 3.9.13
[0m22:04:40.715556 [info ] [MainThread]: python path: C:\venv\Scripts\python.exe
[0m22:04:40.718404 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m22:04:40.748446 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.snowflake'
[0m22:04:40.750717 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m22:04:40.753419 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m22:04:40.755946 [info ] [MainThread]: Using dbt_project.yml file at C:\airflow\dbt\dbt_jaffle_shop\dbt_project.yml
[0m22:04:40.993754 [info ] [MainThread]: Configuration:
[0m22:04:40.997025 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:04:40.998509 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:04:40.999903 [info ] [MainThread]: Required dependencies:
[0m22:04:41.001897 [debug] [MainThread]: Executing "git --help"
[0m22:04:41.042078 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:04:41.043578 [debug] [MainThread]: STDERR: "b''"
[0m22:04:41.044080 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:04:41.047077 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:04:41.048079 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:04:41.050092 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "dbt_jaffle_shop", target "RAW" invalid: Runtime Error
    Could not find adapter type snowflake!


[0m22:04:41.054824 [debug] [MainThread]: Command `dbt debug` failed at 22:04:41.054296 after 0.75 seconds
[0m22:04:41.055864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67022BA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672CBC070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F672C5DF40>]}
[0m22:04:41.056772 [debug] [MainThread]: Flushing usage events
[0m22:07:13.007243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CC96FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CF1AFF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CB83E100>]}


============================== 22:07:13.015091 | 06d28820-1bd6-44de-84bd-9b5c40613064 ==============================
[0m22:07:13.015091 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:07:13.017360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:07:13.018393 [info ] [MainThread]: dbt version: 1.7.11
[0m22:07:13.020868 [info ] [MainThread]: python version: 3.9.13
[0m22:07:13.021874 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m22:07:13.024571 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m22:07:14.782093 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m22:07:14.784007 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m22:07:14.785808 [info ] [MainThread]: Using dbt_project.yml file at C:\airflow\dbt\dbt_jaffle_shop\dbt_project.yml
[0m22:07:14.788929 [info ] [MainThread]: adapter type: snowflake
[0m22:07:14.791348 [info ] [MainThread]: adapter version: 1.7.3
[0m22:07:14.920744 [info ] [MainThread]: Configuration:
[0m22:07:14.925156 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:07:14.926286 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:07:14.928318 [info ] [MainThread]: Required dependencies:
[0m22:07:14.930290 [debug] [MainThread]: Executing "git --help"
[0m22:07:14.963820 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:07:14.964607 [debug] [MainThread]: STDERR: "b''"
[0m22:07:14.966613 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:07:14.968799 [info ] [MainThread]: Connection:
[0m22:07:14.970389 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m22:07:14.972734 [info ] [MainThread]:   user: AIRBYTE014
[0m22:07:14.973751 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m22:07:14.975792 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m22:07:14.978485 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m22:07:14.980685 [info ] [MainThread]:   schema: RAW
[0m22:07:14.982702 [info ] [MainThread]:   authenticator: None
[0m22:07:14.984297 [info ] [MainThread]:   oauth_client_id: None
[0m22:07:14.986412 [info ] [MainThread]:   query_tag: None
[0m22:07:14.988789 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:07:14.990779 [info ] [MainThread]:   host: None
[0m22:07:14.992862 [info ] [MainThread]:   port: None
[0m22:07:14.993870 [info ] [MainThread]:   proxy_host: None
[0m22:07:14.997567 [info ] [MainThread]:   proxy_port: None
[0m22:07:14.999156 [info ] [MainThread]:   protocol: None
[0m22:07:15.000573 [info ] [MainThread]:   connect_retries: 1
[0m22:07:15.002636 [info ] [MainThread]:   connect_timeout: None
[0m22:07:15.004748 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:07:15.006746 [info ] [MainThread]:   retry_all: False
[0m22:07:15.008867 [info ] [MainThread]:   insecure_mode: False
[0m22:07:15.009995 [info ] [MainThread]:   reuse_connections: None
[0m22:07:15.012478 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:07:15.016488 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:07:15.018477 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:07:15.019483 [debug] [MainThread]: On debug: select 1 as id
[0m22:07:15.021069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:19.368160 [debug] [MainThread]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:07:19.373915 [debug] [MainThread]: On debug: Close
[0m22:07:19.914221 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:07:19.927482 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:07:19.929826 [debug] [MainThread]: Command `dbt debug` succeeded at 22:07:19.929826 after 7.02 seconds
[0m22:07:19.929826 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:07:19.932583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CC96FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225CB83ED30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225EFFFD730>]}
[0m22:07:19.933610 [debug] [MainThread]: Flushing usage events
[0m22:09:45.681070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1DFB0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CE5CD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CE5C760>]}


============================== 22:09:45.689193 | b740b92d-9fbd-40aa-b19e-7229f9d94f12 ==============================
[0m22:09:45.689193 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:09:45.691073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:09:46.263117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b740b92d-9fbd-40aa-b19e-7229f9d94f12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CE7BB80>]}
[0m22:09:46.269609 [debug] [MainThread]: Set downloads directory='C:\Users\THINKB~1\AppData\Local\Temp\dbt-downloads-t4bco6cy'
[0m22:09:46.271644 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m22:09:48.503147 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:48.504153 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m22:09:48.505817 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m22:09:48.507022 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:48.533114 [debug] [MainThread]: STDOUT: "b'70e2b049da6c26c90b09c453db82b50106e79831\n'"
[0m22:09:48.535109 [debug] [MainThread]: STDERR: "b''"
[0m22:09:48.536471 [debug] [MainThread]: Checking out revision 0.9.2.
[0m22:09:48.537611 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m22:09:48.582452 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:48.583455 [debug] [MainThread]: STDERR: "b''"
[0m22:09:48.585132 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m22:09:51.162640 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:51.165304 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n * [new tag]         0.0.1      -> 0.0.1\n * [new tag]         0.1.0      -> 0.1.0\n * [new tag]         0.1.1      -> 0.1.1\n * [new tag]         0.1.10     -> 0.1.10\n * [new tag]         0.1.11     -> 0.1.11\n * [new tag]         0.1.12     -> 0.1.12\n * [new tag]         0.1.13     -> 0.1.13\n * [new tag]         0.1.14     -> 0.1.14\n * [new tag]         0.1.15     -> 0.1.15\n * [new tag]         0.1.16     -> 0.1.16\n * [new tag]         0.1.17     -> 0.1.17\n * [new tag]         0.1.18     -> 0.1.18\n * [new tag]         0.1.19     -> 0.1.19\n * [new tag]         0.1.2      -> 0.1.2\n * [new tag]         0.1.20     -> 0.1.20\n * [new tag]         0.1.21     -> 0.1.21\n * [new tag]         0.1.22     -> 0.1.22\n * [new tag]         0.1.23     -> 0.1.23\n * [new tag]         0.1.24     -> 0.1.24\n * [new tag]         0.1.25     -> 0.1.25\n * [new tag]         0.1.3      -> 0.1.3\n * [new tag]         0.1.4      -> 0.1.4\n * [new tag]         0.1.5      -> 0.1.5\n * [new tag]         0.1.6      -> 0.1.6\n * [new tag]         0.1.7      -> 0.1.7\n * [new tag]         0.1.8      -> 0.1.8\n * [new tag]         0.1.9      -> 0.1.9\n * [new tag]         0.2.0      -> 0.2.0\n * [new tag]         0.2.1      -> 0.2.1\n * [new tag]         0.2.2      -> 0.2.2\n * [new tag]         0.2.3      -> 0.2.3\n * [new tag]         0.2.4      -> 0.2.4\n * [new tag]         0.2.5      -> 0.2.5\n * [new tag]         0.3.0      -> 0.3.0\n * [new tag]         0.4.0      -> 0.4.0\n * [new tag]         0.4.1      -> 0.4.1\n * [new tag]         0.5.0      -> 0.5.0\n * [new tag]         0.5.1      -> 0.5.1\n * [new tag]         0.6.0      -> 0.6.0\n * [new tag]         0.6.1      -> 0.6.1\n * [new tag]         0.6.2      -> 0.6.2\n * [new tag]         0.6.3      -> 0.6.3\n * [new tag]         0.6.4      -> 0.6.4\n * [new tag]         0.6.5      -> 0.6.5\n * [new tag]         0.6.6      -> 0.6.6\n * [new tag]         0.7.0      -> 0.7.0\n * [new tag]         0.7.1      -> 0.7.1\n * [new tag]         0.7.2      -> 0.7.2\n * [new tag]         0.7.3      -> 0.7.3\n * [new tag]         0.7.4      -> 0.7.4\n * [new tag]         0.7.4-b1   -> 0.7.4-b1\n * [new tag]         0.7.4b1    -> 0.7.4b1\n * [new tag]         0.7.5      -> 0.7.5\n * [new tag]         0.7.6      -> 0.7.6\n * [new tag]         0.8.0      -> 0.8.0\n * [new tag]         0.8.1      -> 0.8.1\n * [new tag]         0.8.2      -> 0.8.2\n * [new tag]         0.8.3      -> 0.8.3\n * [new tag]         0.8.4      -> 0.8.4\n * [new tag]         0.8.5      -> 0.8.5\n * [new tag]         0.8.6      -> 0.8.6\n * [new tag]         0.9.0      -> 0.9.0\n * [new tag]         0.9.1      -> 0.9.1\n * [new tag]         0.9.2      -> 0.9.2\n * [new tag]         0.9.5      -> 0.9.5\n * [new tag]         0.9.6      -> 0.9.6\n * [new tag]         1.0.0      -> 1.0.0\n * [new tag]         1.0.0-b1   -> 1.0.0-b1\n * [new tag]         1.0.0-b2   -> 1.0.0-b2\n * [new tag]         1.0.0-rc1  -> 1.0.0-rc1\n * [new tag]         1.1.0      -> 1.1.0\n * [new tag]         1.1.1      -> 1.1.1\n * [new tag]         1.2.0-rc1  -> 1.2.0-rc1\n'"
[0m22:09:51.166500 [debug] [MainThread]: Executing "git tag --list"
[0m22:09:51.212046 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0-rc1\n'"
[0m22:09:51.214148 [debug] [MainThread]: STDERR: "b''"
[0m22:09:51.215040 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m22:09:51.464874 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m22:09:51.467216 [debug] [MainThread]: STDERR: "b''"
[0m22:09:51.468243 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:51.499498 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:51.501498 [debug] [MainThread]: STDERR: "b''"
[0m22:09:51.502506 [debug] [MainThread]: Checked out at 064c2ab.
[0m22:09:51.504534 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:51.534491 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:51.536466 [debug] [MainThread]: STDERR: "b''"
[0m22:09:51.547247 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:09:52.329643 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:09:52.330915 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m22:09:52.893937 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m22:09:52.908790 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m22:09:52.948006 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:52.948994 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m22:09:52.950068 [debug] [MainThread]: command return code=128
[0m22:09:52.953143 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m22:09:52.954742 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:52.979413 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:52.980425 [debug] [MainThread]: STDERR: "b''"
[0m22:09:52.982413 [debug] [MainThread]: Checking out revision 0.9.2.
[0m22:09:52.983152 [debug] [MainThread]: Executing "git remote set-branches origin 0.9.2"
[0m22:09:53.020080 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:53.020941 [debug] [MainThread]: STDERR: "b''"
[0m22:09:53.023946 [debug] [MainThread]: Executing "git fetch origin --depth 1 --tags 0.9.2"
[0m22:09:54.447352 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:54.449920 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * tag               0.9.2      -> FETCH_HEAD\n'"
[0m22:09:54.453426 [debug] [MainThread]: Executing "git tag --list"
[0m22:09:54.529989 [debug] [MainThread]: STDOUT: "b'0.0.1\n0.1.0\n0.1.1\n0.1.10\n0.1.11\n0.1.12\n0.1.13\n0.1.14\n0.1.15\n0.1.16\n0.1.17\n0.1.18\n0.1.19\n0.1.2\n0.1.20\n0.1.21\n0.1.22\n0.1.23\n0.1.24\n0.1.25\n0.1.3\n0.1.4\n0.1.5\n0.1.6\n0.1.7\n0.1.8\n0.1.9\n0.2.0\n0.2.1\n0.2.2\n0.2.3\n0.2.4\n0.2.5\n0.3.0\n0.4.0\n0.4.1\n0.5.0\n0.5.1\n0.6.0\n0.6.1\n0.6.2\n0.6.3\n0.6.4\n0.6.5\n0.6.6\n0.7.0\n0.7.1\n0.7.2\n0.7.3\n0.7.4\n0.7.4-b1\n0.7.4b1\n0.7.5\n0.7.6\n0.8.0\n0.8.1\n0.8.2\n0.8.3\n0.8.4\n0.8.5\n0.8.6\n0.9.0\n0.9.1\n0.9.2\n0.9.5\n0.9.6\n1.0.0\n1.0.0-b1\n1.0.0-b2\n1.0.0-rc1\n1.1.0\n1.1.1\n1.2.0-rc1\n'"
[0m22:09:54.531686 [debug] [MainThread]: STDERR: "b''"
[0m22:09:54.534346 [debug] [MainThread]: Executing "git reset --hard tags/0.9.2"
[0m22:09:54.661275 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m22:09:54.662268 [debug] [MainThread]: STDERR: "b''"
[0m22:09:54.664277 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:54.692545 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:54.693880 [debug] [MainThread]: STDERR: "b''"
[0m22:09:54.694893 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m22:09:54.696616 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:54.726321 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:54.728337 [debug] [MainThread]: STDERR: "b''"
[0m22:09:54.877736 [info ] [MainThread]: Updating lock file in file path: C:\airflow\dbt\dbt_jaffle_shop/package-lock.yml
[0m22:09:54.903561 [debug] [MainThread]: Set downloads directory='C:\Users\THINKB~1\AppData\Local\Temp\dbt-downloads-h4z_x3by'
[0m22:09:54.909945 [info ] [MainThread]: Installing https://github.com/dbt-labs/dbt-utils.git
[0m22:09:54.913018 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m22:09:56.888373 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:56.889570 [debug] [MainThread]: STDERR: "b"Cloning into 'b03949bb53de3439f6a8057088ba4032'...\n""
[0m22:09:56.890800 [debug] [MainThread]: Pulling new dependency b03949bb53de3439f6a8057088ba4032.
[0m22:09:56.891991 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:56.917367 [debug] [MainThread]: STDOUT: "b'70e2b049da6c26c90b09c453db82b50106e79831\n'"
[0m22:09:56.919149 [debug] [MainThread]: STDERR: "b''"
[0m22:09:56.920968 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m22:09:56.922148 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m22:09:58.899121 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:58.900150 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m22:09:58.902120 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m22:09:59.191664 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m22:09:59.192896 [debug] [MainThread]: STDERR: "b''"
[0m22:09:59.194133 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:59.232771 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:59.234006 [debug] [MainThread]: STDERR: "b''"
[0m22:09:59.236822 [debug] [MainThread]: Checked out at 064c2ab.
[0m22:09:59.238634 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:59.271817 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:59.272955 [debug] [MainThread]: STDERR: "b''"
[0m22:09:59.279227 [debug] [MainThread]: Executing "git clone --depth 1 https://github.com/dbt-labs/dbt-utils.git b03949bb53de3439f6a8057088ba4032"
[0m22:09:59.318136 [debug] [MainThread]: STDOUT: "b''"
[0m22:09:59.320506 [debug] [MainThread]: STDERR: "b"fatal: destination path 'b03949bb53de3439f6a8057088ba4032' already exists and is not an empty directory.\n""
[0m22:09:59.321757 [debug] [MainThread]: command return code=128
[0m22:09:59.325624 [debug] [MainThread]: Updating existing dependency b03949bb53de3439f6a8057088ba4032.
[0m22:09:59.326871 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:09:59.363025 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:09:59.364648 [debug] [MainThread]: STDERR: "b''"
[0m22:09:59.367144 [debug] [MainThread]: Checking out revision 064c2abee80816ea855de32e66e54e96d9916677.
[0m22:09:59.369066 [debug] [MainThread]: Executing "git fetch origin --depth 1 064c2abee80816ea855de32e66e54e96d9916677"
[0m22:10:00.974343 [debug] [MainThread]: STDOUT: "b''"
[0m22:10:00.975369 [debug] [MainThread]: STDERR: "b'From https://github.com/dbt-labs/dbt-utils\n * branch            064c2abee80816ea855de32e66e54e96d9916677 -> FETCH_HEAD\n'"
[0m22:10:00.977237 [debug] [MainThread]: Executing "git reset --hard 064c2abee80816ea855de32e66e54e96d9916677"
[0m22:10:01.068271 [debug] [MainThread]: STDOUT: "b'HEAD is now at 064c2ab Add where clause example (#623)\n'"
[0m22:10:01.070696 [debug] [MainThread]: STDERR: "b''"
[0m22:10:01.072798 [debug] [MainThread]: Executing "git rev-parse HEAD"
[0m22:10:01.098305 [debug] [MainThread]: STDOUT: "b'064c2abee80816ea855de32e66e54e96d9916677\n'"
[0m22:10:01.100310 [debug] [MainThread]: STDERR: "b''"
[0m22:10:01.101704 [debug] [MainThread]: Already at 064c2ab, nothing to do.
[0m22:10:04.937051 [info ] [MainThread]: Installed from revision 064c2abee80816ea855de32e66e54e96d9916677
[0m22:10:04.939644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b740b92d-9fbd-40aa-b19e-7229f9d94f12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA208AF9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA208BD880>]}
[0m22:10:04.940694 [info ] [MainThread]: Installing calogica/dbt_date
[0m22:10:05.825471 [info ] [MainThread]: Installed from version 0.10.1
[0m22:10:05.826920 [info ] [MainThread]: Up to date!
[0m22:10:05.829978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b740b92d-9fbd-40aa-b19e-7229f9d94f12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CE4CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA207D9760>]}
[0m22:10:05.834802 [debug] [MainThread]: Command `dbt deps` succeeded at 22:10:05.834802 after 20.27 seconds
[0m22:10:05.837005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1DFB0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA1CE4CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA2080D0A0>]}
[0m22:10:05.838375 [debug] [MainThread]: Flushing usage events
[0m22:37:08.087995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53D3D08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53C29D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53C29D1F0>]}


============================== 22:37:08.101190 | a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9 ==============================
[0m22:37:08.101190 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:37:08.106532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:37:11.495560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53C29DF40>]}
[0m22:37:11.748959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560BF2B50>]}
[0m22:37:11.753224 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:37:11.857558 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:37:12.015994 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:37:12.020056 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:37:12.022147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560AAC760>]}
[0m22:37:21.195446 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_jaffle_shop.example
[0m22:37:21.224750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560DC73D0>]}
[0m22:37:21.287804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560C96100>]}
[0m22:37:21.290835 [info ] [MainThread]: Found 1 model, 3 seeds, 6 sources, 0 exposures, 0 metrics, 759 macros, 0 groups, 0 semantic models
[0m22:37:21.294390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560C96070>]}
[0m22:37:21.299877 [info ] [MainThread]: 
[0m22:37:21.305252 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:37:21.311292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:37:21.368607 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:37:21.372238 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:37:21.374768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:24.872657 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:37:24.879351 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:37:25.449669 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:37:25.491096 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:37:25.492952 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:37:25.495692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:37:27.895787 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:37:27.912246 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:37:28.466925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560CCA1F0>]}
[0m22:37:28.471518 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:37:28.474869 [info ] [MainThread]: 
[0m22:37:28.501366 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:37:28.505547 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m22:37:28.513057 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m22:37:28.517033 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:37:28.554690 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:37:28.519222 => 22:37:28.552310
[0m22:37:28.786918 [debug] [Thread-1  ]: Compilation Error in model fact_orders (models\CORE\fact_orders.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:37:28.789611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2133b9d-fca5-4a6e-afa5-8ca8567bc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B56129AEE0>]}
[0m22:37:28.792306 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model RAW.fact_orders .......................... [[31mERROR[0m in 0.28s]
[0m22:37:28.797000 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:37:28.803741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:37:28.805663 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:37:28.806845 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:37:28.808931 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m22:37:28.810366 [info ] [MainThread]: 
[0m22:37:28.814548 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m22:37:28.818075 [debug] [MainThread]: Command end result
[0m22:37:28.896477 [info ] [MainThread]: 
[0m22:37:28.901887 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:37:28.906009 [info ] [MainThread]: 
[0m22:37:28.909978 [error] [MainThread]:   Compilation Error in model fact_orders (models\CORE\fact_orders.sql)
  'dict object' has no attribute 'generate_surrogate_key'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m22:37:28.915420 [info ] [MainThread]: 
[0m22:37:28.920480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:37:28.928210 [debug] [MainThread]: Command `dbt run` failed at 22:37:28.926670 after 21.01 seconds
[0m22:37:28.931496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53D3D08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53C29D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B560CCA100>]}
[0m22:37:28.937714 [debug] [MainThread]: Flushing usage events
[0m22:46:48.995494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5D5508E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5C5AA9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FD94F40>]}


============================== 22:46:49.002695 | 3ab19b03-a060-43eb-8083-baf7e24376ba ==============================
[0m22:46:49.002695 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:46:49.009645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:46:49.549391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ab19b03-a060-43eb-8083-baf7e24376ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FD94A30>]}
[0m22:46:49.558088 [debug] [MainThread]: Set downloads directory='C:\Users\THINKB~1\AppData\Local\Temp\dbt-downloads-harjhqom'
[0m22:46:49.560968 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:46:51.548683 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:46:51.555827 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m22:46:52.084398 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m22:46:52.101084 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
[0m22:46:53.018719 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
[0m22:46:53.025438 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `fishtown-analytics/dbt_utils` package is deprecated in favor of
`dbt-labs/dbt_utils`. Please update your `packages.yml` configuration to use
`dbt-labs/dbt_utils` instead.
[0m22:46:53.029353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ab19b03-a060-43eb-8083-baf7e24376ba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FD79760>]}
[0m22:46:53.051415 [info ] [MainThread]: Updating lock file in file path: C:\airflow\dbt\dbt_jaffle_shop/package-lock.yml
[0m22:46:53.296000 [debug] [MainThread]: Set downloads directory='C:\Users\THINKB~1\AppData\Local\Temp\dbt-downloads-355rar05'
[0m22:46:53.308942 [info ] [MainThread]: Installing calogica/dbt_date
[0m22:46:54.326878 [info ] [MainThread]: Installed from version 0.10.1
[0m22:46:54.328870 [info ] [MainThread]: Up to date!
[0m22:46:54.331871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3ab19b03-a060-43eb-8083-baf7e24376ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FDAD5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FDAD190>]}
[0m22:46:54.334046 [info ] [MainThread]: Installing fishtown-analytics/dbt_utils
[0m22:46:55.772940 [info ] [MainThread]: Installed from version 0.6.4
[0m22:46:55.776046 [info ] [MainThread]: Updated version available: 0.7.0
[0m22:46:55.778726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3ab19b03-a060-43eb-8083-baf7e24376ba', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FDA1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FE81B80>]}
[0m22:46:55.780727 [info ] [MainThread]: 
[0m22:46:55.784109 [info ] [MainThread]: Updates available for packages: ['fishtown-analytics/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m22:46:55.792381 [debug] [MainThread]: Command `dbt deps` succeeded at 22:46:55.791382 after 7.00 seconds
[0m22:46:55.794778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5D5508E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FDB0C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB5FE22460>]}
[0m22:46:55.797069 [debug] [MainThread]: Flushing usage events
[0m22:47:41.438426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD43970880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4619F8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4619FCA0>]}


============================== 22:47:41.447504 | 05c62f64-4aae-49bd-85b5-0558e015d5e6 ==============================
[0m22:47:41.447504 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:47:41.452026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:47:44.631810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05c62f64-4aae-49bd-85b5-0558e015d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD44081F10>]}
[0m22:47:45.112985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05c62f64-4aae-49bd-85b5-0558e015d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD66F9E730>]}
[0m22:47:45.120542 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:47:45.215747 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =1.7.11
      Required version of dbt for 'dbt_utils': ['>=0.18.0', '<0.20.0']
    Check for a different version of the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in C:\airflow\dbt\dbt_jaffle_shop\dbt_packages\dbt_utils\dbt_project.yml

Error encountered in C:\airflow\dbt\dbt_jaffle_shop\dbt_packages\dbt_utils
[0m22:47:45.222935 [debug] [MainThread]: Command `dbt run` failed at 22:47:45.222935 after 3.95 seconds
[0m22:47:45.224895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD43970880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD670B14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD671AA8B0>]}
[0m22:47:45.227080 [debug] [MainThread]: Flushing usage events
[0m22:50:50.799254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6B7608E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6A7BA9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6DFA6F40>]}


============================== 22:50:50.810870 | 05883757-b2fe-4701-8d73-588793354404 ==============================
[0m22:50:50.810870 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:50:50.815194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:50:51.258505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05883757-b2fe-4701-8d73-588793354404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6DFA6A30>]}
[0m22:50:51.265279 [debug] [MainThread]: Set downloads directory='C:\Users\THINKB~1\AppData\Local\Temp\dbt-downloads-3ijvvzkn'
[0m22:50:51.267157 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m22:50:51.593338 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m22:50:51.596213 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m22:50:51.856489 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m22:50:51.867726 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m22:50:52.140156 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m22:50:52.176005 [info ] [MainThread]: Updating lock file in file path: C:\airflow\dbt\dbt_jaffle_shop/package-lock.yml
[0m22:50:52.391462 [debug] [MainThread]: Set downloads directory='C:\Users\THINKB~1\AppData\Local\Temp\dbt-downloads-skc0lh43'
[0m22:50:52.402312 [info ] [MainThread]: Installing calogica/dbt_date
[0m22:50:53.435488 [info ] [MainThread]: Installed from version 0.10.1
[0m22:50:53.438222 [info ] [MainThread]: Up to date!
[0m22:50:53.441181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '05883757-b2fe-4701-8d73-588793354404', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6A5FCDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6E00FE20>]}
[0m22:50:53.442651 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m22:50:55.005213 [info ] [MainThread]: Installed from version 1.1.1
[0m22:50:55.007211 [info ] [MainThread]: Up to date!
[0m22:50:55.010185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '05883757-b2fe-4701-8d73-588793354404', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6E00F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6E091A60>]}
[0m22:50:55.017581 [debug] [MainThread]: Command `dbt deps` succeeded at 22:50:55.016579 after 4.40 seconds
[0m22:50:55.020588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6B7608E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6E034460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6DF8D730>]}
[0m22:50:55.022573 [debug] [MainThread]: Flushing usage events
[0m22:51:48.409567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA50B6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA5794130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA40EB880>]}


============================== 22:51:48.420135 | 02727b18-e82b-4a0e-8112-9feac163eb54 ==============================
[0m22:51:48.420135 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:51:48.424057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:51:51.627335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC86FDC10>]}
[0m22:51:51.878439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC86C37F0>]}
[0m22:51:51.886638 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:51:51.955802 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:51:52.106113 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:51:52.109534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC8738E50>]}
[0m22:51:58.569455 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_jaffle_shop.example
[0m22:51:58.577852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC8902400>]}
[0m22:51:58.628778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC8855700>]}
[0m22:51:58.631556 [info ] [MainThread]: Found 1 model, 3 seeds, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m22:51:58.635419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC8D634C0>]}
[0m22:51:58.640989 [info ] [MainThread]: 
[0m22:51:58.645586 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:51:58.652179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:51:58.694100 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:51:58.696770 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:51:58.698770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:02.046607 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:52:02.047754 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:52:02.608443 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:52:02.650311 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:52:02.653177 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:52:02.656546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:52:04.842212 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:52:04.849770 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:52:05.410533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC8A66EE0>]}
[0m22:52:05.414767 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:52:05.419151 [info ] [MainThread]: 
[0m22:52:05.431799 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:52:05.436097 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m22:52:05.442158 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m22:52:05.445743 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:52:05.475044 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m22:52:05.480162 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:52:05.446881 => 22:52:05.479163
[0m22:52:05.482780 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m22:52:05.588978 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m22:52:05.595812 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:52:05.597596 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace transient table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    ordered_at as orderdate,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.orderid
              ) order by (sku)
        );
[0m22:52:05.599859 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:52:08.026996 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b47c20-0205-2c21-0006-1c670001902a
[0m22:52:08.029012 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 15
invalid identifier 'ITEMS.ORDERID'
[0m22:52:08.031770 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 22:52:05.485445 => 22:52:08.030810
[0m22:52:08.032775 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m22:52:08.969304 [debug] [Thread-1  ]: Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 18 at position 15
  invalid identifier 'ITEMS.ORDERID'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:52:08.970325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02727b18-e82b-4a0e-8112-9feac163eb54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC90BC370>]}
[0m22:52:08.973624 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model RAW.fact_orders .......................... [[31mERROR[0m in 3.53s]
[0m22:52:08.979411 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:52:08.986500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:52:08.988524 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:52:08.990050 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:52:08.993631 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m22:52:08.996626 [info ] [MainThread]: 
[0m22:52:08.999221 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m22:52:09.002089 [debug] [MainThread]: Command end result
[0m22:52:09.049113 [info ] [MainThread]: 
[0m22:52:09.056297 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:52:09.060921 [info ] [MainThread]: 
[0m22:52:09.064211 [error] [MainThread]:   Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 18 at position 15
  invalid identifier 'ITEMS.ORDERID'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:52:09.069236 [info ] [MainThread]: 
[0m22:52:09.074699 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m22:52:09.078815 [debug] [MainThread]: Command `dbt run` failed at 22:52:09.078815 after 20.85 seconds
[0m22:52:09.081837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DA50B6AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC86C37F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026DC8AA96A0>]}
[0m22:52:09.084421 [debug] [MainThread]: Flushing usage events
[0m22:53:49.685142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF48F3FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF47E0D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF47E0D880>]}


============================== 22:53:49.696241 | 00920fac-628c-49e2-a21c-3481f6a2908f ==============================
[0m22:53:49.696241 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:53:49.699408 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:53:52.828721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF47E0D730>]}
[0m22:53:53.143415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6C7633A0>]}
[0m22:53:53.149002 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:53:53.216057 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:53:53.823360 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m22:53:53.831430 [debug] [MainThread]: Partial parsing: deleted file: dbt_jaffle_shop://seeds\customers.csv
[0m22:53:53.833487 [debug] [MainThread]: Partial parsing: deleted file: dbt_jaffle_shop://seeds\orders.csv
[0m22:53:53.836134 [debug] [MainThread]: Partial parsing: deleted file: dbt_jaffle_shop://seeds\payments.csv
[0m22:53:53.838416 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m22:53:54.252044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_jaffle_shop.example
[0m22:53:54.276186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6CB910D0>]}
[0m22:53:54.320337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6C8D07C0>]}
[0m22:53:54.322430 [info ] [MainThread]: Found 1 model, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m22:53:54.325970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6C8D0490>]}
[0m22:53:54.328492 [info ] [MainThread]: 
[0m22:53:54.335174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:53:54.339993 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:53:54.389909 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:53:54.392983 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:53:54.395347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:58.050884 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.0 seconds
[0m22:53:58.058464 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:53:58.611108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:53:58.639322 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:53:58.641098 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:53:58.643203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:00.869163 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:54:00.874928 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:54:01.431319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6C8D00A0>]}
[0m22:54:01.434287 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:54:01.437288 [info ] [MainThread]: 
[0m22:54:01.448984 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:54:01.451850 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m22:54:01.455758 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m22:54:01.456808 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:54:01.479832 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m22:54:01.485181 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:54:01.456808 => 22:54:01.483571
[0m22:54:01.487546 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m22:54:01.570021 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m22:54:01.574493 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:54:01.574493 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace transient table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    ordered_at as orderdate,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m22:54:01.574493 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:54:15.493079 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 14.0 seconds
[0m22:54:15.503424 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:54:15.505415 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.RAW.fact_orders cluster by (sku);
[0m22:54:15.979531 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:54:16.035246 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 22:54:01.488545 => 22:54:16.035088
[0m22:54:16.037427 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m22:54:16.621075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00920fac-628c-49e2-a21c-3481f6a2908f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6CB4F250>]}
[0m22:54:16.625527 [info ] [Thread-1  ]: 1 of 1 OK created sql table model RAW.fact_orders .............................. [[32mSUCCESS 1[0m in 15.17s]
[0m22:54:16.631155 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:54:16.639433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:16.642265 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:54:16.645489 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:54:16.649165 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m22:54:16.652278 [info ] [MainThread]: 
[0m22:54:16.656658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 22.32 seconds (22.32s).
[0m22:54:16.661252 [debug] [MainThread]: Command end result
[0m22:54:16.726511 [info ] [MainThread]: 
[0m22:54:16.731194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:54:16.735883 [info ] [MainThread]: 
[0m22:54:16.740844 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:54:16.749276 [debug] [MainThread]: Command `dbt run` succeeded at 22:54:16.748079 after 27.26 seconds
[0m22:54:16.753926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF48F3FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6CB3FE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF6C6D81F0>]}
[0m22:54:16.759468 [debug] [MainThread]: Flushing usage events
[0m23:01:50.076320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3ECBBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3DB6CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3DB6C670>]}


============================== 23:01:50.089401 | 02909f81-67fb-4023-b11a-953059410e57 ==============================
[0m23:01:50.089401 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:01:50.092738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:01:53.392035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3DB8D640>]}
[0m23:01:53.657766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD623C41C0>]}
[0m23:01:53.661610 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m23:01:53.712781 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m23:01:53.868385 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:01:53.873848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD624FA7F0>]}
[0m23:01:58.818844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD62A040D0>]}
[0m23:01:58.852221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD625C01F0>]}
[0m23:01:58.854238 [info ] [MainThread]: Found 1 model, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m23:01:58.858004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD6233AE50>]}
[0m23:01:58.862823 [info ] [MainThread]: 
[0m23:01:58.868247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:58.873557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m23:01:58.927448 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m23:01:58.928553 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m23:01:58.930793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:03.019502 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.0 seconds
[0m23:02:03.024712 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m23:02:03.571138 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m23:02:03.596269 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m23:02:03.596269 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m23:02:03.602225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:05.825387 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m23:02:05.829329 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m23:02:06.426043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD624FA6D0>]}
[0m23:02:06.430206 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m23:02:06.432702 [info ] [MainThread]: 
[0m23:02:06.443174 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m23:02:06.444422 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m23:02:06.450469 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m23:02:06.452007 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m23:02:06.611259 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m23:02:06.615367 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 23:02:06.457095 => 23:02:06.613071
[0m23:02:06.617499 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m23:02:06.703357 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m23:02:06.712119 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m23:02:06.712119 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace transient table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    ordered_at as orderdate,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m23:02:06.716633 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:02:19.217189 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 13.0 seconds
[0m23:02:19.219679 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m23:02:19.221670 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.RAW.fact_orders cluster by (sku);
[0m23:02:19.652699 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:02:19.723591 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 23:02:06.619501 => 23:02:19.722571
[0m23:02:19.726154 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m23:02:20.294944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02909f81-67fb-4023-b11a-953059410e57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD627EEF40>]}
[0m23:02:20.298359 [info ] [Thread-1  ]: 1 of 1 OK created sql table model RAW.fact_orders .............................. [[32mSUCCESS 1[0m in 13.85s]
[0m23:02:20.301594 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m23:02:20.307807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:20.308807 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m23:02:20.312049 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m23:02:20.313200 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m23:02:20.316571 [info ] [MainThread]: 
[0m23:02:20.319491 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.45 seconds (21.45s).
[0m23:02:20.323170 [debug] [MainThread]: Command end result
[0m23:02:20.364271 [info ] [MainThread]: 
[0m23:02:20.366491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:02:20.369622 [info ] [MainThread]: 
[0m23:02:20.372975 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:02:20.380102 [debug] [MainThread]: Command `dbt run` succeeded at 23:02:20.379090 after 30.57 seconds
[0m23:02:20.383353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD3ECBBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD62A300D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD62405070>]}
[0m23:02:20.386014 [debug] [MainThread]: Flushing usage events
[0m23:04:55.570797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920724FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920611D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920611D880>]}


============================== 23:04:55.582220 | 5e99147b-ab2d-4e78-9c6c-6fd06dd2443f ==============================
[0m23:04:55.582220 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:04:55.585740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:04:58.816836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920611D730>]}
[0m23:04:59.079580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922AA833A0>]}
[0m23:04:59.083727 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m23:04:59.146755 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m23:04:59.278909 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:04:59.296747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922A9F81F0>]}
[0m23:05:04.405557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922AF98940>]}
[0m23:05:04.442292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922AB54220>]}
[0m23:05:04.444771 [info ] [MainThread]: Found 1 model, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m23:05:04.448677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922ADA4CD0>]}
[0m23:05:04.453126 [info ] [MainThread]: 
[0m23:05:04.459463 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:05:04.467508 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m23:05:04.530654 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m23:05:04.532775 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m23:05:04.534788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:08.308688 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.0 seconds
[0m23:05:08.323619 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m23:05:08.861911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m23:05:08.878948 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m23:05:08.878948 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m23:05:08.878948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:11.246561 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m23:05:11.254443 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m23:05:11.818739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922AF20A60>]}
[0m23:05:11.833045 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m23:05:11.836426 [info ] [MainThread]: 
[0m23:05:11.848683 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m23:05:11.850945 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m23:05:11.856339 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m23:05:11.860557 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m23:05:12.063743 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m23:05:12.082785 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 23:05:11.864394 => 23:05:12.080967
[0m23:05:12.084482 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m23:05:12.187792 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m23:05:12.196354 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m23:05:12.197347 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    ordered_at as orderdate,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m23:05:12.202526 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:05:28.408953 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 16.0 seconds
[0m23:05:28.412090 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m23:05:28.414776 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.RAW.fact_orders cluster by (sku);
[0m23:05:28.976495 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:05:29.038718 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 23:05:12.085536 => 23:05:29.038718
[0m23:05:29.043311 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m23:05:29.603361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e99147b-ab2d-4e78-9c6c-6fd06dd2443f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922AD8A8E0>]}
[0m23:05:29.611325 [info ] [Thread-1  ]: 1 of 1 OK created sql table model RAW.fact_orders .............................. [[32mSUCCESS 1[0m in 17.75s]
[0m23:05:29.617809 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m23:05:29.629291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:29.632334 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m23:05:29.633377 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m23:05:29.639128 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m23:05:29.640445 [info ] [MainThread]: 
[0m23:05:29.646057 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 25.18 seconds (25.18s).
[0m23:05:29.653594 [debug] [MainThread]: Command end result
[0m23:05:29.740676 [info ] [MainThread]: 
[0m23:05:29.750265 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:05:29.752252 [info ] [MainThread]: 
[0m23:05:29.765871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:05:29.782042 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:29.778557 after 34.40 seconds
[0m23:05:29.787371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920724FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922A93D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002922ADDC700>]}
[0m23:05:29.790468 [debug] [MainThread]: Flushing usage events
[0m23:10:57.064846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3CCADF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3CB9ADEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3CB9AD5B0>]}


============================== 23:10:57.074032 | 99a621a8-631a-43b2-95ca-dd286bcb71aa ==============================
[0m23:10:57.074032 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:10:57.080343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:11:00.469130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3CF30E8E0>]}
[0m23:11:00.754026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F01DA190>]}
[0m23:11:00.757275 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m23:11:00.823733 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m23:11:01.250805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:11:01.254909 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m23:11:01.702822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F06B90D0>]}
[0m23:11:01.746730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F046C100>]}
[0m23:11:01.746730 [info ] [MainThread]: Found 1 model, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m23:11:01.754462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F046CDF0>]}
[0m23:11:01.758421 [info ] [MainThread]: 
[0m23:11:01.763049 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:11:01.767383 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m23:11:01.823803 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m23:11:01.826161 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m23:11:01.828188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:05.327801 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.0 seconds
[0m23:11:05.337332 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m23:11:06.568385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m23:11:06.589431 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m23:11:06.598097 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m23:11:06.600627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:08.928198 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m23:11:08.933734 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m23:11:09.531620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F02A59A0>]}
[0m23:11:09.537537 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m23:11:09.542316 [info ] [MainThread]: 
[0m23:11:09.579210 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m23:11:09.583519 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m23:11:09.589660 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m23:11:09.592657 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m23:11:09.628290 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m23:11:09.633873 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 23:11:09.594505 => 23:11:09.632291
[0m23:11:09.636870 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m23:11:09.738327 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m23:11:09.744953 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m23:11:09.746955 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    ordered_at as orderdate,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m23:11:09.750798 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m23:11:21.844222 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 12.0 seconds
[0m23:11:21.846736 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m23:11:21.848972 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.RAW.fact_orders cluster by (sku);
[0m23:11:22.250360 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:11:22.309561 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 23:11:09.638857 => 23:11:22.309561
[0m23:11:22.309561 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m23:11:22.889958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99a621a8-631a-43b2-95ca-dd286bcb71aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F07E7820>]}
[0m23:11:22.893679 [info ] [Thread-1  ]: 1 of 1 OK created sql table model RAW.fact_orders .............................. [[32mSUCCESS 1[0m in 13.30s]
[0m23:11:22.898649 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m23:11:22.906671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:22.909894 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m23:11:22.912778 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m23:11:22.914975 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m23:11:22.917302 [info ] [MainThread]: 
[0m23:11:22.920969 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 21.15 seconds (21.15s).
[0m23:11:22.925163 [debug] [MainThread]: Command end result
[0m23:11:22.975469 [info ] [MainThread]: 
[0m23:11:22.978992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:22.983912 [info ] [MainThread]: 
[0m23:11:22.988297 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:11:22.992744 [debug] [MainThread]: Command `dbt run` succeeded at 23:11:22.992744 after 26.12 seconds
[0m23:11:22.993797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3CCADF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F02A5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F01FE430>]}
[0m23:11:22.998397 [debug] [MainThread]: Flushing usage events
[0m01:06:32.250098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017137504EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017139D40F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171363CE100>]}


============================== 01:06:32.255592 | 8d03c7ca-3153-4ead-9f91-83a74191b546 ==============================
[0m01:06:32.255592 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:06:32.257363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:06:32.258441 [info ] [MainThread]: dbt version: 1.7.11
[0m01:06:32.259646 [info ] [MainThread]: python version: 3.9.13
[0m01:06:32.261213 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m01:06:32.262479 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m01:06:36.609444 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m01:06:36.610721 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m01:06:36.611815 [info ] [MainThread]: Using dbt_project.yml file at C:\airflow\dbt\dbt_jaffle_shop\dbt_project.yml
[0m01:06:36.614070 [info ] [MainThread]: adapter type: snowflake
[0m01:06:36.615200 [info ] [MainThread]: adapter version: 1.7.3
[0m01:06:36.702235 [info ] [MainThread]: Configuration:
[0m01:06:36.703395 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m01:06:36.704488 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m01:06:36.705504 [info ] [MainThread]: Required dependencies:
[0m01:06:36.707501 [debug] [MainThread]: Executing "git --help"
[0m01:06:36.732270 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m01:06:36.732883 [debug] [MainThread]: STDERR: "b''"
[0m01:06:36.734044 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m01:06:36.735117 [info ] [MainThread]: Connection:
[0m01:06:36.736203 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m01:06:36.737301 [info ] [MainThread]:   user: AIRBYTE014
[0m01:06:36.738471 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m01:06:36.740161 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m01:06:36.741309 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m01:06:36.742332 [info ] [MainThread]:   schema: RAW
[0m01:06:36.743351 [info ] [MainThread]:   authenticator: None
[0m01:06:36.745354 [info ] [MainThread]:   oauth_client_id: None
[0m01:06:36.746348 [info ] [MainThread]:   query_tag: None
[0m01:06:36.747347 [info ] [MainThread]:   client_session_keep_alive: False
[0m01:06:36.748351 [info ] [MainThread]:   host: None
[0m01:06:36.749283 [info ] [MainThread]:   port: None
[0m01:06:36.750287 [info ] [MainThread]:   proxy_host: None
[0m01:06:36.751556 [info ] [MainThread]:   proxy_port: None
[0m01:06:36.752560 [info ] [MainThread]:   protocol: None
[0m01:06:36.753561 [info ] [MainThread]:   connect_retries: 1
[0m01:06:36.755623 [info ] [MainThread]:   connect_timeout: None
[0m01:06:36.757582 [info ] [MainThread]:   retry_on_database_errors: False
[0m01:06:36.758567 [info ] [MainThread]:   retry_all: False
[0m01:06:36.759557 [info ] [MainThread]:   insecure_mode: False
[0m01:06:36.760694 [info ] [MainThread]:   reuse_connections: None
[0m01:06:36.762784 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m01:06:36.764084 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m01:06:36.765597 [debug] [MainThread]: Using snowflake connection "debug"
[0m01:06:36.766603 [debug] [MainThread]: On debug: select 1 as id
[0m01:06:36.766603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:06:39.959763 [debug] [MainThread]: SQL status: SUCCESS 1 in 3.0 seconds
[0m01:06:39.959763 [debug] [MainThread]: On debug: Close
[0m01:06:40.503044 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m01:06:40.518269 [info ] [MainThread]: [32mAll checks passed![0m
[0m01:06:40.520272 [debug] [MainThread]: Command `dbt debug` succeeded at 01:06:40.520272 after 8.36 seconds
[0m01:06:40.521271 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m01:06:40.522256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017137504EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001715ABAB040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001715AC8C8B0>]}
[0m01:06:40.522256 [debug] [MainThread]: Flushing usage events
[0m01:06:49.226249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266A1860F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266A070CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266A070C670>]}


============================== 01:06:49.230906 | 2dd44b63-14b3-4c2c-8854-3d11388ca95f ==============================
[0m01:06:49.230906 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:06:49.232230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:06:50.577961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266A072D640>]}
[0m01:06:50.688707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C4E88C70>]}
[0m01:06:50.690710 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m01:06:50.735775 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m01:06:52.206368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:06:52.206368 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m01:06:52.350347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C5436FA0>]}
[0m01:06:52.368755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C51ECD90>]}
[0m01:06:52.368755 [info ] [MainThread]: Found 1 model, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m01:06:52.370758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C51ECA60>]}
[0m01:06:52.372768 [info ] [MainThread]: 
[0m01:06:52.375942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:06:52.378546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m01:06:52.394407 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m01:06:52.395427 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m01:06:52.396436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:54.279268 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m01:06:54.281502 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m01:06:54.913102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m01:06:54.915028 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m01:06:54.915028 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m01:06:54.925265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:06:56.823727 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m01:06:56.825692 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m01:06:57.396560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C5491C70>]}
[0m01:06:57.397688 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m01:06:57.399342 [info ] [MainThread]: 
[0m01:06:57.404320 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m01:06:57.405607 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m01:06:57.408190 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m01:06:57.408744 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m01:06:57.417887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m01:06:57.419610 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 01:06:57.409291 => 01:06:57.419057
[0m01:06:57.420766 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m01:06:57.457855 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m01:06:57.461536 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m01:06:57.462531 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    TRY_CAST(ordered_at AS TIMESTAMP) as orderdate,
    TRY_CAST(CONCAT(LEFT(ordered_at, 4), SUBSTR(ordered_at, 6, 2), SUBSTR(ordered_at, 9, 2)) As INTEGER) As ORDERDATEKEY
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m01:06:57.463629 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:06:59.421635 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b47ca6-0205-2c52-0006-1c67000141ca
[0m01:06:59.422489 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 4 unexpected 'order_total'.
syntax error line 17 at position 0 unexpected 'from'.
syntax error line 21 at position 8 unexpected ')'.
[0m01:06:59.424497 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 01:06:57.421697 => 01:06:59.423668
[0m01:06:59.424497 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m01:07:00.010100 [debug] [Thread-1  ]: Database Error in model fact_orders (models\CORE\fact_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'order_total'.
  syntax error line 17 at position 0 unexpected 'from'.
  syntax error line 21 at position 8 unexpected ')'.
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m01:07:00.011626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dd44b63-14b3-4c2c-8854-3d11388ca95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C556F520>]}
[0m01:07:00.012091 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model RAW.fact_orders .......................... [[31mERROR[0m in 2.60s]
[0m01:07:00.014083 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m01:07:00.018093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:00.019085 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m01:07:00.020249 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m01:07:00.020249 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m01:07:00.021364 [info ] [MainThread]: 
[0m01:07:00.023365 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.65 seconds (7.65s).
[0m01:07:00.025365 [debug] [MainThread]: Command end result
[0m01:07:00.041712 [info ] [MainThread]: 
[0m01:07:00.042717 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:07:00.044772 [info ] [MainThread]: 
[0m01:07:00.045708 [error] [MainThread]:   Database Error in model fact_orders (models\CORE\fact_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 4 unexpected 'order_total'.
  syntax error line 17 at position 0 unexpected 'from'.
  syntax error line 21 at position 8 unexpected ')'.
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m01:07:00.048782 [info ] [MainThread]: 
[0m01:07:00.049708 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:07:00.052710 [debug] [MainThread]: Command `dbt run` failed at 01:07:00.052710 after 10.90 seconds
[0m01:07:00.053706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266A1860F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C4E88C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266C4F52520>]}
[0m01:07:00.054703 [debug] [MainThread]: Flushing usage events
[0m01:07:23.910562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A42EA0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A456CE8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A456CECA0>]}


============================== 01:07:23.914392 | 3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd ==============================
[0m01:07:23.914392 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:07:23.916969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:07:25.112034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A435B1F10>]}
[0m01:07:25.191850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A666A8580>]}
[0m01:07:25.207906 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m01:07:25.210913 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m01:07:25.389452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:07:25.389452 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m01:07:25.542247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A66A77F40>]}
[0m01:07:25.555825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A66837F10>]}
[0m01:07:25.556830 [info ] [MainThread]: Found 1 model, 6 sources, 0 exposures, 0 metrics, 676 macros, 0 groups, 0 semantic models
[0m01:07:25.559255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A66837D00>]}
[0m01:07:25.561287 [info ] [MainThread]: 
[0m01:07:25.562290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:07:25.565601 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m01:07:25.579870 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m01:07:25.580877 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m01:07:25.581871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:28.589965 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m01:07:28.591817 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m01:07:29.156324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m01:07:29.167169 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m01:07:29.167754 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m01:07:29.168295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:30.970479 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m01:07:30.972492 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m01:07:31.510889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6682CE50>]}
[0m01:07:31.511907 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m01:07:31.514408 [info ] [MainThread]: 
[0m01:07:31.519352 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m01:07:31.521166 [info ] [Thread-1  ]: 1 of 1 START sql table model RAW.fact_orders ................................... [RUN]
[0m01:07:31.523176 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m01:07:31.524143 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m01:07:31.531989 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m01:07:31.534402 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 01:07:31.524143 => 01:07:31.533952
[0m01:07:31.534402 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m01:07:31.560660 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m01:07:31.567621 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m01:07:31.568646 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.RAW.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    TRY_CAST(ordered_at AS TIMESTAMP) as orderdate,
    TRY_CAST(CONCAT(LEFT(ordered_at, 4), SUBSTR(ordered_at, 6, 2), SUBSTR(ordered_at, 9, 2)) As INTEGER) As ORDERDATEKEY,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m01:07:31.568646 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:07:43.937363 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 12.0 seconds
[0m01:07:43.937363 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m01:07:43.937363 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.RAW.fact_orders cluster by (sku);
[0m01:07:44.445345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m01:07:44.469687 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 01:07:31.535429 => 01:07:44.469178
[0m01:07:44.470586 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m01:07:45.015676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fb9db22-d5f3-44b4-a728-4e6b9f6e8dcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A66CFDDC0>]}
[0m01:07:45.016675 [info ] [Thread-1  ]: 1 of 1 OK created sql table model RAW.fact_orders .............................. [[32mSUCCESS 1[0m in 13.49s]
[0m01:07:45.017674 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m01:07:45.021231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:45.021231 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m01:07:45.022255 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m01:07:45.023255 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m01:07:45.024398 [info ] [MainThread]: 
[0m01:07:45.026489 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.46 seconds (19.46s).
[0m01:07:45.028334 [debug] [MainThread]: Command end result
[0m01:07:45.042135 [info ] [MainThread]: 
[0m01:07:45.043119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:07:45.044225 [info ] [MainThread]: 
[0m01:07:45.046119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:07:45.048125 [debug] [MainThread]: Command `dbt run` succeeded at 01:07:45.048125 after 21.20 seconds
[0m01:07:45.048125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A42EA0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A66C57550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A66576D00>]}
[0m01:07:45.049810 [debug] [MainThread]: Flushing usage events
[0m21:32:49.713256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F140FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F02CD5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F02CD880>]}


============================== 21:32:49.721490 | 9b7026c2-9717-4fa0-bf94-5e700ebbd225 ==============================
[0m21:32:49.721490 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:32:49.723182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:32:56.445613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F02CD730>]}
[0m21:32:56.557645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F1A465B0>]}
[0m21:32:56.560649 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:32:56.610140 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:32:56.731533 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:32:56.732748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F02ACE50>]}
[0m21:32:59.868729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7969A00D0>]}
[0m21:32:59.884865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D796417D60>]}
[0m21:32:59.885862 [info ] [MainThread]: Found 7 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:32:59.886860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D796429880>]}
[0m21:32:59.889264 [info ] [MainThread]: 
[0m21:32:59.891278 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:32:59.894279 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:32:59.904431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:32:59.909431 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:32:59.914423 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:32:59.915491 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m21:32:59.916425 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m21:32:59.917424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:59.918424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:03.034608 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m21:33:03.036610 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m21:33:03.132130 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m21:33:03.133958 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m21:33:04.627919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:33:04.630915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:33:04.639467 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:33:04.642486 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:33:04.644496 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:33:04.645864 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:33:04.646440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:04.647412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:06.424236 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m21:33:06.426236 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:33:06.527969 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.0 seconds
[0m21:33:06.530491 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:33:07.871374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D796433340>]}
[0m21:33:07.873164 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:33:07.874243 [info ] [MainThread]: 
[0m21:33:07.892803 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m21:33:07.892803 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m21:33:07.894800 [info ] [Thread-1  ]: 1 of 7 START sql table model CORE.fact_orders .................................. [RUN]
[0m21:33:07.896509 [info ] [Thread-2  ]: 2 of 7 START sql view model INTERMEDIATE.stg_customers ......................... [RUN]
[0m21:33:07.897540 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m21:33:07.899544 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m21:33:07.900548 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m21:33:07.902056 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m21:33:08.025014 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m21:33:08.030570 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m21:33:08.032969 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 21:33:07.902539 => 21:33:08.031950
[0m21:33:08.033980 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m21:33:08.062656 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 21:33:08.026016 => 21:33:08.062656
[0m21:33:08.068564 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m21:33:08.069550 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m21:33:08.096765 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m21:33:08.098764 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m21:33:08.101105 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    TRY_CAST(ordered_at AS TIMESTAMP) as orderdate,
    TRY_CAST(CONCAT(LEFT(ordered_at, 4), SUBSTR(ordered_at, 6, 2), SUBSTR(ordered_at, 9, 2)) As INTEGER) As ORDERDATEKEY,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m21:33:08.101763 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:33:08.104765 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m21:33:08.106769 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m21:33:08.107772 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:33:10.107379 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b48171-0205-2e36-0006-1c670001d062
[0m21:33:10.108378 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected '_AIRBYTE_EXTRACTED_AT'.
[0m21:33:10.109550 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 21:33:08.071327 => 21:33:10.109550
[0m21:33:10.110384 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m21:33:10.710877 [debug] [Thread-2  ]: Database Error in model stg_customers (models\INTERMEDIATE\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected '_AIRBYTE_EXTRACTED_AT'.
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_customers.sql
[0m21:33:10.711726 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D796BA52E0>]}
[0m21:33:10.712729 [error] [Thread-2  ]: 2 of 7 ERROR creating sql view model INTERMEDIATE.stg_customers ................ [[31mERROR[0m in 2.81s]
[0m21:33:10.714727 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m21:33:10.714727 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m21:33:10.715728 [info ] [Thread-2  ]: 3 of 7 START sql view model INTERMEDIATE.stg_items ............................. [RUN]
[0m21:33:10.717725 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m21:33:10.718730 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m21:33:10.722731 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m21:33:10.724728 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 21:33:10.718730 => 21:33:10.724728
[0m21:33:10.725962 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m21:33:10.730486 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m21:33:10.731691 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m21:33:10.732492 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m21:33:10.733661 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:33:12.632426 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:33:12.654421 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (execute): 21:33:10.726471 => 21:33:12.653420
[0m21:33:12.654421 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: Close
[0m21:33:13.220516 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7967E2B20>]}
[0m21:33:13.221516 [info ] [Thread-2  ]: 3 of 7 OK created sql view model INTERMEDIATE.stg_items ........................ [[32mSUCCESS 1[0m in 2.50s]
[0m21:33:13.224564 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_items
[0m21:33:13.225558 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_orders
[0m21:33:13.227561 [info ] [Thread-2  ]: 4 of 7 START sql view model INTERMEDIATE.stg_orders ............................ [RUN]
[0m21:33:13.229584 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_items, now model.dbt_jaffle_shop.stg_orders)
[0m21:33:13.230983 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_orders
[0m21:33:13.234578 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_orders"
[0m21:33:13.238161 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_orders (compile): 21:33:13.231578 => 21:33:13.237178
[0m21:33:13.238161 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_orders
[0m21:33:13.245165 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_orders"
[0m21:33:13.248388 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_orders"
[0m21:33:13.249171 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_orders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_orders
  
   as (
    SELECT 
id As order_id,
customer As customer_id,
store_id,
subtotal,
tax_paid,
order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders
  );
[0m21:33:13.250166 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:33:15.090344 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:33:15.094101 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_orders (execute): 21:33:13.239146 => 21:33:15.094101
[0m21:33:15.095095 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_orders: Close
[0m21:33:15.651708 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7967E21C0>]}
[0m21:33:15.652698 [info ] [Thread-2  ]: 4 of 7 OK created sql view model INTERMEDIATE.stg_orders ....................... [[32mSUCCESS 1[0m in 2.42s]
[0m21:33:15.654715 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_orders
[0m21:33:15.655715 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m21:33:15.657705 [info ] [Thread-2  ]: 5 of 7 START sql view model INTERMEDIATE.stg_products .......................... [RUN]
[0m21:33:15.659712 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_orders, now model.dbt_jaffle_shop.stg_products)
[0m21:33:15.660703 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m21:33:15.665702 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m21:33:15.667711 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 21:33:15.661703 => 21:33:15.667086
[0m21:33:15.668705 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m21:33:15.673707 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m21:33:15.676708 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m21:33:15.677706 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m21:33:15.678703 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:33:17.425092 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b48171-0205-2c55-0006-1c670001055e
[0m21:33:17.425659 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 0
invalid identifier 'SKU'
[0m21:33:17.426813 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 21:33:15.668705 => 21:33:17.426813
[0m21:33:17.427920 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m21:33:17.996592 [debug] [Thread-2  ]: Database Error in model stg_products (models\INTERMEDIATE\stg_products.sql)
  000904 (42000): SQL compilation error: error line 5 at position 0
  invalid identifier 'SKU'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_products.sql
[0m21:33:17.997464 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7967AFA90>]}
[0m21:33:17.998473 [error] [Thread-2  ]: 5 of 7 ERROR creating sql view model INTERMEDIATE.stg_products ................. [[31mERROR[0m in 2.34s]
[0m21:33:18.000473 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m21:33:18.001479 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m21:33:18.002484 [info ] [Thread-2  ]: 6 of 7 START sql view model INTERMEDIATE.stg_stores ............................ [RUN]
[0m21:33:18.004467 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_stores)
[0m21:33:18.005467 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m21:33:18.009479 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m21:33:18.011468 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 21:33:18.005467 => 21:33:18.011468
[0m21:33:18.012469 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m21:33:18.018480 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m21:33:18.020537 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m21:33:18.022465 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m21:33:18.022465 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:33:19.865837 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:33:19.869140 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 21:33:18.013469 => 21:33:19.869140
[0m21:33:19.870218 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m21:33:20.449087 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7967E2B20>]}
[0m21:33:20.450884 [info ] [Thread-2  ]: 6 of 7 OK created sql view model INTERMEDIATE.stg_stores ....................... [[32mSUCCESS 1[0m in 2.45s]
[0m21:33:20.452142 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m21:33:20.452867 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m21:33:20.453851 [info ] [Thread-2  ]: 7 of 7 START sql view model INTERMEDIATE.stg_supplies .......................... [RUN]
[0m21:33:20.456861 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.stg_supplies)
[0m21:33:20.457860 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m21:33:20.462869 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m21:33:20.465453 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 21:33:20.457860 => 21:33:20.464912
[0m21:33:20.466556 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m21:33:20.471469 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m21:33:20.474479 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m21:33:20.475481 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m21:33:20.477485 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:33:22.213702 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 14.0 seconds
[0m21:33:22.214691 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m21:33:22.215697 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.CORE.fact_orders cluster by (sku);
[0m21:33:22.360061 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:33:22.363184 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 21:33:20.467474 => 21:33:22.363184
[0m21:33:22.364055 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m21:33:22.718233 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:22.721234 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 21:33:08.033980 => 21:33:22.721234
[0m21:33:22.722191 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m21:33:22.958234 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7967E21C0>]}
[0m21:33:22.958956 [info ] [Thread-2  ]: 7 of 7 OK created sql view model INTERMEDIATE.stg_supplies ..................... [[32mSUCCESS 1[0m in 2.50s]
[0m21:33:22.960986 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m21:33:23.321421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7026c2-9717-4fa0-bf94-5e700ebbd225', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D79659A040>]}
[0m21:33:23.322426 [info ] [Thread-1  ]: 1 of 7 OK created sql table model CORE.fact_orders ............................. [[32mSUCCESS 1[0m in 15.42s]
[0m21:33:23.324413 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m21:33:23.327413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:23.328733 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m21:33:23.329409 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m21:33:23.329409 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:33:23.330408 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:33:23.331429 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m21:33:23.331429 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_supplies' was properly closed.
[0m21:33:23.333409 [info ] [MainThread]: 
[0m21:33:23.335410 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 23.44 seconds (23.44s).
[0m21:33:23.338408 [debug] [MainThread]: Command end result
[0m21:33:23.358067 [info ] [MainThread]: 
[0m21:33:23.361003 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:33:23.362990 [info ] [MainThread]: 
[0m21:33:23.364992 [error] [MainThread]:   Database Error in model stg_customers (models\INTERMEDIATE\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected '_AIRBYTE_EXTRACTED_AT'.
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_customers.sql
[0m21:33:23.365988 [info ] [MainThread]: 
[0m21:33:23.367997 [error] [MainThread]:   Database Error in model stg_products (models\INTERMEDIATE\stg_products.sql)
  000904 (42000): SQL compilation error: error line 5 at position 0
  invalid identifier 'SKU'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_products.sql
[0m21:33:23.368991 [info ] [MainThread]: 
[0m21:33:23.370996 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m21:33:23.372991 [debug] [MainThread]: Command `dbt run` failed at 21:33:23.372003 after 33.76 seconds
[0m21:33:23.373994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7F140FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7962DA730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D796BCA310>]}
[0m21:33:23.374991 [debug] [MainThread]: Flushing usage events
[0m21:34:34.701104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA7620F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA64CCA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA64CC670>]}


============================== 21:34:34.707125 | 5336002d-62bb-4114-91c8-e23b7193d2a6 ==============================
[0m21:34:34.707125 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:34:34.709107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:34:36.115436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA64ED640>]}
[0m21:34:36.204602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCAE275B0>]}
[0m21:34:36.206582 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:34:36.226201 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:34:36.453968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:34:36.454971 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\INTERMEDIATE\stg_customers.sql
[0m21:34:36.454971 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\INTERMEDIATE\stg_products.sql
[0m21:34:36.598644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB1D3F40>]}
[0m21:34:36.613546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCAFEDBE0>]}
[0m21:34:36.614558 [info ] [MainThread]: Found 7 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:34:36.616557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCAFED8B0>]}
[0m21:34:36.618475 [info ] [MainThread]: 
[0m21:34:36.620454 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:34:36.623469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:34:36.625476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:34:36.640727 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:34:36.644707 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:34:36.646716 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m21:34:36.647867 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m21:34:36.648711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:36.648711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:39.792346 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m21:34:39.794327 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m21:34:39.832401 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m21:34:39.834392 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m21:34:40.628433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:34:40.630471 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:34:40.640751 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:34:40.643760 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:34:40.644733 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:34:40.645732 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:34:40.647383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:40.647750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:42.683528 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:42.686556 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:34:43.612124 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:34:43.613880 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:34:44.355891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB2613A0>]}
[0m21:34:44.357894 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:34:44.358893 [info ] [MainThread]: 
[0m21:34:44.364896 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m21:34:44.365912 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m21:34:44.367891 [info ] [Thread-1  ]: 1 of 7 START sql table model CORE.fact_orders .................................. [RUN]
[0m21:34:44.370896 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.fact_orders'
[0m21:34:44.369136 [info ] [Thread-2  ]: 2 of 7 START sql view model INTERMEDIATE.stg_customers ......................... [RUN]
[0m21:34:44.372884 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m21:34:44.374909 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m21:34:44.395854 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m21:34:44.396854 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m21:34:44.401856 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m21:34:44.404113 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 21:34:44.374909 => 21:34:44.402876
[0m21:34:44.404806 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m21:34:44.405690 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 21:34:44.397859 => 21:34:44.405690
[0m21:34:44.438506 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m21:34:44.440053 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m21:34:44.467499 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m21:34:44.470083 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m21:34:44.471594 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (select * from (
              

SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    orders.id as salesorderid,
    customer,
    subtotal,
    tax_paid as tax,
    TRY_CAST(ordered_at AS TIMESTAMP) as orderdate,
    TRY_CAST(CONCAT(LEFT(ordered_at, 4), SUBSTR(ordered_at, 6, 2), SUBSTR(ordered_at, 9, 2)) As INTEGER) As ORDERDATEKEY,
    order_total,
    sku
from JAFFLE_SHOP.RAW.raw_orders as orders
inner join JAFFLE_SHOP.RAW.raw_items as items 
on orders.id = items.order_id
              ) order by (sku)
        );
[0m21:34:44.472088 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:34:44.474090 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m21:34:44.476976 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m21:34:44.479798 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:34:46.336873 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:46.359082 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 21:34:44.441251 => 21:34:46.359082
[0m21:34:46.360267 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m21:34:46.955248 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB568730>]}
[0m21:34:46.956254 [info ] [Thread-2  ]: 2 of 7 OK created sql view model INTERMEDIATE.stg_customers .................... [[32mSUCCESS 1[0m in 2.58s]
[0m21:34:46.958250 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m21:34:46.959241 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m21:34:46.960261 [info ] [Thread-2  ]: 3 of 7 START sql view model INTERMEDIATE.stg_items ............................. [RUN]
[0m21:34:46.962260 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m21:34:46.962260 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m21:34:46.966337 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m21:34:46.968263 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 21:34:46.963260 => 21:34:46.967234
[0m21:34:46.968263 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m21:34:46.973250 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m21:34:46.975239 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m21:34:46.976253 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m21:34:46.976253 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:34:48.834256 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:48.840277 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (execute): 21:34:46.969263 => 21:34:48.839276
[0m21:34:48.841277 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: Close
[0m21:34:49.389137 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB5A4C10>]}
[0m21:34:49.391029 [info ] [Thread-2  ]: 3 of 7 OK created sql view model INTERMEDIATE.stg_items ........................ [[32mSUCCESS 1[0m in 2.43s]
[0m21:34:49.393017 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_items
[0m21:34:49.394010 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_orders
[0m21:34:49.396290 [info ] [Thread-2  ]: 4 of 7 START sql view model INTERMEDIATE.stg_orders ............................ [RUN]
[0m21:34:49.398259 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_items, now model.dbt_jaffle_shop.stg_orders)
[0m21:34:49.399792 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_orders
[0m21:34:49.405261 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_orders"
[0m21:34:49.408514 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_orders (compile): 21:34:49.400267 => 21:34:49.407272
[0m21:34:49.409491 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_orders
[0m21:34:49.416500 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_orders"
[0m21:34:49.417872 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_orders"
[0m21:34:49.418809 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_orders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_orders
  
   as (
    SELECT 
id As order_id,
customer As customer_id,
store_id,
subtotal,
tax_paid,
order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders
  );
[0m21:34:49.419822 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:34:51.336705 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:51.339728 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_orders (execute): 21:34:49.410488 => 21:34:51.339728
[0m21:34:51.340943 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_orders: Close
[0m21:34:51.924941 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB41DE50>]}
[0m21:34:51.926703 [info ] [Thread-2  ]: 4 of 7 OK created sql view model INTERMEDIATE.stg_orders ....................... [[32mSUCCESS 1[0m in 2.53s]
[0m21:34:51.928420 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_orders
[0m21:34:51.929519 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m21:34:51.930917 [info ] [Thread-2  ]: 5 of 7 START sql view model INTERMEDIATE.stg_products .......................... [RUN]
[0m21:34:51.933330 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_orders, now model.dbt_jaffle_shop.stg_products)
[0m21:34:51.934328 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m21:34:51.939747 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m21:34:51.941918 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 21:34:51.935327 => 21:34:51.941918
[0m21:34:51.943916 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m21:34:51.949911 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m21:34:51.952307 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m21:34:51.953300 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m21:34:51.954300 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:34:53.895231 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:53.898307 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 21:34:51.944929 => 21:34:53.897231
[0m21:34:53.899221 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m21:34:54.541099 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB5EFF70>]}
[0m21:34:54.542103 [info ] [Thread-2  ]: 5 of 7 OK created sql view model INTERMEDIATE.stg_products ..................... [[32mSUCCESS 1[0m in 2.61s]
[0m21:34:54.544105 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m21:34:54.545097 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m21:34:54.546098 [info ] [Thread-2  ]: 6 of 7 START sql view model INTERMEDIATE.stg_stores ............................ [RUN]
[0m21:34:54.549100 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_stores)
[0m21:34:54.550101 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m21:34:54.555104 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m21:34:54.556106 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 21:34:54.550101 => 21:34:54.556106
[0m21:34:54.557109 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m21:34:54.561097 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m21:34:54.563097 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m21:34:54.564104 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m21:34:54.564104 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:34:55.955297 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 11.0 seconds
[0m21:34:55.956298 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m21:34:55.957305 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
alter table JAFFLE_SHOP.CORE.fact_orders cluster by (sku);
[0m21:34:56.355956 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:56.360285 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 21:34:54.558175 => 21:34:56.359981
[0m21:34:56.360977 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m21:34:56.418408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:34:56.420430 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 21:34:44.406697 => 21:34:56.420430
[0m21:34:56.421835 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m21:34:56.914568 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB41D1F0>]}
[0m21:34:56.915577 [info ] [Thread-2  ]: 6 of 7 OK created sql view model INTERMEDIATE.stg_stores ....................... [[32mSUCCESS 1[0m in 2.37s]
[0m21:34:56.916736 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m21:34:56.917750 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m21:34:56.918780 [info ] [Thread-2  ]: 7 of 7 START sql view model INTERMEDIATE.stg_supplies .......................... [RUN]
[0m21:34:56.919863 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.stg_supplies)
[0m21:34:56.920751 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m21:34:56.925765 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m21:34:56.926755 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 21:34:56.922009 => 21:34:56.926755
[0m21:34:56.927753 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m21:34:56.932756 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m21:34:56.933752 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m21:34:56.934751 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m21:34:56.936018 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:34:56.964632 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB560D90>]}
[0m21:34:56.965633 [info ] [Thread-1  ]: 1 of 7 OK created sql table model CORE.fact_orders ............................. [[32mSUCCESS 1[0m in 12.59s]
[0m21:34:56.967610 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m21:34:58.841647 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:34:58.845275 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 21:34:56.928757 => 21:34:58.844642
[0m21:34:58.846113 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m21:34:59.422808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5336002d-62bb-4114-91c8-e23b7193d2a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCB431FA0>]}
[0m21:34:59.424444 [info ] [Thread-2  ]: 7 of 7 OK created sql view model INTERMEDIATE.stg_supplies ..................... [[32mSUCCESS 1[0m in 2.50s]
[0m21:34:59.426717 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m21:34:59.430202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:59.431942 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m21:34:59.433663 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m21:34:59.435680 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:34:59.436831 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:34:59.437448 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m21:34:59.437972 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_supplies' was properly closed.
[0m21:34:59.438732 [info ] [MainThread]: 
[0m21:34:59.440401 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 22.82 seconds (22.82s).
[0m21:34:59.443829 [debug] [MainThread]: Command end result
[0m21:34:59.466657 [info ] [MainThread]: 
[0m21:34:59.468372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:34:59.469456 [info ] [MainThread]: 
[0m21:34:59.471230 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:34:59.475436 [debug] [MainThread]: Command `dbt run` succeeded at 21:34:59.474918 after 24.85 seconds
[0m21:34:59.478650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA7620F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCAC4B8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FCAD5FB50>]}
[0m21:34:59.480675 [debug] [MainThread]: Flushing usage events
[0m21:50:21.449866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021156C40EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155AECBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155AEC880>]}


============================== 21:50:21.455474 | d0a15170-820f-4ef2-8cf8-0434010a8174 ==============================
[0m21:50:21.455474 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:50:21.456845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dates', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:50:22.843648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A26E730>]}
[0m21:50:22.939590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A28D340>]}
[0m21:50:22.941463 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:50:22.968021 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m21:50:23.175805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 0 files changed.
[0m21:50:23.176855 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\CORE\dim_stores.sql
[0m21:50:23.177284 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\CORE\dim_products.sql
[0m21:50:23.177901 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\CORE\dim_date.sql
[0m21:50:23.178860 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\dates.sql
[0m21:50:23.180026 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\CORE\dim_customers.sql
[0m21:50:23.482491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A8F9F70>]}
[0m21:50:23.500438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A60C400>]}
[0m21:50:23.501588 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:50:23.503312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A60C070>]}
[0m21:50:23.505534 [info ] [MainThread]: 
[0m21:50:23.507171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:23.509338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m21:50:23.519754 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m21:50:23.520374 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m21:50:23.521612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:26.824306 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m21:50:26.827317 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m21:50:27.383912 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:50:27.386911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:50:27.399904 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:50:27.402905 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:50:27.404907 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:50:27.405906 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:50:27.406905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:27.408121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:29.333660 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:50:29.335672 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:50:29.474863 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:50:29.476854 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:50:30.017145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_CORE)
[0m21:50:30.023211 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:50:30.024422 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:50:30.025510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:50:31.744360 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:50:31.746356 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:50:32.331662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A60CDC0>]}
[0m21:50:32.333666 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:50:32.335676 [info ] [MainThread]: 
[0m21:50:32.340679 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m21:50:32.342683 [info ] [Thread-1  ]: 1 of 1 START sql view model RAW.dates .......................................... [RUN]
[0m21:50:32.344672 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m21:50:32.345760 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m21:50:32.355557 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m21:50:32.356535 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m21:50:32.357005 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:50:34.856699 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:50:34.885606 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m21:50:34.887704 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 21:50:32.346671 => 21:50:34.886550
[0m21:50:34.888869 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m21:50:34.925283 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m21:50:34.932867 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m21:50:34.934836 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m21:50:35.450194 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:50:35.471962 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 21:50:34.889742 => 21:50:35.471962
[0m21:50:35.473810 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m21:50:36.046572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0a15170-820f-4ef2-8cf8-0434010a8174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117AB965B0>]}
[0m21:50:36.048577 [info ] [Thread-1  ]: 1 of 1 OK created sql view model RAW.dates ..................................... [[32mSUCCESS 1[0m in 3.70s]
[0m21:50:36.049572 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m21:50:36.052581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:36.053837 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m21:50:36.055094 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:50:36.055094 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:50:36.056446 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dates' was properly closed.
[0m21:50:36.057473 [info ] [MainThread]: 
[0m21:50:36.058475 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.55 seconds (12.55s).
[0m21:50:36.060476 [debug] [MainThread]: Command end result
[0m21:50:36.078125 [info ] [MainThread]: 
[0m21:50:36.079673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:36.080674 [info ] [MainThread]: 
[0m21:50:36.082741 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:50:36.086464 [debug] [MainThread]: Command `dbt run` succeeded at 21:50:36.085496 after 14.71 seconds
[0m21:50:36.087462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021156C40EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A31E2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117A348F40>]}
[0m21:50:36.088459 [debug] [MainThread]: Flushing usage events
[0m22:03:37.150772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6F52CF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6F419DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6F419D5B0>]}


============================== 22:03:37.155891 | ee344c49-9e8c-413e-9966-5336a1c64c23 ==============================
[0m22:03:37.155891 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:03:37.157411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:03:38.636660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6988F8730>]}
[0m22:03:38.753800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6989727C0>]}
[0m22:03:38.755804 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:03:38.777833 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:03:39.010640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:03:39.011639 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\dim_date.sql
[0m22:03:39.012678 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m22:03:39.209389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D698EE60D0>]}
[0m22:03:39.225940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D698C9B250>]}
[0m22:03:39.226948 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:03:39.229013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D698C9B100>]}
[0m22:03:39.232112 [info ] [MainThread]: 
[0m22:03:39.234009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:39.237688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:03:39.246730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:03:39.258621 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:03:39.264577 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:03:39.266241 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:03:39.267122 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:03:39.268236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:39.269124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:42.429806 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:03:42.431889 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:03:42.439731 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:03:42.441735 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:03:43.138911 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:03:43.140163 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:03:43.140598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:45.433458 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:03:45.435091 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:03:46.200152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m22:03:46.203160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:03:46.213165 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:03:46.217343 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:03:46.218399 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:03:46.219411 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:03:46.220332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:46.221344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:48.457041 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m22:03:48.460048 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:03:48.461040 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:03:48.465489 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:03:49.092586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_CORE)
[0m22:03:49.099582 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:03:49.099582 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:03:49.100581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:51.096959 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:51.098890 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:03:51.734335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D698EDDBB0>]}
[0m22:03:51.736338 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:03:51.738346 [info ] [MainThread]: 
[0m22:03:51.744342 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m22:03:51.745336 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m22:03:51.746343 [info ] [Thread-1  ]: 1 of 12 START sql view model RAW.dates ......................................... [RUN]
[0m22:03:51.749345 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m22:03:51.747335 [info ] [Thread-2  ]: 2 of 12 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m22:03:51.750336 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m22:03:51.752343 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m22:03:51.808385 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:03:51.809383 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m22:03:51.810384 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m22:03:51.816382 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m22:03:51.818387 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:03:51.823396 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 22:03:51.811388 => 22:03:51.822385
[0m22:03:51.827144 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m22:03:51.876839 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m22:03:51.879837 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m22:03:51.880834 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m22:03:51.881840 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:03:54.005172 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:54.084872 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m22:03:54.087855 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:54.112351 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 22:03:51.829068 => 22:03:54.112068
[0m22:03:54.113194 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m22:03:54.113972 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 22:03:51.753338 => 22:03:54.113194
[0m22:03:54.115870 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m22:03:54.120857 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m22:03:54.127879 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:03:54.127879 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m22:03:54.755797 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6991D6B20>]}
[0m22:03:54.756810 [info ] [Thread-2  ]: 2 of 12 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 3.00s]
[0m22:03:54.759156 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m22:03:54.760180 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m22:03:54.761174 [info ] [Thread-2  ]: 3 of 12 START sql view model INTERMEDIATE.stg_items ............................ [RUN]
[0m22:03:54.763185 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m22:03:54.763185 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m22:03:54.767176 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m22:03:54.769181 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 22:03:54.764177 => 22:03:54.768176
[0m22:03:54.769181 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m22:03:54.775230 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m22:03:54.777405 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:03:54.781258 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 22:03:54.116879 => 22:03:54.780701
[0m22:03:54.782453 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m22:03:54.783529 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m22:03:54.786342 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m22:03:54.788363 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:03:55.351708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6991D6BE0>]}
[0m22:03:55.353032 [info ] [Thread-1  ]: 1 of 12 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.60s]
[0m22:03:55.354688 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m22:03:55.354688 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_orders
[0m22:03:55.355698 [info ] [Thread-1  ]: 4 of 12 START sql view model INTERMEDIATE.stg_orders ........................... [RUN]
[0m22:03:55.358698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_orders)
[0m22:03:55.359698 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_orders
[0m22:03:55.363696 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_orders"
[0m22:03:55.366045 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (compile): 22:03:55.359698 => 22:03:55.365711
[0m22:03:55.367010 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_orders
[0m22:03:55.371011 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_orders"
[0m22:03:55.374013 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_orders"
[0m22:03:55.375007 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_orders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_orders
  
   as (
    SELECT 
id As order_id,
customer As customer_id,
store_id,
subtotal,
tax_paid,
order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders
  );
[0m22:03:55.376004 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:56.675273 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:56.679947 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (execute): 22:03:54.770131 => 22:03:56.679375
[0m22:03:56.680514 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: Close
[0m22:03:57.226035 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D699261910>]}
[0m22:03:57.227013 [info ] [Thread-2  ]: 3 of 12 OK created sql view model INTERMEDIATE.stg_items ....................... [[32mSUCCESS 1[0m in 2.46s]
[0m22:03:57.229042 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_items
[0m22:03:57.230034 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m22:03:57.231017 [info ] [Thread-2  ]: 5 of 12 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m22:03:57.233015 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_items, now model.dbt_jaffle_shop.stg_products)
[0m22:03:57.234028 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m22:03:57.239022 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m22:03:57.240014 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 22:03:57.235316 => 22:03:57.240014
[0m22:03:57.241017 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m22:03:57.245464 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m22:03:57.248466 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m22:03:57.249468 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m22:03:57.249468 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:03:57.291749 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:57.294741 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (execute): 22:03:55.367010 => 22:03:57.294741
[0m22:03:57.296113 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: Close
[0m22:03:57.888233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6990DAA60>]}
[0m22:03:57.889377 [info ] [Thread-1  ]: 4 of 12 OK created sql view model INTERMEDIATE.stg_orders ...................... [[32mSUCCESS 1[0m in 2.53s]
[0m22:03:57.891114 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_orders
[0m22:03:57.892366 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m22:03:57.893994 [info ] [Thread-1  ]: 6 of 12 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m22:03:57.895735 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_orders, now model.dbt_jaffle_shop.stg_stores)
[0m22:03:57.896867 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m22:03:57.985479 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m22:03:57.986846 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 22:03:57.896867 => 22:03:57.985798
[0m22:03:57.987509 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m22:03:57.992054 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m22:03:57.994084 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m22:03:57.996052 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m22:03:57.997060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:03:59.316875 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:59.320582 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 22:03:57.241017 => 22:03:59.320582
[0m22:03:59.322589 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m22:03:59.897528 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:03:59.900518 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 22:03:57.987775 => 22:03:59.900518
[0m22:03:59.901539 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m22:03:59.912132 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D699367BE0>]}
[0m22:03:59.913229 [info ] [Thread-2  ]: 5 of 12 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.68s]
[0m22:03:59.915212 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m22:03:59.915212 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m22:03:59.917209 [info ] [Thread-2  ]: 7 of 12 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m22:03:59.919209 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_supplies)
[0m22:03:59.920740 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m22:03:59.925594 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:03:59.926596 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 22:03:59.920740 => 22:03:59.926596
[0m22:03:59.927566 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m22:03:59.932882 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:03:59.934586 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m22:03:59.935575 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m22:03:59.936589 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:04:00.594877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6990E3F40>]}
[0m22:04:00.595876 [info ] [Thread-1  ]: 6 of 12 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 2.70s]
[0m22:04:00.597877 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m22:04:00.598875 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m22:04:00.600877 [info ] [Thread-1  ]: 8 of 12 START sql table model CORE.dim_customers ............................... [RUN]
[0m22:04:00.604480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m22:04:00.605861 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m22:04:00.617455 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m22:04:00.619451 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 22:04:00.606482 => 22:04:00.618457
[0m22:04:00.620457 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m22:04:00.650024 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m22:04:00.652892 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m22:04:00.653416 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m22:04:00.655388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:01.933619 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:04:01.938778 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 22:03:59.928564 => 22:04:01.937779
[0m22:04:01.939778 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m22:04:03.672031 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D699371310>]}
[0m22:04:03.673416 [info ] [Thread-2  ]: 7 of 12 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 3.75s]
[0m22:04:03.674719 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m22:04:03.675710 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m22:04:03.676702 [info ] [Thread-2  ]: 9 of 12 START sql table model CORE.dim_date .................................... [RUN]
[0m22:04:03.679719 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m22:04:03.680769 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m22:04:03.684709 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m22:04:03.686278 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 22:04:03.680769 => 22:04:03.685769
[0m22:04:03.686922 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m22:04:03.691321 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m22:04:03.693298 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m22:04:03.693298 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m22:04:03.694295 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:04:04.954994 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:04:04.957835 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 22:04:00.621465 => 22:04:04.957835
[0m22:04:04.958836 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m22:04:05.583547 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6991A9190>]}
[0m22:04:05.585090 [info ] [Thread-1  ]: 8 of 12 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 4.98s]
[0m22:04:05.586836 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m22:04:05.587466 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:04:05.588745 [info ] [Thread-1  ]: 10 of 12 START sql table model CORE.fact_orders ................................ [RUN]
[0m22:04:05.590956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.fact_orders)
[0m22:04:05.591465 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:04:05.600345 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m22:04:05.601774 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:04:05.592451 => 22:04:05.601327
[0m22:04:05.602338 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m22:04:05.606065 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m22:04:05.609581 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:04:05.609581 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (SELECT
    md5(cast(coalesce(cast(orders.id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    TRY_CAST(CONCAT(LEFT(ordered_date, 4), SUBSTR(ordered_date, 6, 2), SUBSTR(ordered_date, 9, 2)) As INTEGER) As date_key,
    orders.id as salesorderid,
    subtotal,
    tax_paid as tax,
    order_total,
    order_date
from JAFFLE_SHOP.INTERMEDIATE.stg_orders as orders
inner join JAFFLE_SHOP.INTERMEDIATE.stg_items as items 
on orders.order_id = items.order_id
        );
[0m22:04:05.610906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:07.257123 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:04:07.259735 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 22:04:03.687292 => 22:04:07.259735
[0m22:04:07.260776 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m22:04:07.656543 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b48190-0205-2c56-0000-00061c67f5a5
[0m22:04:07.657543 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 27
invalid identifier 'ORDERS.ID'
[0m22:04:07.658598 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 22:04:05.603040 => 22:04:07.658598
[0m22:04:07.659140 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m22:04:07.957897 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6993718B0>]}
[0m22:04:07.959529 [info ] [Thread-2  ]: 9 of 12 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 4.28s]
[0m22:04:07.960532 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m22:04:07.961530 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m22:04:07.962538 [info ] [Thread-2  ]: 11 of 12 START sql table model CORE.dim_products ............................... [RUN]
[0m22:04:07.964527 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_products)
[0m22:04:07.965490 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m22:04:07.972029 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m22:04:07.985331 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 22:04:07.966007 => 22:04:07.984760
[0m22:04:07.985331 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m22:04:07.991288 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m22:04:07.994289 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m22:04:07.995287 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m22:04:07.996290 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:04:08.283469 [debug] [Thread-1  ]: Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'ORDERS.ID'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:04:08.284061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6990E3400>]}
[0m22:04:08.285052 [error] [Thread-1  ]: 10 of 12 ERROR creating sql table model CORE.fact_orders ....................... [[31mERROR[0m in 2.69s]
[0m22:04:08.287051 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:04:08.288259 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m22:04:08.289043 [info ] [Thread-1  ]: 12 of 12 START sql table model CORE.dim_stores ................................. [RUN]
[0m22:04:08.291024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.fact_orders, now model.dbt_jaffle_shop.dim_stores)
[0m22:04:08.292340 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m22:04:08.297602 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m22:04:08.299142 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 22:04:08.293041 => 22:04:08.299142
[0m22:04:08.300149 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m22:04:08.304149 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m22:04:08.306154 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m22:04:08.307271 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m22:04:08.308143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:04:11.035081 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:04:11.038093 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 22:04:08.300149 => 22:04:11.038093
[0m22:04:11.039093 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m22:04:11.146211 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:04:11.149204 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 22:04:07.986511 => 22:04:11.149204
[0m22:04:11.150206 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m22:04:11.682809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6990E3FD0>]}
[0m22:04:11.684603 [info ] [Thread-1  ]: 12 of 12 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.39s]
[0m22:04:11.685736 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m22:04:12.757162 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee344c49-9e8c-413e-9966-5336a1c64c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6991B8E50>]}
[0m22:04:12.758162 [info ] [Thread-2  ]: 11 of 12 OK created sql table model CORE.dim_products .......................... [[32mSUCCESS 1[0m in 4.79s]
[0m22:04:12.760158 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m22:04:12.762166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:12.763568 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:04:12.764085 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:04:12.764085 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m22:04:12.765105 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:04:12.765105 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m22:04:12.766094 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_products' was properly closed.
[0m22:04:12.767101 [info ] [MainThread]: 
[0m22:04:12.768097 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 33.53 seconds (33.53s).
[0m22:04:12.771122 [debug] [MainThread]: Command end result
[0m22:04:12.788175 [info ] [MainThread]: 
[0m22:04:12.789180 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:12.791185 [info ] [MainThread]: 
[0m22:04:12.793182 [error] [MainThread]:   Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 4 at position 27
  invalid identifier 'ORDERS.ID'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:04:12.795183 [info ] [MainThread]: 
[0m22:04:12.796179 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m22:04:12.798176 [debug] [MainThread]: Command `dbt run` failed at 22:04:12.798176 after 35.71 seconds
[0m22:04:12.799178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6F52CF820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6989727C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D699027490>]}
[0m22:04:12.800258 [debug] [MainThread]: Flushing usage events
[0m22:05:19.739465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC2F90790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC1FEA910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC1E3D8B0>]}


============================== 22:05:19.745672 | f1742482-dfd9-4c18-b189-eddc884fb57a ==============================
[0m22:05:19.745672 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:05:19.747877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:21.167354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC57BE6D0>]}
[0m22:05:21.295727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC57E21C0>]}
[0m22:05:21.298727 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:05:21.333983 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:05:21.554281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:21.556387 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m22:05:21.773394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6BA30D0>]}
[0m22:05:21.795972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6964250>]}
[0m22:05:21.797112 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:05:21.797990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6964280>]}
[0m22:05:21.801042 [info ] [MainThread]: 
[0m22:05:21.803071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:21.807060 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:05:21.821058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:05:21.830303 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:05:21.835394 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:05:21.838100 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:05:21.840000 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:05:21.842245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:21.843483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:24.993604 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:05:24.995595 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:05:25.009761 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:05:25.011586 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:05:25.658116 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:05:25.659539 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:05:25.660096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:27.456564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:05:27.458553 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:05:28.058644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m22:05:28.060650 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:05:28.074473 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:05:28.080190 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:05:28.082186 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:05:28.083858 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:05:28.084890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:28.086479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:30.263290 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m22:05:30.265273 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:05:30.598282 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:05:30.601414 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:05:30.850333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m22:05:30.857330 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:05:30.858326 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:05:30.858326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:05:32.794333 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:05:32.796340 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:05:33.446229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE66CE070>]}
[0m22:05:33.448683 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:05:33.450465 [info ] [MainThread]: 
[0m22:05:33.456841 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m22:05:33.457972 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m22:05:33.459663 [info ] [Thread-1  ]: 1 of 12 START sql view model RAW.dates ......................................... [RUN]
[0m22:05:33.463045 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m22:05:33.460847 [info ] [Thread-2  ]: 2 of 12 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m22:05:33.464715 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m22:05:33.465978 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m22:05:33.510968 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:05:33.512061 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m22:05:33.512969 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m22:05:33.519006 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m22:05:33.519666 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:05:33.523590 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 22:05:33.513968 => 22:05:33.522911
[0m22:05:33.526708 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m22:05:33.563042 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m22:05:33.565034 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m22:05:33.566046 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m22:05:33.567041 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:05:35.600475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:35.658570 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:35.686300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m22:05:35.710290 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 22:05:33.527725 => 22:05:35.709281
[0m22:05:35.711583 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m22:05:35.714273 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 22:05:33.467086 => 22:05:35.713272
[0m22:05:35.716538 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m22:05:35.722264 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m22:05:35.729281 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:05:35.730284 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m22:05:36.307375 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:05:36.311373 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 22:05:35.717274 => 22:05:36.310363
[0m22:05:36.312369 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m22:05:36.318183 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6EC1310>]}
[0m22:05:36.318371 [info ] [Thread-2  ]: 2 of 12 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.85s]
[0m22:05:36.321371 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m22:05:36.322371 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m22:05:36.323358 [info ] [Thread-2  ]: 3 of 12 START sql view model INTERMEDIATE.stg_items ............................ [RUN]
[0m22:05:36.325371 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m22:05:36.325371 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m22:05:36.329382 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m22:05:36.331440 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 22:05:36.326371 => 22:05:36.331190
[0m22:05:36.332440 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m22:05:36.337457 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m22:05:36.339512 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m22:05:36.340509 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m22:05:36.341521 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:37.044361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6F23FA0>]}
[0m22:05:37.045363 [info ] [Thread-1  ]: 1 of 12 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.58s]
[0m22:05:37.047344 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m22:05:37.048373 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_orders
[0m22:05:37.049362 [info ] [Thread-1  ]: 4 of 12 START sql view model INTERMEDIATE.stg_orders ........................... [RUN]
[0m22:05:37.051357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_orders)
[0m22:05:37.052361 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_orders
[0m22:05:37.056946 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_orders"
[0m22:05:37.057923 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (compile): 22:05:37.052361 => 22:05:37.057923
[0m22:05:37.058924 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_orders
[0m22:05:37.062936 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_orders"
[0m22:05:37.064923 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_orders"
[0m22:05:37.066106 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_orders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_orders
  
   as (
    SELECT 
id As order_id,
customer As customer_id,
store_id,
subtotal,
tax_paid,
order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders
  );
[0m22:05:37.066944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:38.280965 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:38.284966 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (execute): 22:05:36.333455 => 22:05:38.284966
[0m22:05:38.285945 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: Close
[0m22:05:39.021430 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:39.025438 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (execute): 22:05:37.059946 => 22:05:39.025438
[0m22:05:39.026453 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: Close
[0m22:05:39.058999 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6FD2B20>]}
[0m22:05:39.060587 [info ] [Thread-2  ]: 3 of 12 OK created sql view model INTERMEDIATE.stg_items ....................... [[32mSUCCESS 1[0m in 2.73s]
[0m22:05:39.062273 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_items
[0m22:05:39.062830 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m22:05:39.064473 [info ] [Thread-2  ]: 5 of 12 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m22:05:39.066092 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_items, now model.dbt_jaffle_shop.stg_products)
[0m22:05:39.066696 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m22:05:39.071588 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m22:05:39.073388 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 22:05:39.067246 => 22:05:39.072782
[0m22:05:39.074613 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m22:05:39.080252 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m22:05:39.082906 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m22:05:39.084293 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m22:05:39.085046 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:39.760089 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6E56D00>]}
[0m22:05:39.761668 [info ] [Thread-1  ]: 4 of 12 OK created sql view model INTERMEDIATE.stg_orders ...................... [[32mSUCCESS 1[0m in 2.71s]
[0m22:05:39.763671 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_orders
[0m22:05:39.763671 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m22:05:39.765908 [info ] [Thread-1  ]: 6 of 12 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m22:05:39.767032 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_orders, now model.dbt_jaffle_shop.stg_stores)
[0m22:05:39.767906 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m22:05:39.772887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m22:05:39.775572 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 22:05:39.768908 => 22:05:39.774944
[0m22:05:39.776486 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m22:05:39.883439 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m22:05:39.885446 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m22:05:39.887128 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m22:05:39.887730 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:40.992902 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:40.995903 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 22:05:39.075732 => 22:05:40.995903
[0m22:05:40.996883 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m22:05:41.566493 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE7045D60>]}
[0m22:05:41.568024 [info ] [Thread-2  ]: 5 of 12 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.50s]
[0m22:05:41.570054 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m22:05:41.571046 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m22:05:41.573029 [info ] [Thread-2  ]: 7 of 12 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m22:05:41.576056 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_supplies)
[0m22:05:41.577617 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m22:05:41.581651 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:05:41.583641 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 22:05:41.578266 => 22:05:41.582652
[0m22:05:41.584704 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m22:05:41.588652 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:05:41.590653 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m22:05:41.591654 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m22:05:41.592644 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:41.838219 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:41.841223 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 22:05:39.776486 => 22:05:41.841223
[0m22:05:41.842216 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m22:05:42.478205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6F647F0>]}
[0m22:05:42.479900 [info ] [Thread-1  ]: 6 of 12 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 2.71s]
[0m22:05:42.481900 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m22:05:42.482910 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m22:05:42.483904 [info ] [Thread-1  ]: 8 of 12 START sql table model CORE.dim_customers ............................... [RUN]
[0m22:05:42.486893 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m22:05:42.487891 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m22:05:42.494883 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m22:05:42.495960 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 22:05:42.488891 => 22:05:42.495960
[0m22:05:42.497480 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m22:05:42.519355 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m22:05:42.521360 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m22:05:42.522055 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m22:05:42.522356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:43.544722 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:05:43.548076 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 22:05:41.584704 => 22:05:43.548076
[0m22:05:43.548826 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m22:05:44.172887 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6EB8D90>]}
[0m22:05:44.173893 [info ] [Thread-2  ]: 7 of 12 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 2.60s]
[0m22:05:44.176891 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m22:05:44.177881 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m22:05:44.179886 [info ] [Thread-2  ]: 9 of 12 START sql table model CORE.dim_date .................................... [RUN]
[0m22:05:44.181885 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m22:05:44.182887 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m22:05:44.188881 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m22:05:44.190900 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 22:05:44.183890 => 22:05:44.190900
[0m22:05:44.192885 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m22:05:44.199887 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m22:05:44.201879 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m22:05:44.203886 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m22:05:44.205210 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:45.653355 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:05:45.657356 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 22:05:42.497879 => 22:05:45.657356
[0m22:05:45.658357 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m22:05:46.271378 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6E79580>]}
[0m22:05:46.273116 [info ] [Thread-1  ]: 8 of 12 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 3.79s]
[0m22:05:46.276074 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m22:05:46.277061 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:05:46.279081 [info ] [Thread-1  ]: 10 of 12 START sql table model CORE.fact_orders ................................ [RUN]
[0m22:05:46.281053 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.fact_orders)
[0m22:05:46.282064 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:05:46.291075 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m22:05:46.293060 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:05:46.282463 => 22:05:46.292062
[0m22:05:46.294066 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m22:05:46.298074 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m22:05:46.300073 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:05:46.301442 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (SELECT
    md5(cast(coalesce(cast(orders.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.order_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    TRY_CAST(CONCAT(LEFT(ordered_date, 4), SUBSTR(ordered_date, 6, 2), SUBSTR(ordered_date, 9, 2)) As INTEGER) As date_key,
    orders.id as salesorderid,
    subtotal,
    tax_paid as tax,
    order_total,
    order_date
from JAFFLE_SHOP.INTERMEDIATE.stg_orders as orders
inner join JAFFLE_SHOP.INTERMEDIATE.stg_items as items 
on orders.order_id = items.order_id
        );
[0m22:05:46.302070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:47.628478 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:05:47.631482 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 22:05:44.193887 => 22:05:47.630475
[0m22:05:47.631482 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m22:05:48.136910 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b48191-0205-2c58-0006-1c6700018596
[0m22:05:48.137800 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 4
invalid identifier 'ORDERS.ID'
[0m22:05:48.138531 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 22:05:46.294066 => 22:05:48.138531
[0m22:05:48.139548 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m22:05:48.175714 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6C03AC0>]}
[0m22:05:48.176733 [info ] [Thread-2  ]: 9 of 12 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 3.99s]
[0m22:05:48.177724 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m22:05:48.178728 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m22:05:48.180735 [info ] [Thread-2  ]: 11 of 12 START sql table model CORE.dim_products ............................... [RUN]
[0m22:05:48.182734 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_products)
[0m22:05:48.183730 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m22:05:48.189229 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m22:05:48.190207 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 22:05:48.183730 => 22:05:48.190207
[0m22:05:48.191553 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m22:05:48.197684 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m22:05:48.198792 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m22:05:48.200015 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m22:05:48.200015 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:05:48.708496 [debug] [Thread-1  ]: Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'ORDERS.ID'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:05:48.710048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6F6FAF0>]}
[0m22:05:48.710496 [error] [Thread-1  ]: 10 of 12 ERROR creating sql table model CORE.fact_orders ....................... [[31mERROR[0m in 2.43s]
[0m22:05:48.712502 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:05:48.714519 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m22:05:48.715925 [info ] [Thread-1  ]: 12 of 12 START sql table model CORE.dim_stores ................................. [RUN]
[0m22:05:48.717568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.fact_orders, now model.dbt_jaffle_shop.dim_stores)
[0m22:05:48.718578 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m22:05:48.724571 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m22:05:48.726586 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 22:05:48.719752 => 22:05:48.725577
[0m22:05:48.726586 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m22:05:48.730588 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m22:05:48.732775 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m22:05:48.733651 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m22:05:48.734336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:05:50.871913 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:05:50.875894 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 22:05:48.192674 => 22:05:50.874912
[0m22:05:50.876901 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m22:05:51.483678 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE704E550>]}
[0m22:05:51.485679 [info ] [Thread-2  ]: 11 of 12 OK created sql table model CORE.dim_products .......................... [[32mSUCCESS 1[0m in 3.30s]
[0m22:05:51.487692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:05:51.488687 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m22:05:51.492698 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 22:05:48.727704 => 22:05:51.492698
[0m22:05:51.494708 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m22:05:52.076886 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1742482-dfd9-4c18-b189-eddc884fb57a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6FC9E50>]}
[0m22:05:52.077888 [info ] [Thread-1  ]: 12 of 12 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.36s]
[0m22:05:52.080147 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m22:05:52.082900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:52.083992 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:05:52.084999 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:05:52.084999 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:05:52.086537 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m22:05:52.087090 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m22:05:52.088104 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_products' was properly closed.
[0m22:05:52.088642 [info ] [MainThread]: 
[0m22:05:52.090373 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 30.29 seconds (30.29s).
[0m22:05:52.093335 [debug] [MainThread]: Command end result
[0m22:05:52.110164 [info ] [MainThread]: 
[0m22:05:52.112162 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:52.114166 [info ] [MainThread]: 
[0m22:05:52.115158 [error] [MainThread]:   Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 9 at position 4
  invalid identifier 'ORDERS.ID'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:05:52.118171 [info ] [MainThread]: 
[0m22:05:52.120176 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m22:05:52.122165 [debug] [MainThread]: Command `dbt run` failed at 22:05:52.122165 after 32.46 seconds
[0m22:05:52.123161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC2F90790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EC57E21C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EE6FED970>]}
[0m22:05:52.124160 [debug] [MainThread]: Flushing usage events
[0m22:06:49.084955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CC7808E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CB64D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CB64D1F0>]}


============================== 22:06:49.090826 | 18966896-65b4-4f07-b3f5-fa8539a1d5e6 ==============================
[0m22:06:49.090826 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:06:49.091791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.357677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CF032BB0>]}
[0m22:06:50.463829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227EFEB9BB0>]}
[0m22:06:50.465825 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:06:50.491831 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:06:50.714681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:50.716049 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m22:06:50.934606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F03920D0>]}
[0m22:06:50.961896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F0151550>]}
[0m22:06:50.963139 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:06:50.964945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F01512E0>]}
[0m22:06:50.967609 [info ] [MainThread]: 
[0m22:06:50.969601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:50.972605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:06:50.988577 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:06:50.989381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:06:50.991375 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:06:50.996359 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:06:50.997378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:50.998367 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:06:51.001453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:54.124133 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:06:54.125890 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:06:54.127909 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:06:54.133904 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:06:54.725410 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:06:54.726432 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:06:54.727492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:06:57.001768 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:06:57.006649 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:06:57.662397 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m22:06:57.664407 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m22:06:57.673398 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:06:57.678374 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:06:57.679269 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:06:57.679780 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:06:57.680796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:57.681803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:59.639030 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:06:59.640962 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:06:59.769236 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:06:59.772224 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:07:00.285968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m22:07:00.292770 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:07:00.294029 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:07:00.294663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:02.033126 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m22:07:02.036050 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:07:02.638334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CB64DA90>]}
[0m22:07:02.640194 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:07:02.642204 [info ] [MainThread]: 
[0m22:07:02.647212 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m22:07:02.648219 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m22:07:02.649884 [info ] [Thread-1  ]: 1 of 12 START sql view model RAW.dates ......................................... [RUN]
[0m22:07:02.651195 [info ] [Thread-2  ]: 2 of 12 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m22:07:02.653203 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m22:07:02.655220 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m22:07:02.656213 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m22:07:02.657251 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m22:07:02.700392 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:07:02.704556 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m22:07:02.705380 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m22:07:02.707442 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:07:02.710382 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 22:07:02.700392 => 22:07:02.709394
[0m22:07:02.713458 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m22:07:02.752453 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m22:07:02.753884 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m22:07:02.754901 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m22:07:02.755908 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:07:04.483301 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:04.559356 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m22:07:04.561198 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 22:07:02.657843 => 22:07:04.560575
[0m22:07:04.561954 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m22:07:04.567747 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m22:07:04.575031 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:07:04.576125 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m22:07:04.759327 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:04.781984 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 22:07:02.714452 => 22:07:04.781984
[0m22:07:04.782766 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m22:07:05.125453 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:07:05.129453 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 22:07:04.562513 => 22:07:05.128443
[0m22:07:05.129453 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m22:07:05.375146 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F067DCD0>]}
[0m22:07:05.376057 [info ] [Thread-2  ]: 2 of 12 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.72s]
[0m22:07:05.377054 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m22:07:05.379068 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m22:07:05.380066 [info ] [Thread-2  ]: 3 of 12 START sql view model INTERMEDIATE.stg_items ............................ [RUN]
[0m22:07:05.383057 [debug] [MainThread]: Snowflake adapter: Cancelling query 'model.dbt_jaffle_shop.dates' (26246373445)
[0m22:07:05.384066 [debug] [MainThread]: Using snowflake connection "master"
[0m22:07:05.385074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "master"} */
select system$cancel_all_queries(26246373445)
[0m22:07:05.385074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:07:05.653951 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m22:07:05.655273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:05.656326 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m22:07:05.657324 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:07:05.662300 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m22:07:05.664254 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:07:05.666315 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:07:05.667315 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:07:05.668300 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 22:07:05.658506 => 22:07:05.667315
[0m22:07:05.668300 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dates' was left open.
[0m22:07:05.669620 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m22:07:05.670310 [debug] [MainThread]: On model.dbt_jaffle_shop.dates: Close
[0m22:07:05.675310 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m22:07:06.726285 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m22:07:06.727436 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18966896-65b4-4f07-b3f5-fa8539a1d5e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F03E56A0>]}
[0m22:07:06.724830 [error] [MainThread]: Encountered an error:

[0m22:07:06.729150 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m22:07:06.731067 [info ] [Thread-1  ]: 1 of 12 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 4.07s]
[0m22:07:06.734635 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:07:06.737080 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m22:07:07.089783 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 387, in execute_nodes
    self.run_queue(pool)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 300, in run_queue
    node = self.job_queue.get()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\graph\queue.py", line 125, in get
    _, node_id = self.inner.get(block=block, timeout=timeout)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\queue.py", line 171, in get
    self.not_empty.wait()
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\threading.py", line 312, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 463, in execute_with_hooks
    res = self.execute_nodes()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 412, in execute_nodes
    self._cancel_connections(pool)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 360, in _cancel_connections
    for conn_name in adapter.cancel_open_connections():
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\base\impl.py", line 1250, in cancel_open_connections
    return self.connections.cancel_open()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\sql\connections.py", line 43, in cancel_open
    self.cancel(connection)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 402, in cancel
    _, cursor = self.add_query(sql)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 507, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 563, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 483, in add_standard_query
    return super().add_query(self._add_query_comment(sql), **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\sql\connections.py", line 79, in add_query
    cursor = connection.handle.cursor()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\contracts\connection.py", line 90, in handle
    self._handle.resolve(self)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\contracts\connection.py", line 114, in resolve
    return self.opener(connection)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 383, in open
    return cls.retry_connection(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\base\connections.py", line 241, in retry_connection
    connection.handle = connect()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 347, in connect
    handle = snowflake.connector.connect(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\__init__.py", line 54, in Connect
    return SnowflakeConnection(**kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\connection.py", line 438, in __init__
    self.connect(**kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\connection.py", line 741, in connect
    self.__open_connection()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\connection.py", line 1069, in __open_connection
    self.authenticate_with_retry(self.auth_class)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\connection.py", line 1341, in authenticate_with_retry
    self._authenticate(auth_instance)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\connection.py", line 1369, in _authenticate
    auth.authenticate(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\auth\_auth.py", line 250, in authenticate
    ret = self._rest._post_request(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 734, in _post_request
    ret = self.fetch(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 884, in _request_exec_wrapper
    return_object = self._request_exec(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 1078, in _request_exec
    raw_ret = session.request(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\requests\adapters.py", line 486, in send
    resp = conn.urlopen(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connection.py", line 363, in connect
    self.sock = conn = self._new_conn()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\util\connection.py", line 92, in create_connection
    sock.connect(sa)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\contrib\pyopenssl.py", line 496, in wrap_socket
    cnx.do_handshake()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\OpenSSL\SSL.py", line 2193, in do_handshake
    self._raise_ssl_error(self._ssl, result)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\OpenSSL\SSL.py", line 1801, in _raise_ssl_error
    raise WantReadError()
OpenSSL.SSL.WantReadError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 278, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\main.py", line 625, in run
    results = task.run()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 502, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\runnable.py", line 466, in execute_with_hooks
    adapter.cleanup_connections()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\base\impl.py", line 261, in cleanup_connections
    self.connections.cleanup_all()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\base\connections.py", line 315, in cleanup_all
    self.close(connection)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\base\connections.py", line 385, in close
    cls._close_handle(connection)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\adapters\base\connections.py", line 352, in _close_handle
    connection.handle.close()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\connection.py", line 765, in close
    self.rest.delete_session(retry=retry)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 653, in delete_session
    ret = self._post_request(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 734, in _post_request
    ret = self.fetch(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 843, in fetch
    ret = self._request_exec_wrapper(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 884, in _request_exec_wrapper
    return_object = self._request_exec(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\network.py", line 1078, in _request_exec
    raw_ret = session.request(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\requests\adapters.py", line 486, in send
    resp = conn.urlopen(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connectionpool.py", line 404, in _make_request
    self._validate_conn(conn)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connectionpool.py", line 1058, in _validate_conn
    conn.connect()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\connection.py", line 419, in connect
    self.sock = ssl_wrap_socket(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\ssl_wrap_socket.py", line 77, in ssl_wrap_socket_with_ocsp
    ret = ssl_.ssl_wrap_socket(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\util\ssl_.py", line 449, in ssl_wrap_socket
    ssl_sock = _ssl_wrap_socket_impl(
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\util\ssl_.py", line 493, in _ssl_wrap_socket_impl
    return ssl_context.wrap_socket(sock, server_hostname=server_hostname)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\contrib\pyopenssl.py", line 498, in wrap_socket
    if not util.wait_for_read(sock, sock.gettimeout()):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\util\wait.py", line 145, in wait_for_read
    return wait_for_socket(sock, read=True, timeout=timeout)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\util\wait.py", line 85, in select_wait_for_socket
    rready, wready, xready = _retry_on_intr(fn, timeout)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\snowflake\connector\vendored\urllib3\util\wait.py", line 43, in _retry_on_intr
    return fn(timeout)
KeyboardInterrupt

[0m22:07:07.113925 [debug] [MainThread]: Command `dbt run` failed at 22:07:07.112930 after 18.10 seconds
[0m22:07:07.115227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:07.115935 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:07:07.116942 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:07:07.118969 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:07:07.119961 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:07:07.121196 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dates' was properly closed.
[0m22:07:07.121933 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_items' was properly closed.
[0m22:07:07.122931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CC7808E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F0584A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227F05844C0>]}
[0m22:07:07.124941 [debug] [MainThread]: Flushing usage events
[0m22:07:13.313414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C479FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C366D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C366D880>]}


============================== 22:07:13.319402 | 4a7b1d57-8ee8-4f34-9021-330aa459a6b0 ==============================
[0m22:07:13.319402 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:07:13.321402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:07:14.693576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C366D730>]}
[0m22:07:14.788811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C4DD65B0>]}
[0m22:07:14.790747 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:07:14.813756 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:07:15.014112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:07:15.015108 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m22:07:15.185129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E83B50D0>]}
[0m22:07:15.201258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E8171580>]}
[0m22:07:15.202550 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:07:15.203255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E8171310>]}
[0m22:07:15.206266 [info ] [MainThread]: 
[0m22:07:15.208261 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:07:15.211280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:07:15.213135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:07:15.228489 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:07:15.232489 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:07:15.234079 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:07:15.235098 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:07:15.236935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:15.237687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:17.326998 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:07:17.328996 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:07:17.334009 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:07:17.336155 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:07:17.939801 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:07:17.940801 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:07:17.941801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:26.267403 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 8.0 seconds
[0m22:07:26.268814 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:07:26.827679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m22:07:26.849845 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:07:26.851868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m22:07:26.853384 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:07:26.860554 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:07:26.865143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:26.868146 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:07:26.873147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:07:29.773399 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.0 seconds
[0m22:07:29.777419 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:07:29.849040 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:07:29.851115 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:07:30.351420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m22:07:30.358431 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:07:30.359704 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:07:30.360218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:07:32.144345 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m22:07:32.146323 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:07:32.915073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E7EDE730>]}
[0m22:07:32.917105 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:07:32.918102 [info ] [MainThread]: 
[0m22:07:32.923891 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m22:07:32.925119 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m22:07:32.926848 [info ] [Thread-1  ]: 1 of 12 START sql view model RAW.dates ......................................... [RUN]
[0m22:07:32.928552 [info ] [Thread-2  ]: 2 of 12 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m22:07:32.930222 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m22:07:32.931969 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m22:07:32.933055 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m22:07:32.934216 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m22:07:32.989397 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:07:32.995199 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m22:07:32.996373 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m22:07:32.998075 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:07:33.000051 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 22:07:32.989982 => 22:07:32.999910
[0m22:07:33.003577 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m22:07:33.038357 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m22:07:33.040358 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m22:07:33.041356 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m22:07:33.042356 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:07:34.781236 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:34.880454 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m22:07:34.882748 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 22:07:32.934620 => 22:07:34.881473
[0m22:07:34.883776 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m22:07:34.888773 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m22:07:34.897362 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:07:34.898366 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m22:07:34.961873 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:34.986206 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 22:07:33.005575 => 22:07:34.986062
[0m22:07:34.987165 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m22:07:35.397058 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:07:35.400162 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 22:07:34.883776 => 22:07:35.400162
[0m22:07:35.401190 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m22:07:35.715674 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E86B4940>]}
[0m22:07:35.717398 [info ] [Thread-2  ]: 2 of 12 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.78s]
[0m22:07:35.718664 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m22:07:35.720139 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m22:07:35.721685 [info ] [Thread-2  ]: 3 of 12 START sql view model INTERMEDIATE.stg_items ............................ [RUN]
[0m22:07:35.722675 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m22:07:35.723672 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m22:07:35.728678 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m22:07:35.729684 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 22:07:35.724660 => 22:07:35.729684
[0m22:07:35.730686 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m22:07:35.736689 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m22:07:35.738681 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m22:07:35.739789 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m22:07:35.740299 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:07:36.048561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E86E67F0>]}
[0m22:07:36.049561 [info ] [Thread-1  ]: 1 of 12 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.12s]
[0m22:07:36.051538 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m22:07:36.052541 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_orders
[0m22:07:36.053550 [info ] [Thread-1  ]: 4 of 12 START sql view model INTERMEDIATE.stg_orders ........................... [RUN]
[0m22:07:36.056108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_orders)
[0m22:07:36.057134 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_orders
[0m22:07:36.062137 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_orders"
[0m22:07:36.064108 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (compile): 22:07:36.058109 => 22:07:36.063117
[0m22:07:36.065333 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_orders
[0m22:07:36.068858 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_orders"
[0m22:07:36.070808 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_orders"
[0m22:07:36.071680 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_orders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_orders
  
   as (
    SELECT 
id As order_id,
customer As customer_id,
store_id,
subtotal,
tax_paid,
order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders
  );
[0m22:07:36.072699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:07:39.820086 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:07:39.822657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:07:39.825824 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (execute): 22:07:35.731688 => 22:07:39.825824
[0m22:07:39.830142 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (execute): 22:07:36.065333 => 22:07:39.830142
[0m22:07:39.831573 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: Close
[0m22:07:39.832716 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: Close
[0m22:07:40.510611 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E87722E0>]}
[0m22:07:40.511453 [info ] [Thread-2  ]: 3 of 12 OK created sql view model INTERMEDIATE.stg_items ....................... [[32mSUCCESS 1[0m in 4.79s]
[0m22:07:40.513497 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_items
[0m22:07:40.515498 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m22:07:40.516547 [info ] [Thread-2  ]: 5 of 12 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m22:07:40.518543 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_items, now model.dbt_jaffle_shop.stg_products)
[0m22:07:40.520545 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m22:07:40.526185 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m22:07:40.528192 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 22:07:40.520545 => 22:07:40.527188
[0m22:07:40.529187 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m22:07:40.690292 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m22:07:40.692615 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m22:07:40.693903 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m22:07:40.695104 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:07:41.307453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E8851EE0>]}
[0m22:07:41.308630 [info ] [Thread-1  ]: 4 of 12 OK created sql view model INTERMEDIATE.stg_orders ...................... [[32mSUCCESS 1[0m in 5.25s]
[0m22:07:41.310647 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_orders
[0m22:07:41.311645 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m22:07:41.312656 [info ] [Thread-1  ]: 6 of 12 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m22:07:41.314662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_orders, now model.dbt_jaffle_shop.stg_stores)
[0m22:07:41.315645 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m22:07:41.320235 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m22:07:41.321814 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 22:07:41.316372 => 22:07:41.321213
[0m22:07:41.322215 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m22:07:41.328221 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m22:07:41.330214 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m22:07:41.331214 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m22:07:41.332212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:07:42.505626 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:42.508658 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 22:07:40.530188 => 22:07:42.508658
[0m22:07:42.509735 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m22:07:43.104639 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E86E1700>]}
[0m22:07:43.105650 [info ] [Thread-2  ]: 5 of 12 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.59s]
[0m22:07:43.109136 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m22:07:43.109136 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m22:07:43.111128 [info ] [Thread-2  ]: 7 of 12 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m22:07:43.113120 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_supplies)
[0m22:07:43.114138 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m22:07:43.119134 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:07:43.121111 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 22:07:43.115114 => 22:07:43.120124
[0m22:07:43.121111 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m22:07:43.127111 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:07:43.129117 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m22:07:43.130114 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m22:07:43.131121 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:07:43.250998 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:43.255008 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 22:07:41.323341 => 22:07:43.254008
[0m22:07:43.256139 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m22:07:43.835524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E85B2760>]}
[0m22:07:43.837125 [info ] [Thread-1  ]: 6 of 12 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 2.52s]
[0m22:07:43.839302 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m22:07:43.841087 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m22:07:43.842711 [info ] [Thread-1  ]: 8 of 12 START sql table model CORE.dim_customers ............................... [RUN]
[0m22:07:43.844817 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m22:07:43.846003 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m22:07:43.851783 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m22:07:43.853469 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 22:07:43.846590 => 22:07:43.852958
[0m22:07:43.854551 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m22:07:43.880905 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m22:07:43.883967 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m22:07:43.885133 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m22:07:43.886808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:07:45.054062 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:07:45.057837 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 22:07:43.122416 => 22:07:45.057298
[0m22:07:45.058448 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m22:07:45.734336 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E8584610>]}
[0m22:07:45.735456 [info ] [Thread-2  ]: 7 of 12 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 2.62s]
[0m22:07:45.738328 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m22:07:45.739623 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m22:07:45.740336 [info ] [Thread-2  ]: 9 of 12 START sql table model CORE.dim_date .................................... [RUN]
[0m22:07:45.742357 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m22:07:45.743346 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m22:07:45.749334 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m22:07:45.750332 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 22:07:45.744330 => 22:07:45.750332
[0m22:07:45.751346 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m22:07:45.756873 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m22:07:45.759334 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m22:07:45.760328 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m22:07:45.762341 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:07:46.890748 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:07:46.893222 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 22:07:43.855163 => 22:07:46.893222
[0m22:07:46.894585 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m22:07:48.254655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E867DD30>]}
[0m22:07:48.256617 [info ] [Thread-1  ]: 8 of 12 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 4.41s]
[0m22:07:48.258600 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m22:07:48.258600 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:07:48.260944 [info ] [Thread-1  ]: 10 of 12 START sql table model CORE.fact_orders ................................ [RUN]
[0m22:07:48.262952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.fact_orders)
[0m22:07:48.264253 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:07:48.276034 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m22:07:48.278090 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:07:48.265493 => 22:07:48.277575
[0m22:07:48.278633 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m22:07:48.283007 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m22:07:48.286015 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:07:48.286015 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (SELECT
    md5(cast(coalesce(cast(orders.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.item_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    TRY_CAST(CONCAT(LEFT(ordered_date, 4), SUBSTR(ordered_date, 6, 2), SUBSTR(ordered_date, 9, 2)) As INTEGER) As date_key,
    orders.order_id as salesorderid,
    item_id as salesitemid,
    subtotal,
    tax_paid as tax,
    order_total,
    order_date
from JAFFLE_SHOP.INTERMEDIATE.stg_orders as orders
inner join JAFFLE_SHOP.INTERMEDIATE.stg_items as items 
on orders.order_id = items.order_id
        );
[0m22:07:48.287008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:07:48.891981 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:07:48.894863 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 22:07:45.752346 => 22:07:48.894863
[0m22:07:48.895866 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m22:07:49.522145 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E86B4940>]}
[0m22:07:49.524147 [info ] [Thread-2  ]: 9 of 12 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 3.78s]
[0m22:07:49.525153 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m22:07:49.526151 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m22:07:49.527150 [info ] [Thread-2  ]: 11 of 12 START sql table model CORE.dim_products ............................... [RUN]
[0m22:07:49.528616 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_products)
[0m22:07:49.529653 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m22:07:49.535657 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m22:07:49.536871 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 22:07:49.529653 => 22:07:49.536655
[0m22:07:49.537655 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m22:07:49.542670 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m22:07:49.543651 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m22:07:49.544666 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m22:07:49.545648 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:07:50.037505 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b48193-0205-2c52-0006-1c6700014676
[0m22:07:50.038523 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 4
invalid identifier 'ORDER_DATE'
[0m22:07:50.040073 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 22:07:48.279939 => 22:07:50.039555
[0m22:07:50.041440 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m22:07:50.597606 [debug] [Thread-1  ]: Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 4
  invalid identifier 'ORDER_DATE'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:07:50.598606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E86E6460>]}
[0m22:07:50.599584 [error] [Thread-1  ]: 10 of 12 ERROR creating sql table model CORE.fact_orders ....................... [[31mERROR[0m in 2.34s]
[0m22:07:50.600581 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:07:50.601821 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m22:07:50.602600 [info ] [Thread-1  ]: 12 of 12 START sql table model CORE.dim_stores ................................. [RUN]
[0m22:07:50.604600 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.fact_orders, now model.dbt_jaffle_shop.dim_stores)
[0m22:07:50.605603 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m22:07:50.610601 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m22:07:50.611826 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 22:07:50.605603 => 22:07:50.610601
[0m22:07:50.612589 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m22:07:50.616598 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m22:07:50.619175 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m22:07:50.620177 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m22:07:50.621165 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:07:52.274613 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:07:52.278609 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 22:07:49.537655 => 22:07:52.277609
[0m22:07:52.279611 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m22:07:52.848831 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E86E6130>]}
[0m22:07:52.849447 [info ] [Thread-2  ]: 11 of 12 OK created sql table model CORE.dim_products .......................... [[32mSUCCESS 1[0m in 3.32s]
[0m22:07:52.852438 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m22:07:53.240848 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:07:53.244811 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 22:07:50.612589 => 22:07:53.243794
[0m22:07:53.244811 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m22:07:53.792142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a7b1d57-8ee8-4f34-9021-330aa459a6b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E83EF3A0>]}
[0m22:07:53.793123 [info ] [Thread-1  ]: 12 of 12 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.19s]
[0m22:07:53.796133 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m22:07:53.799129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:07:53.800142 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:07:53.801121 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:07:53.801121 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:07:53.802120 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:07:53.802120 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m22:07:53.803120 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_products' was properly closed.
[0m22:07:53.804129 [info ] [MainThread]: 
[0m22:07:53.805196 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 38.60 seconds (38.60s).
[0m22:07:53.809140 [debug] [MainThread]: Command end result
[0m22:07:53.828861 [info ] [MainThread]: 
[0m22:07:53.830857 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:07:53.832853 [info ] [MainThread]: 
[0m22:07:53.834851 [error] [MainThread]:   Database Error in model fact_orders (models\CORE\fact_orders.sql)
  000904 (42000): SQL compilation error: error line 14 at position 4
  invalid identifier 'ORDER_DATE'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\fact_orders.sql
[0m22:07:53.836847 [info ] [MainThread]: 
[0m22:07:53.837852 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m22:07:53.841853 [debug] [MainThread]: Command `dbt run` failed at 22:07:53.840857 after 40.60 seconds
[0m22:07:53.842847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C479FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259C4DD65B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259E7F5CDC0>]}
[0m22:07:53.844049 [debug] [MainThread]: Flushing usage events
[0m22:08:38.530743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AE8A08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AD75D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AD75D1F0>]}


============================== 22:08:38.536560 | 726edb23-26e3-4b02-883e-1c9612a3fbd3 ==============================
[0m22:08:38.536560 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:08:38.537758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:08:39.932996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207B1152BB0>]}
[0m22:08:40.019314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D0FE9BB0>]}
[0m22:08:40.022297 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:08:40.041819 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:08:40.275938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:08:40.277581 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m22:08:40.475819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D24C20D0>]}
[0m22:08:40.493805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D1281550>]}
[0m22:08:40.494809 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:08:40.496794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D12812E0>]}
[0m22:08:40.498807 [info ] [MainThread]: 
[0m22:08:40.501656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:08:40.505644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:08:40.522482 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:08:40.524464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m22:08:40.526456 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:08:40.531467 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:08:40.532488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:40.533479 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:08:40.537637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:43.987240 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:08:43.989617 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:08:44.034899 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:08:44.036891 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:08:44.648560 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m22:08:44.650540 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m22:08:44.651563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:46.335023 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:08:46.337024 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m22:08:46.938572 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:08:46.942571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m22:08:46.952950 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:08:46.956248 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:08:46.957251 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:08:46.958256 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:08:46.960093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:46.961060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:08:48.872047 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:08:48.874068 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:08:48.936943 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m22:08:48.939122 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:08:49.564954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m22:08:49.570961 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:08:49.571963 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:08:49.573082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:08:51.275069 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:08:51.277084 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:08:51.864073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D26B6A90>]}
[0m22:08:51.866074 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:08:51.868079 [info ] [MainThread]: 
[0m22:08:51.873261 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m22:08:51.874079 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m22:08:51.876075 [info ] [Thread-1  ]: 1 of 12 START sql view model RAW.dates ......................................... [RUN]
[0m22:08:51.878078 [info ] [Thread-2  ]: 2 of 12 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m22:08:51.880078 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m22:08:51.883089 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m22:08:51.884075 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m22:08:51.886201 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m22:08:51.933458 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:08:51.937459 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m22:08:51.939457 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m22:08:51.940815 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 22:08:51.933458 => 22:08:51.940815
[0m22:08:51.941458 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:08:51.943464 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m22:08:51.980817 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m22:08:51.983821 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m22:08:51.983821 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m22:08:51.984822 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:08:53.870840 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:08:53.955982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m22:08:53.957782 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 22:08:51.887096 => 22:08:53.956841
[0m22:08:53.958782 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m22:08:53.963790 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m22:08:53.970783 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m22:08:53.971874 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m22:08:54.047706 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:08:54.069760 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 22:08:51.947576 => 22:08:54.069760
[0m22:08:54.071463 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m22:08:54.463896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:08:54.467754 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 22:08:53.958782 => 22:08:54.467240
[0m22:08:54.468768 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m22:08:54.713341 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D2517490>]}
[0m22:08:54.715244 [info ] [Thread-2  ]: 2 of 12 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.83s]
[0m22:08:54.717200 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m22:08:54.717200 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_items
[0m22:08:54.719192 [info ] [Thread-2  ]: 3 of 12 START sql view model INTERMEDIATE.stg_items ............................ [RUN]
[0m22:08:54.721198 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_items)
[0m22:08:54.722201 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_items
[0m22:08:54.726201 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_items"
[0m22:08:54.728154 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (compile): 22:08:54.722201 => 22:08:54.728154
[0m22:08:54.729197 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_items
[0m22:08:54.733197 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_items"
[0m22:08:54.735196 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_items"
[0m22:08:54.736196 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_items"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_items
  
   as (
    SELECT
ID As item_id,
sku As product_id,
order_id,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_items
  );
[0m22:08:54.737201 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:08:55.036085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D264CF40>]}
[0m22:08:55.037076 [info ] [Thread-1  ]: 1 of 12 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.16s]
[0m22:08:55.039068 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m22:08:55.040061 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_orders
[0m22:08:55.041065 [info ] [Thread-1  ]: 4 of 12 START sql view model INTERMEDIATE.stg_orders ........................... [RUN]
[0m22:08:55.043076 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_orders)
[0m22:08:55.044323 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_orders
[0m22:08:55.049056 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_orders"
[0m22:08:55.051060 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (compile): 22:08:55.044323 => 22:08:55.051060
[0m22:08:55.052068 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_orders
[0m22:08:55.057065 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_orders"
[0m22:08:55.059994 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_orders"
[0m22:08:55.060113 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_orders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_orders
  
   as (
    SELECT 
id As order_id,
customer As customer_id,
store_id,
subtotal,
tax_paid,
order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders
  );
[0m22:08:55.063116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:08:56.556270 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:08:56.560267 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_items (execute): 22:08:54.729197 => 22:08:56.560267
[0m22:08:56.560267 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_items: Close
[0m22:08:56.856388 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:08:56.859080 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_orders (execute): 22:08:55.053069 => 22:08:56.859080
[0m22:08:56.860096 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_orders: Close
[0m22:08:57.119020 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D262A640>]}
[0m22:08:57.120201 [info ] [Thread-2  ]: 3 of 12 OK created sql view model INTERMEDIATE.stg_items ....................... [[32mSUCCESS 1[0m in 2.40s]
[0m22:08:57.121016 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_items
[0m22:08:57.122540 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m22:08:57.123338 [info ] [Thread-2  ]: 5 of 12 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m22:08:57.126328 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_items, now model.dbt_jaffle_shop.stg_products)
[0m22:08:57.126605 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m22:08:57.131616 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m22:08:57.132616 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 22:08:57.127615 => 22:08:57.132616
[0m22:08:57.134078 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m22:08:57.139634 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m22:08:57.143629 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m22:08:57.145650 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m22:08:57.146630 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:08:57.491422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D27E7D90>]}
[0m22:08:57.492566 [info ] [Thread-1  ]: 4 of 12 OK created sql view model INTERMEDIATE.stg_orders ...................... [[32mSUCCESS 1[0m in 2.45s]
[0m22:08:57.494303 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_orders
[0m22:08:57.495402 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m22:08:57.496959 [info ] [Thread-1  ]: 6 of 12 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m22:08:57.499130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_orders, now model.dbt_jaffle_shop.stg_stores)
[0m22:08:57.500297 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m22:08:57.506844 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m22:08:57.508647 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 22:08:57.501365 => 22:08:57.507709
[0m22:08:57.509648 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m22:08:57.626607 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m22:08:57.628608 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m22:08:57.629606 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m22:08:57.630607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:08:58.999108 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:08:59.002834 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 22:08:57.134617 => 22:08:59.002834
[0m22:08:59.003767 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m22:08:59.413869 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:08:59.417878 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 22:08:57.510648 => 22:08:59.416877
[0m22:08:59.417997 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m22:08:59.572178 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D280ABB0>]}
[0m22:08:59.573179 [info ] [Thread-2  ]: 5 of 12 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.45s]
[0m22:08:59.575182 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m22:08:59.576275 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m22:08:59.577809 [info ] [Thread-2  ]: 7 of 12 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m22:08:59.580316 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_supplies)
[0m22:08:59.582423 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m22:08:59.587313 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:08:59.588315 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 22:08:59.583317 => 22:08:59.588315
[0m22:08:59.589328 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m22:08:59.594328 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m22:08:59.596316 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m22:08:59.597516 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m22:08:59.598468 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:09:00.767565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D24CA070>]}
[0m22:09:00.768629 [info ] [Thread-1  ]: 6 of 12 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 3.27s]
[0m22:09:00.770572 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m22:09:00.771533 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m22:09:00.772576 [info ] [Thread-1  ]: 8 of 12 START sql table model CORE.dim_customers ............................... [RUN]
[0m22:09:00.775131 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m22:09:00.775131 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m22:09:00.781135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m22:09:00.783132 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 22:09:00.776759 => 22:09:00.782265
[0m22:09:00.784126 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m22:09:00.807092 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m22:09:00.809096 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m22:09:00.810098 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m22:09:00.811101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:01.431539 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:09:01.434530 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 22:08:59.589328 => 22:09:01.433537
[0m22:09:01.435392 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m22:09:01.979897 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D26233D0>]}
[0m22:09:01.980423 [info ] [Thread-2  ]: 7 of 12 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 2.40s]
[0m22:09:01.982419 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m22:09:01.983427 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m22:09:01.984413 [info ] [Thread-2  ]: 9 of 12 START sql table model CORE.dim_date .................................... [RUN]
[0m22:09:01.986429 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m22:09:01.986429 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m22:09:01.990534 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m22:09:01.992547 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 22:09:01.987414 => 22:09:01.991565
[0m22:09:01.992547 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m22:09:01.997570 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m22:09:01.999564 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m22:09:02.000446 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m22:09:02.000446 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:09:03.929795 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:09:03.933788 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 22:09:00.784126 => 22:09:03.933788
[0m22:09:03.934771 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m22:09:04.503998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D2619580>]}
[0m22:09:04.504997 [info ] [Thread-1  ]: 8 of 12 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 3.73s]
[0m22:09:04.506005 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m22:09:04.507490 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m22:09:04.508514 [info ] [Thread-1  ]: 10 of 12 START sql table model CORE.fact_orders ................................ [RUN]
[0m22:09:04.510508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.fact_orders)
[0m22:09:04.511514 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m22:09:04.520496 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m22:09:04.521196 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 22:09:04.512515 => 22:09:04.521196
[0m22:09:04.522190 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m22:09:04.526425 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m22:09:04.529252 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m22:09:04.530286 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (SELECT
    md5(cast(coalesce(cast(orders.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(items.item_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    TRY_CAST(CONCAT(LEFT(ordered_date, 4), SUBSTR(ordered_date, 6, 2), SUBSTR(ordered_date, 9, 2)) As INTEGER) As date_key,
    orders.order_id as salesorderid,
    item_id as salesitemid,
    subtotal,
    tax_paid as tax,
    order_total,
    ordered_date
from JAFFLE_SHOP.INTERMEDIATE.stg_orders as orders
inner join JAFFLE_SHOP.INTERMEDIATE.stg_items as items 
on orders.order_id = items.order_id
        );
[0m22:09:04.531286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:09:05.384873 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:09:05.388399 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 22:09:01.993554 => 22:09:05.387835
[0m22:09:05.388954 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m22:09:05.946532 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D26BAA60>]}
[0m22:09:05.947606 [info ] [Thread-2  ]: 9 of 12 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 3.96s]
[0m22:09:05.948620 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m22:09:05.950192 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m22:09:05.950624 [info ] [Thread-2  ]: 11 of 12 START sql table model CORE.dim_products ............................... [RUN]
[0m22:09:05.952624 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_products)
[0m22:09:05.953626 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m22:09:05.958331 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m22:09:05.960580 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 22:09:05.953626 => 22:09:05.959302
[0m22:09:05.961299 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m22:09:05.966295 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m22:09:05.968302 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m22:09:05.969295 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m22:09:05.970305 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:09:09.128456 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:09:09.132456 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 22:09:05.961299 => 22:09:09.132456
[0m22:09:09.133445 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m22:09:09.727401 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D27DC7C0>]}
[0m22:09:09.728574 [info ] [Thread-2  ]: 11 of 12 OK created sql table model CORE.dim_products .......................... [[32mSUCCESS 1[0m in 3.77s]
[0m22:09:09.730787 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m22:09:09.731448 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m22:09:09.732615 [info ] [Thread-2  ]: 12 of 12 START sql table model CORE.dim_stores ................................. [RUN]
[0m22:09:09.734243 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_products, now model.dbt_jaffle_shop.dim_stores)
[0m22:09:09.734849 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m22:09:09.740705 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m22:09:09.742921 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 22:09:09.735439 => 22:09:09.741707
[0m22:09:09.743710 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m22:09:09.748813 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m22:09:09.750712 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m22:09:09.751709 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m22:09:09.752707 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:09:12.608134 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:09:12.614369 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 22:09:09.744710 => 22:09:12.614369
[0m22:09:12.615477 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m22:09:13.176909 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D26BCA30>]}
[0m22:09:13.177925 [info ] [Thread-2  ]: 12 of 12 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.44s]
[0m22:09:13.179667 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m22:09:15.438067 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 11.0 seconds
[0m22:09:15.442039 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 22:09:04.523191 => 22:09:15.441047
[0m22:09:15.443049 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m22:09:16.116649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '726edb23-26e3-4b02-883e-1c9612a3fbd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D275DBE0>]}
[0m22:09:16.117648 [info ] [Thread-1  ]: 10 of 12 OK created sql table model CORE.fact_orders ........................... [[32mSUCCESS 1[0m in 11.61s]
[0m22:09:16.119631 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m22:09:16.122630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:09:16.123630 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:09:16.124468 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m22:09:16.125941 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:09:16.126560 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m22:09:16.127148 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m22:09:16.127715 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m22:09:16.128408 [info ] [MainThread]: 
[0m22:09:16.130331 [info ] [MainThread]: Finished running 7 view models, 5 table models in 0 hours 0 minutes and 35.63 seconds (35.63s).
[0m22:09:16.133354 [debug] [MainThread]: Command end result
[0m22:09:16.155242 [info ] [MainThread]: 
[0m22:09:16.156841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:09:16.158480 [info ] [MainThread]: 
[0m22:09:16.159554 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m22:09:16.161774 [debug] [MainThread]: Command `dbt run` succeeded at 22:09:16.161774 after 37.71 seconds
[0m22:09:16.163821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207AE8A08E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D1080430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207D0F86100>]}
[0m22:09:16.164517 [debug] [MainThread]: Flushing usage events
[0m22:18:27.617435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791C0F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790ADDEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024790ADD5B0>]}


============================== 22:18:27.623434 | 2b5880f1-a22f-4f63-837e-004301d3d790 ==============================
[0m22:18:27.623434 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:18:27.625438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:18:29.035150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b5880f1-a22f-4f63-837e-004301d3d790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B5239730>]}
[0m22:18:29.117583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b5880f1-a22f-4f63-837e-004301d3d790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B52B47C0>]}
[0m22:18:29.120422 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:18:29.139416 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:18:29.317130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:29.317736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:29.324656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b5880f1-a22f-4f63-837e-004301d3d790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B56C50D0>]}
[0m22:18:29.340692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b5880f1-a22f-4f63-837e-004301d3d790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B55E25B0>]}
[0m22:18:29.341597 [info ] [MainThread]: Found 12 models, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:18:29.342599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b5880f1-a22f-4f63-837e-004301d3d790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B55E2340>]}
[0m22:18:29.344595 [info ] [MainThread]: 
[0m22:18:29.346606 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m22:18:29.347597 [debug] [MainThread]: Command end result
[0m22:18:29.362557 [debug] [MainThread]: Command `dbt test` succeeded at 22:18:29.362557 after 1.83 seconds
[0m22:18:29.363658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791C0F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B523C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247B53C0A00>]}
[0m22:18:29.364194 [debug] [MainThread]: Flushing usage events
[0m22:20:07.718176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5FD1FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5EBED5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5EBED880>]}


============================== 22:20:07.722334 | 9f745120-5f29-4015-b4ec-c3d476071a49 ==============================
[0m22:20:07.722334 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:20:07.724335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:20:08.984497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f745120-5f29-4015-b4ec-c3d476071a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5EBED730>]}
[0m22:20:09.088837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f745120-5f29-4015-b4ec-c3d476071a49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F603565B0>]}
[0m22:20:09.091846 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:20:09.115245 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:20:09.262901 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_jaffle_shop: CORE\_jaffle_shop_tests.yml - Runtime Error
    Syntax error near line 9
    ------------------------------
    6  |           tests:
    7  |             - unique
    8  |             - not_null
    9  |     - name: dim_products:
    10 |       columns:
    11 |         - name: product_key
    12 |           tests:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 9, column 25
[0m22:20:09.268756 [debug] [MainThread]: Command `dbt test` failed at 22:20:09.268756 after 1.62 seconds
[0m22:20:09.270429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F5FD1FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F034EDF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018F03643100>]}
[0m22:20:09.271466 [debug] [MainThread]: Flushing usage events
[0m22:20:43.370091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F960850F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95F6FCA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95F6FC6A0>]}


============================== 22:20:43.375491 | 5c9e9c85-b2f6-4072-920f-4e1ab77e5e9f ==============================
[0m22:20:43.375491 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:20:43.377649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:20:44.723547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c9e9c85-b2f6-4072-920f-4e1ab77e5e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95F71D640>]}
[0m22:20:44.827981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c9e9c85-b2f6-4072-920f-4e1ab77e5e9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9040575B0>]}
[0m22:20:44.829583 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:20:44.852374 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:20:44.951325 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models\CORE\_jaffle_shop_tests.yml is invalid because the value of 'models' is not a list
[0m22:20:44.954840 [debug] [MainThread]: Command `dbt test` failed at 22:20:44.953903 after 1.65 seconds
[0m22:20:44.955832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F960850F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9042D7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F904162070>]}
[0m22:20:44.956829 [debug] [MainThread]: Flushing usage events
[0m22:21:21.918297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BD6C908E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BD5B5D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BD5B5D1F0>]}


============================== 22:21:21.927373 | b7ee632f-6a6c-479d-a981-2eebc37251b7 ==============================
[0m22:21:21.927373 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:21:21.929389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:21:23.452887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7ee632f-6a6c-479d-a981-2eebc37251b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BD9541BB0>]}
[0m22:21:23.560702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7ee632f-6a6c-479d-a981-2eebc37251b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFA3CABB0>]}
[0m22:21:23.562703 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:21:23.585500 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:21:23.795707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:21:23.796315 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\CORE\_jaffle_shop_tests.yml
[0m22:21:24.032935 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models\CORE\_jaffle_shop_tests.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_customers')"), ('field', 'customer_key')] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m22:21:24.036104 [debug] [MainThread]: Command `dbt test` failed at 22:21:24.036104 after 2.23 seconds
[0m22:21:24.037183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BD6C908E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFA788DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFA8B2D90>]}
[0m22:21:24.038118 [debug] [MainThread]: Flushing usage events
[0m22:24:04.717477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B959CFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9489D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9489D880>]}


============================== 22:24:04.723471 | 71987a16-a500-44b1-af05-101d0b3a96fc ==============================
[0m22:24:04.723471 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:24:04.724470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:24:06.221233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71987a16-a500-44b1-af05-101d0b3a96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B9489D730>]}
[0m22:24:06.339515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71987a16-a500-44b1-af05-101d0b3a96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B960065B0>]}
[0m22:24:06.341006 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:24:06.365897 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:24:06.586649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:24:06.588458 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\CORE\_jaffle_shop_tests.yml
[0m22:24:06.903015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71987a16-a500-44b1-af05-101d0b3a96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB96570D0>]}
[0m22:24:06.928441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71987a16-a500-44b1-af05-101d0b3a96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB93A2820>]}
[0m22:24:06.929533 [info ] [MainThread]: Found 12 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:24:06.930445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71987a16-a500-44b1-af05-101d0b3a96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB93A25E0>]}
[0m22:24:06.934373 [info ] [MainThread]: 
[0m22:24:06.936683 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:24:06.939684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:24:06.942756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m22:24:06.964298 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:24:06.969157 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:24:06.970291 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:24:06.971787 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:24:06.972590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:06.973415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:24:10.009272 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.0 seconds
[0m22:24:10.012263 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:24:10.038904 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.0 seconds
[0m22:24:10.040904 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:24:10.602295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m22:24:10.609344 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:24:10.610348 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:24:10.611349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:24:12.406660 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m22:24:12.409649 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:24:13.147951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71987a16-a500-44b1-af05-101d0b3a96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB93A24C0>]}
[0m22:24:13.149584 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:24:13.151781 [info ] [MainThread]: 
[0m22:24:13.156332 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:24:13.157569 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:24:13.158960 [info ] [Thread-1  ]: 1 of 11 START test not_null_dim_customers_customer_key ......................... [RUN]
[0m22:24:13.161989 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411'
[0m22:24:13.159978 [info ] [Thread-2  ]: 2 of 11 START test not_null_dim_products_product_key ........................... [RUN]
[0m22:24:13.162988 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:24:13.164478 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a'
[0m22:24:13.178975 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m22:24:13.179487 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:24:13.188007 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m22:24:13.188997 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (compile): 22:24:13.165613 => 22:24:13.188997
[0m22:24:13.190176 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:24:13.214146 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m22:24:13.216152 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (compile): 22:24:13.181275 => 22:24:13.215159
[0m22:24:13.217165 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:24:13.221694 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m22:24:13.223706 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m22:24:13.224850 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from JAFFLE_SHOP.CORE.dim_customers
where customer_key is null



      
    ) dbt_internal_test
[0m22:24:13.225705 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:24:13.227709 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m22:24:13.231712 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from JAFFLE_SHOP.CORE.dim_products
where product_key is null



      
    ) dbt_internal_test
[0m22:24:13.233707 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:24:16.246216 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:16.247225 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:16.255222 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (execute): 22:24:13.190690 => 22:24:16.255222
[0m22:24:16.259246 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (execute): 22:24:13.217680 => 22:24:16.258599
[0m22:24:16.260311 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411: Close
[0m22:24:16.261238 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a: Close
[0m22:24:17.958962 [info ] [Thread-1  ]: 1 of 11 PASS not_null_dim_customers_customer_key ............................... [[32mPASS[0m in 4.80s]
[0m22:24:17.960960 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:24:17.961961 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:24:17.962956 [info ] [Thread-1  ]: 3 of 11 START test not_null_dim_stores_store_key ............................... [RUN]
[0m22:24:17.964959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e)
[0m22:24:17.965956 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:24:17.971958 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m22:24:17.973959 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (compile): 22:24:17.965956 => 22:24:17.972957
[0m22:24:17.974961 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:24:17.979965 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m22:24:17.981958 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m22:24:17.982956 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from JAFFLE_SHOP.CORE.dim_stores
where store_key is null



      
    ) dbt_internal_test
[0m22:24:17.983941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:17.990687 [info ] [Thread-2  ]: 2 of 11 PASS not_null_dim_products_product_key ................................. [[32mPASS[0m in 4.83s]
[0m22:24:17.992527 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:24:17.993589 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4
[0m22:24:17.995587 [info ] [Thread-2  ]: 4 of 11 START test not_null_fact_orders_order_key .............................. [RUN]
[0m22:24:17.998614 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a, now test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4)
[0m22:24:17.999608 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4
[0m22:24:18.005428 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4"
[0m22:24:18.006444 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4 (compile): 22:24:18.000607 => 22:24:18.006444
[0m22:24:18.007442 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4
[0m22:24:18.013438 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4"
[0m22:24:18.015440 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4"
[0m22:24:18.016530 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_key
from JAFFLE_SHOP.CORE.fact_orders
where order_key is null



      
    ) dbt_internal_test
[0m22:24:18.017603 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:24:21.627864 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b481a4-0205-2c5b-0006-1c67000115e2
[0m22:24:21.628875 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'ORDER_KEY'
[0m22:24:21.629876 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4 (execute): 22:24:18.008445 => 22:24:21.629876
[0m22:24:21.630861 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4: Close
[0m22:24:21.884853 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m22:24:21.887089 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (execute): 22:24:17.974961 => 22:24:21.887089
[0m22:24:21.887855 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e: Close
[0m22:24:22.436768 [debug] [Thread-2  ]: Database Error in test not_null_fact_orders_order_key (models\CORE\_jaffle_shop_tests.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'ORDER_KEY'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\_jaffle_shop_tests.yml\not_null_fact_orders_order_key.sql
[0m22:24:22.437760 [error] [Thread-2  ]: 4 of 11 ERROR not_null_fact_orders_order_key ................................... [[31mERROR[0m in 4.44s]
[0m22:24:22.439760 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4
[0m22:24:22.440749 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:24:22.442738 [info ] [Thread-2  ]: 5 of 11 START test relationships_fact_orders_customer_key__customer_key__ref_dim_customers_  [RUN]
[0m22:24:22.444751 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_fact_orders_order_key.e893eb60e4, now test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94)
[0m22:24:22.444751 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:24:22.451763 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m22:24:22.453266 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (compile): 22:24:22.445765 => 22:24:22.452926
[0m22:24:22.453794 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:24:22.457829 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m22:24:22.459935 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m22:24:22.460926 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from JAFFLE_SHOP.CORE.fact_orders
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from JAFFLE_SHOP.CORE.dim_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:24:22.461816 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:24:22.517229 [info ] [Thread-1  ]: 3 of 11 PASS not_null_dim_stores_store_key ..................................... [[32mPASS[0m in 4.55s]
[0m22:24:22.518232 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:24:22.519231 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:24:22.520431 [info ] [Thread-1  ]: 6 of 11 START test relationships_fact_orders_product_key__product_key__ref_dim_products_  [RUN]
[0m22:24:22.521214 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e, now test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36)
[0m22:24:22.522218 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:24:22.529373 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m22:24:22.531384 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (compile): 22:24:22.523231 => 22:24:22.530743
[0m22:24:22.531384 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:24:22.536382 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m22:24:22.538382 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m22:24:22.539371 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from JAFFLE_SHOP.CORE.fact_orders
    where product_key is not null
),

parent as (
    select product_key as to_field
    from JAFFLE_SHOP.CORE.dim_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:24:22.540382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:25.401181 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:25.403016 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (execute): 22:24:22.532373 => 22:24:25.403016
[0m22:24:25.404595 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36: Close
[0m22:24:25.528339 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:25.531272 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (execute): 22:24:22.453794 => 22:24:25.531272
[0m22:24:25.532273 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94: Close
[0m22:24:25.968423 [info ] [Thread-1  ]: 6 of 11 PASS relationships_fact_orders_product_key__product_key__ref_dim_products_  [[32mPASS[0m in 3.45s]
[0m22:24:25.969392 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:24:25.970495 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:24:25.971394 [info ] [Thread-1  ]: 7 of 11 START test relationships_fact_orders_store_key__store_key__ref_dim_stores_  [RUN]
[0m22:24:25.973404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36, now test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5)
[0m22:24:25.974412 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:24:25.980750 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m22:24:25.982446 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (compile): 22:24:25.975475 => 22:24:25.982446
[0m22:24:25.983390 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:24:25.987407 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m22:24:25.990392 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m22:24:25.990392 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from JAFFLE_SHOP.CORE.fact_orders
    where store_key is not null
),

parent as (
    select store_key as to_field
    from JAFFLE_SHOP.CORE.dim_stores
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:24:25.991396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:26.091094 [info ] [Thread-2  ]: 5 of 11 PASS relationships_fact_orders_customer_key__customer_key__ref_dim_customers_  [[32mPASS[0m in 3.65s]
[0m22:24:26.093298 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:24:26.094304 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:24:26.095306 [info ] [Thread-2  ]: 8 of 11 START test unique_dim_customers_customer_key ........................... [RUN]
[0m22:24:26.097309 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94, now test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e)
[0m22:24:26.098319 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:24:26.107325 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m22:24:26.109307 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (compile): 22:24:26.098319 => 22:24:26.108807
[0m22:24:26.110311 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:24:26.221284 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m22:24:26.223572 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m22:24:26.224756 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.dim_customers
where customer_key is not null
group by customer_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:24:26.225992 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:24:28.143535 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:24:28.146544 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (execute): 22:24:25.984394 => 22:24:28.145535
[0m22:24:28.147538 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5: Close
[0m22:24:28.192440 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:24:28.195613 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (execute): 22:24:26.110311 => 22:24:28.195613
[0m22:24:28.196453 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e: Close
[0m22:24:28.714223 [info ] [Thread-1  ]: 7 of 11 PASS relationships_fact_orders_store_key__store_key__ref_dim_stores_ ... [[32mPASS[0m in 2.74s]
[0m22:24:28.715634 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:24:28.716658 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:24:28.717672 [info ] [Thread-1  ]: 9 of 11 START test unique_dim_products_product_key ............................. [RUN]
[0m22:24:28.719680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5, now test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652)
[0m22:24:28.720668 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:24:28.727669 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m22:24:28.729660 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (compile): 22:24:28.721088 => 22:24:28.729660
[0m22:24:28.730744 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:24:28.734654 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m22:24:28.736674 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m22:24:28.737665 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.dim_products
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:24:28.738657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:24:28.791865 [info ] [Thread-2  ]: 8 of 11 PASS unique_dim_customers_customer_key ................................. [[32mPASS[0m in 2.70s]
[0m22:24:28.793878 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:24:28.794873 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:24:28.795951 [info ] [Thread-2  ]: 10 of 11 START test unique_dim_stores_store_key ................................ [RUN]
[0m22:24:28.797866 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e, now test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53)
[0m22:24:28.797866 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:24:28.803871 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m22:24:28.805865 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (compile): 22:24:28.798871 => 22:24:28.805561
[0m22:24:28.805865 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:24:28.811354 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m22:24:28.813379 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m22:24:28.814377 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.dim_stores
where store_key is not null
group by store_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:24:28.815381 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:24:31.218965 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:24:31.221961 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (execute): 22:24:28.806873 => 22:24:31.221961
[0m22:24:31.222831 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53: Close
[0m22:24:31.386399 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:24:31.389399 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (execute): 22:24:28.731662 => 22:24:31.388402
[0m22:24:31.390386 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652: Close
[0m22:24:31.825555 [info ] [Thread-2  ]: 10 of 11 PASS unique_dim_stores_store_key ...................................... [[32mPASS[0m in 3.03s]
[0m22:24:31.828082 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:24:31.829086 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5
[0m22:24:31.830083 [info ] [Thread-2  ]: 11 of 11 START test unique_fact_orders_order_key ............................... [RUN]
[0m22:24:31.832138 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53, now test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5)
[0m22:24:31.833136 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5
[0m22:24:31.839601 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5"
[0m22:24:31.842105 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5 (compile): 22:24:31.834137 => 22:24:31.841429
[0m22:24:31.842818 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5
[0m22:24:31.848436 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5"
[0m22:24:31.851791 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5"
[0m22:24:31.852394 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.fact_orders
where order_key is not null
group by order_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:24:31.853491 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:24:31.980816 [info ] [Thread-1  ]: 9 of 11 PASS unique_dim_products_product_key ................................... [[32mPASS[0m in 3.26s]
[0m22:24:31.983026 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:24:33.572528 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b481a4-0205-2c52-0006-1c6700014686
[0m22:24:33.573526 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'ORDER_KEY'
[0m22:24:33.574526 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5 (execute): 22:24:31.843891 => 22:24:33.573526
[0m22:24:33.575524 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5: Close
[0m22:24:34.145962 [debug] [Thread-2  ]: Database Error in test unique_fact_orders_order_key (models\CORE\_jaffle_shop_tests.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'ORDER_KEY'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\_jaffle_shop_tests.yml\unique_fact_orders_order_key.sql
[0m22:24:34.146548 [error] [Thread-2  ]: 11 of 11 ERROR unique_fact_orders_order_key .................................... [[31mERROR[0m in 2.32s]
[0m22:24:34.148953 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5
[0m22:24:34.151412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:24:34.152070 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m22:24:34.152598 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:24:34.153779 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652' was properly closed.
[0m22:24:34.153779 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.unique_fact_orders_order_key.1d8f1532d5' was properly closed.
[0m22:24:34.154742 [info ] [MainThread]: 
[0m22:24:34.155882 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 27.22 seconds (27.22s).
[0m22:24:34.158897 [debug] [MainThread]: Command end result
[0m22:24:34.183735 [info ] [MainThread]: 
[0m22:24:34.187258 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:24:34.189551 [info ] [MainThread]: 
[0m22:24:34.191467 [error] [MainThread]:   Database Error in test not_null_fact_orders_order_key (models\CORE\_jaffle_shop_tests.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'ORDER_KEY'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\_jaffle_shop_tests.yml\not_null_fact_orders_order_key.sql
[0m22:24:34.193824 [info ] [MainThread]: 
[0m22:24:34.196165 [error] [MainThread]:   Database Error in test unique_fact_orders_order_key (models\CORE\_jaffle_shop_tests.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'ORDER_KEY'
  compiled Code at target\run\dbt_jaffle_shop\models\CORE\_jaffle_shop_tests.yml\unique_fact_orders_order_key.sql
[0m22:24:34.197826 [info ] [MainThread]: 
[0m22:24:34.200376 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
[0m22:24:34.203372 [debug] [MainThread]: Command `dbt test` failed at 22:24:34.203372 after 29.56 seconds
[0m22:24:34.204464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B959CFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB9099730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BB973A910>]}
[0m22:24:34.205586 [debug] [MainThread]: Flushing usage events
[0m22:25:59.839810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDDEC50F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDDDAFCA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDDDAFC6A0>]}


============================== 22:25:59.846507 | 648c3e92-0f6a-4b19-bdbd-83e41929f61c ==============================
[0m22:25:59.846507 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:25:59.848788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:26:01.056351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '648c3e92-0f6a-4b19-bdbd-83e41929f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDDDB1D640>]}
[0m22:26:01.147824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '648c3e92-0f6a-4b19-bdbd-83e41929f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD824675B0>]}
[0m22:26:01.149630 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:26:01.171412 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:26:01.378441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:01.379644 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\_jaffle_shop_tests.yml
[0m22:26:01.698608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '648c3e92-0f6a-4b19-bdbd-83e41929f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD829D1610>]}
[0m22:26:01.719605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '648c3e92-0f6a-4b19-bdbd-83e41929f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD82632790>]}
[0m22:26:01.721269 [info ] [MainThread]: Found 12 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:26:01.722811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '648c3e92-0f6a-4b19-bdbd-83e41929f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD82632550>]}
[0m22:26:01.725805 [info ] [MainThread]: 
[0m22:26:01.727814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:26:01.730804 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m22:26:01.732802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m22:26:01.750805 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m22:26:01.754803 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m22:26:01.755804 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m22:26:01.756809 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m22:26:01.757810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:01.759114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:04.984351 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.0 seconds
[0m22:26:04.987183 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m22:26:05.007709 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m22:26:05.009724 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m22:26:05.524111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m22:26:05.531243 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m22:26:05.531822 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m22:26:05.532821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:07.354056 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m22:26:07.356207 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m22:26:08.783393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '648c3e92-0f6a-4b19-bdbd-83e41929f61c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD82448610>]}
[0m22:26:08.785392 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:26:08.786401 [info ] [MainThread]: 
[0m22:26:08.792402 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:26:08.793396 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:26:08.795404 [info ] [Thread-1  ]: 1 of 11 START test not_null_dim_customers_customer_key ......................... [RUN]
[0m22:26:08.798391 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411'
[0m22:26:08.796410 [info ] [Thread-2  ]: 2 of 11 START test not_null_dim_products_product_key ........................... [RUN]
[0m22:26:08.799527 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:26:08.800705 [debug] [Thread-2  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a'
[0m22:26:08.812627 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m22:26:08.813401 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:26:08.819143 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m22:26:08.821122 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (compile): 22:26:08.801392 => 22:26:08.820119
[0m22:26:08.822101 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:26:08.840159 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (compile): 22:26:08.814552 => 22:26:08.840159
[0m22:26:08.847027 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m22:26:08.848997 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:26:08.853985 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m22:26:08.855987 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m22:26:08.857984 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m22:26:08.859985 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_key
from JAFFLE_SHOP.CORE.dim_customers
where customer_key is null



      
    ) dbt_internal_test
[0m22:26:08.860985 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_key
from JAFFLE_SHOP.CORE.dim_products
where product_key is null



      
    ) dbt_internal_test
[0m22:26:08.861986 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:26:08.862985 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m22:26:10.765185 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:10.771812 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (execute): 22:26:08.823104 => 22:26:10.771812
[0m22:26:10.772871 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411: Close
[0m22:26:10.788825 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:10.791681 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (execute): 22:26:08.850414 => 22:26:10.790659
[0m22:26:10.792324 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a: Close
[0m22:26:11.358662 [info ] [Thread-1  ]: 1 of 11 PASS not_null_dim_customers_customer_key ............................... [[32mPASS[0m in 2.56s]
[0m22:26:11.361677 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m22:26:11.364661 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:26:11.363668 [info ] [Thread-2  ]: 2 of 11 PASS not_null_dim_products_product_key ................................. [[32mPASS[0m in 2.56s]
[0m22:26:11.366658 [info ] [Thread-1  ]: 3 of 11 START test not_null_dim_stores_store_key ............................... [RUN]
[0m22:26:11.368663 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m22:26:11.369667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e)
[0m22:26:11.371838 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m22:26:11.373649 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:26:11.375803 [info ] [Thread-2  ]: 4 of 11 START test not_null_fact_orders_orders_key ............................. [RUN]
[0m22:26:11.384896 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m22:26:11.386433 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a, now test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259)
[0m22:26:11.389554 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m22:26:11.391432 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (compile): 22:26:11.378094 => 22:26:11.390428
[0m22:26:11.398430 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259"
[0m22:26:11.400427 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:26:11.405427 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m22:26:11.407439 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259 (compile): 22:26:11.391432 => 22:26:11.406431
[0m22:26:11.409432 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m22:26:11.414432 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259"
[0m22:26:11.415430 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m22:26:11.416653 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select store_key
from JAFFLE_SHOP.CORE.dim_stores
where store_key is null



      
    ) dbt_internal_test
[0m22:26:11.418699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:26:11.419689 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259"
[0m22:26:11.423686 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select orders_key
from JAFFLE_SHOP.CORE.fact_orders
where orders_key is null



      
    ) dbt_internal_test
[0m22:26:11.424692 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:26:13.531562 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:13.533618 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (execute): 22:26:11.401433 => 22:26:13.533618
[0m22:26:13.534595 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e: Close
[0m22:26:13.771479 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:13.775979 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259 (execute): 22:26:11.409432 => 22:26:13.775022
[0m22:26:13.775979 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259: Close
[0m22:26:14.267409 [info ] [Thread-1  ]: 3 of 11 PASS not_null_dim_stores_store_key ..................................... [[32mPASS[0m in 2.90s]
[0m22:26:14.270515 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m22:26:14.272942 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:26:14.273954 [info ] [Thread-1  ]: 5 of 11 START test relationships_fact_orders_customer_key__customer_key__ref_dim_customers_  [RUN]
[0m22:26:14.276293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e, now test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94)
[0m22:26:14.278103 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:26:14.404362 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m22:26:14.406403 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (compile): 22:26:14.279004 => 22:26:14.405553
[0m22:26:14.407386 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:26:14.412385 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m22:26:14.414385 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m22:26:14.415385 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_key as from_field
    from JAFFLE_SHOP.CORE.fact_orders
    where customer_key is not null
),

parent as (
    select customer_key as to_field
    from JAFFLE_SHOP.CORE.dim_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:26:14.416385 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:26:14.468571 [info ] [Thread-2  ]: 4 of 11 PASS not_null_fact_orders_orders_key ................................... [[32mPASS[0m in 3.08s]
[0m22:26:14.470560 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m22:26:14.471703 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:26:14.472570 [info ] [Thread-2  ]: 6 of 11 START test relationships_fact_orders_product_key__product_key__ref_dim_products_  [RUN]
[0m22:26:14.474556 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259, now test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36)
[0m22:26:14.475782 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:26:14.483554 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m22:26:14.485125 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (compile): 22:26:14.475782 => 22:26:14.485125
[0m22:26:14.486143 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:26:14.491922 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m22:26:14.493719 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m22:26:14.494718 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_key as from_field
    from JAFFLE_SHOP.CORE.fact_orders
    where product_key is not null
),

parent as (
    select product_key as to_field
    from JAFFLE_SHOP.CORE.dim_products
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:26:14.495725 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:26:16.669831 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:16.670826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:16.674965 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (execute): 22:26:14.487143 => 22:26:16.673824
[0m22:26:16.678680 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (execute): 22:26:14.407386 => 22:26:16.678165
[0m22:26:16.679824 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36: Close
[0m22:26:16.681536 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94: Close
[0m22:26:17.303076 [info ] [Thread-2  ]: 6 of 11 PASS relationships_fact_orders_product_key__product_key__ref_dim_products_  [[32mPASS[0m in 2.83s]
[0m22:26:17.304858 [info ] [Thread-1  ]: 5 of 11 PASS relationships_fact_orders_customer_key__customer_key__ref_dim_customers_  [[32mPASS[0m in 3.03s]
[0m22:26:17.307601 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m22:26:17.309389 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m22:26:17.311201 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:26:17.312773 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:26:17.313773 [info ] [Thread-2  ]: 7 of 11 START test relationships_fact_orders_store_key__store_key__ref_dim_stores_  [RUN]
[0m22:26:17.315840 [info ] [Thread-1  ]: 8 of 11 START test unique_dim_customers_customer_key ........................... [RUN]
[0m22:26:17.318383 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36, now test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5)
[0m22:26:17.319376 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94, now test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e)
[0m22:26:17.321065 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:26:17.322774 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:26:17.336502 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m22:26:17.350410 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m22:26:17.353293 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (compile): 22:26:17.323419 => 22:26:17.352715
[0m22:26:17.355151 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:26:17.356175 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (compile): 22:26:17.338505 => 22:26:17.355338
[0m22:26:17.362767 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m22:26:17.364896 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:26:17.371716 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m22:26:17.374717 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m22:26:17.375715 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select store_key as from_field
    from JAFFLE_SHOP.CORE.fact_orders
    where store_key is not null
),

parent as (
    select store_key as to_field
    from JAFFLE_SHOP.CORE.dim_stores
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:26:17.377868 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:26:17.380447 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m22:26:17.386969 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.dim_customers
where customer_key is not null
group by customer_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:26:17.388968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:26:19.285484 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:19.288083 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (execute): 22:26:17.366775 => 22:26:19.288083
[0m22:26:19.289811 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e: Close
[0m22:26:19.327313 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:26:19.331339 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (execute): 22:26:17.357175 => 22:26:19.330335
[0m22:26:19.332731 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5: Close
[0m22:26:19.859853 [info ] [Thread-1  ]: 8 of 11 PASS unique_dim_customers_customer_key ................................. [[32mPASS[0m in 2.54s]
[0m22:26:19.862842 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m22:26:19.862842 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:26:19.864280 [info ] [Thread-1  ]: 9 of 11 START test unique_dim_products_product_key ............................. [RUN]
[0m22:26:19.866841 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e, now test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652)
[0m22:26:19.867833 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:26:19.873840 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m22:26:19.875831 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (compile): 22:26:19.867833 => 22:26:19.875831
[0m22:26:19.876838 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:26:19.881833 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m22:26:19.884285 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m22:26:19.885407 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.dim_products
where product_key is not null
group by product_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:26:19.886428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:26:19.896585 [info ] [Thread-2  ]: 7 of 11 PASS relationships_fact_orders_store_key__store_key__ref_dim_stores_ ... [[32mPASS[0m in 2.58s]
[0m22:26:19.899729 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m22:26:19.900657 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:26:19.901671 [info ] [Thread-2  ]: 10 of 11 START test unique_dim_stores_store_key ................................ [RUN]
[0m22:26:19.904098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5, now test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53)
[0m22:26:19.906076 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:26:19.914582 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m22:26:19.917793 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (compile): 22:26:19.906076 => 22:26:19.916591
[0m22:26:19.918591 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:26:19.924568 [debug] [Thread-2  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m22:26:19.926607 [debug] [Thread-2  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m22:26:19.927596 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    store_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.dim_stores
where store_key is not null
group by store_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:26:19.929609 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m22:26:22.912322 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:26:22.915311 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (execute): 22:26:19.877833 => 22:26:22.914309
[0m22:26:22.916321 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652: Close
[0m22:26:23.184128 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:26:23.187126 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (execute): 22:26:19.919574 => 22:26:23.186230
[0m22:26:23.188128 [debug] [Thread-2  ]: On test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53: Close
[0m22:26:23.543297 [info ] [Thread-1  ]: 9 of 11 PASS unique_dim_products_product_key ................................... [[32mPASS[0m in 3.68s]
[0m22:26:23.544838 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m22:26:23.545837 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m22:26:23.546862 [info ] [Thread-1  ]: 11 of 11 START test unique_fact_orders_orders_key .............................. [RUN]
[0m22:26:23.548848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652, now test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b)
[0m22:26:23.549844 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m22:26:23.554856 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b"
[0m22:26:23.556976 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b (compile): 22:26:23.550848 => 22:26:23.555856
[0m22:26:23.557772 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m22:26:23.561784 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b"
[0m22:26:23.563043 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b"
[0m22:26:23.563777 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    orders_key as unique_field,
    count(*) as n_records

from JAFFLE_SHOP.CORE.fact_orders
where orders_key is not null
group by orders_key
having count(*) > 1



      
    ) dbt_internal_test
[0m22:26:23.564784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m22:26:23.824183 [info ] [Thread-2  ]: 10 of 11 PASS unique_dim_stores_store_key ...................................... [[32mPASS[0m in 3.92s]
[0m22:26:23.827190 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m22:26:26.620032 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m22:26:26.622017 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b (execute): 22:26:23.557772 => 22:26:26.622017
[0m22:26:26.623200 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b: Close
[0m22:26:27.398753 [info ] [Thread-1  ]: 11 of 11 PASS unique_fact_orders_orders_key .................................... [[32mPASS[0m in 3.85s]
[0m22:26:27.400754 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m22:26:27.404734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:27.405747 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m22:26:27.406754 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m22:26:27.406754 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b' was properly closed.
[0m22:26:27.407747 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53' was properly closed.
[0m22:26:27.408736 [info ] [MainThread]: 
[0m22:26:27.409733 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 25.68 seconds (25.68s).
[0m22:26:27.413745 [debug] [MainThread]: Command end result
[0m22:26:27.431320 [info ] [MainThread]: 
[0m22:26:27.433311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:26:27.434289 [info ] [MainThread]: 
[0m22:26:27.436316 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m22:26:27.438300 [debug] [MainThread]: Command `dbt test` succeeded at 22:26:27.438300 after 27.67 seconds
[0m22:26:27.440102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DDDEC50F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD8228C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD82AF0C10>]}
[0m22:26:27.440305 [debug] [MainThread]: Flushing usage events
[0m02:34:13.510669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D618314D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D618B2EE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61AB51A90>]}


============================== 02:34:13.524026 | e0c729a1-96ac-429c-9c00-aebd228c242c ==============================
[0m02:34:13.524026 [info ] [MainThread]: Running with dbt=1.7.11
[0m02:34:13.528319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:34:25.274586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61AB3E700>]}
[0m02:34:25.597762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63B98B520>]}
[0m02:34:25.603622 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m02:34:25.708236 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m02:34:29.408536 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 1 files added, 2 files changed.
[0m02:34:29.410805 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\INTERMEDIATE\stg_salesorders.sql
[0m02:34:29.412381 [debug] [MainThread]: Partial parsing: deleted file: dbt_jaffle_shop://models\INTERMEDIATE\stg_orders.sql
[0m02:34:29.414965 [debug] [MainThread]: Partial parsing: deleted file: dbt_jaffle_shop://models\INTERMEDIATE\stg_items.sql
[0m02:34:29.416187 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\dim_date.sql
[0m02:34:29.419186 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\CORE\fact_orders.sql
[0m02:34:30.349083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C10E5B0>]}
[0m02:34:30.408436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63BCE1610>]}
[0m02:34:30.410550 [info ] [MainThread]: Found 11 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m02:34:30.414164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63BCE13A0>]}
[0m02:34:30.415190 [info ] [MainThread]: 
[0m02:34:30.425051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:34:30.430878 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:34:30.435586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:34:30.482859 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:34:30.492285 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:34:30.494378 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:34:30.496405 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:34:30.498502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:30.500349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:36.703697 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 6.0 seconds
[0m02:34:36.707723 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 6.0 seconds
[0m02:34:36.707723 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:34:36.718765 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:34:37.470254 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:34:37.475951 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:34:37.479287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:39.710283 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:34:39.720011 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:34:40.441300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m02:34:40.444935 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m02:34:40.458842 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m02:34:40.479356 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m02:34:40.479356 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m02:34:40.484620 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m02:34:40.485638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:40.489488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:34:42.895735 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m02:34:42.901123 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m02:34:42.989975 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m02:34:42.995274 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m02:34:43.450011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m02:34:43.466162 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m02:34:43.468425 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m02:34:43.471434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:34:45.694080 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m02:34:45.694080 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m02:34:46.368721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63BCEF6A0>]}
[0m02:34:46.369751 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m02:34:46.375533 [info ] [MainThread]: 
[0m02:34:46.400552 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m02:34:46.403236 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m02:34:46.408330 [info ] [Thread-1  ]: 1 of 11 START sql view model RAW.dates ......................................... [RUN]
[0m02:34:46.408691 [info ] [Thread-2  ]: 2 of 11 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m02:34:46.408691 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m02:34:46.425513 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m02:34:46.428646 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m02:34:46.430979 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m02:34:46.496296 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m02:34:46.556171 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:34:46.565248 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m02:34:46.567594 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 02:34:46.489646 => 02:34:46.566516
[0m02:34:46.570029 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:34:46.572289 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m02:34:46.660812 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m02:34:46.683545 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m02:34:46.684548 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m02:34:46.687469 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:34:49.400045 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:34:49.487910 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 02:34:46.579557 => 02:34:49.485881
[0m02:34:49.491813 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m02:34:49.717933 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:34:50.027749 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m02:34:50.031626 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 02:34:46.432001 => 02:34:50.030621
[0m02:34:50.034397 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m02:34:50.047668 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m02:34:50.068882 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:34:50.071894 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m02:34:50.186992 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C299160>]}
[0m02:34:50.195478 [info ] [Thread-2  ]: 2 of 11 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 3.76s]
[0m02:34:50.199741 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m02:34:50.201654 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m02:34:50.205020 [info ] [Thread-2  ]: 3 of 11 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m02:34:50.210329 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_products)
[0m02:34:50.212339 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m02:34:50.228860 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m02:34:50.244424 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 02:34:50.214532 => 02:34:50.243440
[0m02:34:50.248791 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m02:34:50.261236 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m02:34:50.271800 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m02:34:50.275109 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m02:34:50.277047 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:34:50.612327 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:34:50.623934 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 02:34:50.036381 => 02:34:50.619392
[0m02:34:50.626676 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m02:34:51.313465 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C428640>]}
[0m02:34:51.318804 [info ] [Thread-1  ]: 1 of 11 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 4.90s]
[0m02:34:51.323454 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m02:34:51.326226 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_salesorders
[0m02:34:51.329079 [info ] [Thread-1  ]: 4 of 11 START sql view model INTERMEDIATE.stg_salesorders ...................... [RUN]
[0m02:34:51.333623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_salesorders)
[0m02:34:51.335772 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_salesorders
[0m02:34:51.358049 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:34:51.363756 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (compile): 02:34:51.337394 => 02:34:51.362012
[0m02:34:51.365098 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_salesorders
[0m02:34:51.382169 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:34:51.388504 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_salesorders"
[0m02:34:51.391345 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_salesorders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_salesorders
  
   as (
    SELECT 
id As order_id,
ri.id As item_id,
customer As customer_id,
store_id,
sku As product_id,
unit_price As subtotal,
(unit_price * tax_rate) As tax_paid,
unit_price + (unit_price * tax_rate) As order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders as ro
JOIN JAFFLE_SHOP.RAW.raw_items as ri
ON ro.id=ri.order_id
LEFT JOIN JAFFLE_SHOP.RAW.raw_products as rp
ON ri.sku=rp.sku
LEFT JOIN JAFFLE_SHOP.RAW.raw_stores as rs
ON ro.store_id=rs.id
  );
[0m02:34:51.394189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:34:52.677753 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:34:52.685284 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 02:34:50.249788 => 02:34:52.685284
[0m02:34:52.690896 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m02:34:53.230738 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63BDCF100>]}
[0m02:34:53.247986 [info ] [Thread-2  ]: 3 of 11 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 3.02s]
[0m02:34:53.251405 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m02:34:53.253610 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m02:34:53.257592 [info ] [Thread-2  ]: 5 of 11 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m02:34:53.269224 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_stores)
[0m02:34:53.274501 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m02:34:53.290348 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m02:34:53.303024 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 02:34:53.278172 => 02:34:53.301939
[0m02:34:53.306599 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m02:34:53.320923 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m02:34:53.328667 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m02:34:53.331303 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m02:34:53.331937 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:34:54.003058 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4883e-0205-3128-0006-1c670001f036
[0m02:34:54.006810 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'ID'
[0m02:34:54.011635 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (execute): 02:34:51.367915 => 02:34:54.009375
[0m02:34:54.014599 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: Close
[0m02:34:54.624218 [debug] [Thread-1  ]: Database Error in model stg_salesorders (models\INTERMEDIATE\stg_salesorders.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'ID'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_salesorders.sql
[0m02:34:54.625226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C1A8700>]}
[0m02:34:54.628747 [error] [Thread-1  ]: 4 of 11 ERROR creating sql view model INTERMEDIATE.stg_salesorders ............. [[31mERROR[0m in 3.29s]
[0m02:34:54.632640 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_salesorders
[0m02:34:54.635404 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m02:34:54.638044 [info ] [Thread-1  ]: 6 of 11 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m02:34:54.643430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_salesorders, now model.dbt_jaffle_shop.stg_supplies)
[0m02:34:54.647038 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m02:34:54.665191 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:34:54.670076 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 02:34:54.649283 => 02:34:54.665191
[0m02:34:54.674886 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m02:34:54.692438 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:34:54.696600 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m02:34:54.696600 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m02:34:54.701394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:34:57.045881 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m02:34:57.059115 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 02:34:53.309761 => 02:34:57.057858
[0m02:34:57.059115 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m02:34:57.084218 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:34:57.084218 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 02:34:54.677165 => 02:34:57.084218
[0m02:34:57.094678 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m02:34:57.626855 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C1CA0A0>]}
[0m02:34:57.630664 [info ] [Thread-2  ]: 5 of 11 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 4.36s]
[0m02:34:57.634239 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m02:34:57.636568 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m02:34:57.639914 [info ] [Thread-2  ]: 7 of 11 START sql table model CORE.dim_customers ............................... [RUN]
[0m02:34:57.644265 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m02:34:57.647431 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m02:34:57.667810 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m02:34:57.686460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C431FA0>]}
[0m02:34:57.689483 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 02:34:57.650441 => 02:34:57.687295
[0m02:34:57.694508 [info ] [Thread-1  ]: 6 of 11 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 3.04s]
[0m02:34:57.697794 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m02:34:57.701364 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m02:34:57.777914 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m02:34:57.790034 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m02:34:57.793876 [info ] [Thread-1  ]: 8 of 11 START sql table model CORE.dim_date .................................... [RUN]
[0m02:34:57.798886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m02:34:57.800872 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m02:34:57.818140 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m02:34:57.823142 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m02:34:57.827467 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 02:34:57.802880 => 02:34:57.825536
[0m02:34:57.829507 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m02:34:57.832454 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m02:34:57.834975 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:34:57.846296 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m02:34:57.858836 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m02:34:57.862404 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2)) AS INTEGER) As month_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m02:34:57.865294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:35:01.713603 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m02:35:01.717269 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 02:34:57.703414 => 02:35:01.717269
[0m02:35:01.724721 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m02:35:01.893628 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m02:35:01.903211 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 02:34:57.837166 => 02:35:01.903211
[0m02:35:01.903211 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m02:35:02.280129 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C270730>]}
[0m02:35:02.280129 [info ] [Thread-2  ]: 7 of 11 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 4.64s]
[0m02:35:02.287212 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m02:35:02.290168 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m02:35:02.293052 [info ] [Thread-2  ]: 9 of 11 START sql table model CORE.dim_products ................................ [RUN]
[0m02:35:02.297270 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.dim_products)
[0m02:35:02.298431 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m02:35:02.323313 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m02:35:02.340549 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 02:35:02.302895 => 02:35:02.338210
[0m02:35:02.340549 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m02:35:02.360698 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m02:35:02.367543 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m02:35:02.369256 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m02:35:02.371918 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:35:02.482263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63BCEFD60>]}
[0m02:35:02.489348 [info ] [Thread-1  ]: 8 of 11 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 4.68s]
[0m02:35:02.494566 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m02:35:02.497278 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m02:35:02.499925 [info ] [Thread-1  ]: 10 of 11 SKIP relation CORE.fact_orders ........................................ [[33mSKIP[0m]
[0m02:35:02.504989 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m02:35:02.508553 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m02:35:02.511187 [info ] [Thread-1  ]: 11 of 11 START sql table model CORE.dim_stores ................................. [RUN]
[0m02:35:02.516001 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_stores)
[0m02:35:02.519758 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m02:35:02.548640 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m02:35:02.565032 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 02:35:02.523379 => 02:35:02.564058
[0m02:35:02.568544 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m02:35:02.584053 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m02:35:02.590276 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m02:35:02.593502 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m02:35:02.595723 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:35:05.981191 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m02:35:05.986251 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:35:05.995577 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 02:35:02.344303 => 02:35:05.993552
[0m02:35:06.006105 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 02:35:02.570479 => 02:35:06.005001
[0m02:35:06.008669 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m02:35:06.010798 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m02:35:06.686634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C428640>]}
[0m02:35:06.690060 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0c729a1-96ac-429c-9c00-aebd228c242c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C55F3A0>]}
[0m02:35:06.693436 [info ] [Thread-1  ]: 11 of 11 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 4.17s]
[0m02:35:06.698903 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m02:35:06.695805 [info ] [Thread-2  ]: 9 of 11 OK created sql table model CORE.dim_products ........................... [[32mSUCCESS 1[0m in 4.39s]
[0m02:35:06.703635 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m02:35:06.708377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:06.711445 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:35:06.713151 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:35:06.717255 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m02:35:06.719270 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m02:35:06.721475 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m02:35:06.725507 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_products' was properly closed.
[0m02:35:06.728773 [info ] [MainThread]: 
[0m02:35:06.729852 [info ] [MainThread]: Finished running 6 view models, 5 table models in 0 hours 0 minutes and 36.30 seconds (36.30s).
[0m02:35:06.745280 [debug] [MainThread]: Command end result
[0m02:35:06.809205 [info ] [MainThread]: 
[0m02:35:06.813108 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:35:06.815975 [info ] [MainThread]: 
[0m02:35:06.819772 [error] [MainThread]:   Database Error in model stg_salesorders (models\INTERMEDIATE\stg_salesorders.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'ID'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_salesorders.sql
[0m02:35:06.824244 [info ] [MainThread]: 
[0m02:35:06.828832 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=1 TOTAL=11
[0m02:35:06.834332 [debug] [MainThread]: Command `dbt run` failed at 02:35:06.834332 after 53.62 seconds
[0m02:35:06.838402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D618314D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63B98B520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D63C2AF8B0>]}
[0m02:35:06.843410 [debug] [MainThread]: Flushing usage events
[0m02:36:24.994353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027187F60F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027186E0CA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027186E0C670>]}


============================== 02:36:24.998847 | e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4 ==============================
[0m02:36:24.998847 [info ] [MainThread]: Running with dbt=1.7.11
[0m02:36:25.001320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:36:26.171258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027186E2D640>]}
[0m02:36:26.260205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AB7675B0>]}
[0m02:36:26.261719 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m02:36:26.281289 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m02:36:26.440828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:26.455656 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\INTERMEDIATE\stg_salesorders.sql
[0m02:36:26.580875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABBEE0D0>]}
[0m02:36:26.599526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AB932040>]}
[0m02:36:26.600523 [info ] [MainThread]: Found 11 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m02:36:26.601946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AB9320A0>]}
[0m02:36:26.604883 [info ] [MainThread]: 
[0m02:36:26.606863 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:36:26.609892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:36:26.623948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:36:26.622864 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:36:26.628878 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:36:26.630381 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:36:26.631398 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:36:26.632520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:26.634550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:29.875076 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m02:36:29.876075 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:36:29.882245 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m02:36:29.885057 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:36:30.523465 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:36:30.523465 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:36:30.526420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:32.407089 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:36:32.409471 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:36:32.986431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m02:36:32.989449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m02:36:32.999232 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m02:36:33.003776 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m02:36:33.004987 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m02:36:33.005760 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m02:36:33.006761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:33.006761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:34.865567 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m02:36:34.868379 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m02:36:34.922488 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:36:34.924514 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m02:36:35.402287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m02:36:35.409078 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m02:36:35.409832 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m02:36:35.410100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:37.182503 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m02:36:37.184392 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m02:36:37.880806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AB62AA00>]}
[0m02:36:37.882911 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m02:36:37.883916 [info ] [MainThread]: 
[0m02:36:37.889916 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m02:36:37.890914 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m02:36:37.891914 [info ] [Thread-1  ]: 1 of 11 START sql view model RAW.dates ......................................... [RUN]
[0m02:36:37.894695 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m02:36:37.892919 [info ] [Thread-2  ]: 2 of 11 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m02:36:37.895776 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m02:36:37.897516 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m02:36:37.937496 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:36:37.938691 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m02:36:37.939462 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m02:36:37.944517 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m02:36:37.945563 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:36:37.949063 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 02:36:37.940467 => 02:36:37.948513
[0m02:36:37.950731 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m02:36:37.981787 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m02:36:37.983452 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m02:36:37.983983 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m02:36:37.985099 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:36:39.876627 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:39.944413 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m02:36:39.956893 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 02:36:37.898175 => 02:36:39.956893
[0m02:36:39.957903 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m02:36:39.960444 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m02:36:39.966717 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:36:39.966717 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m02:36:40.006000 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:40.028828 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 02:36:37.951656 => 02:36:40.027820
[0m02:36:40.028828 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m02:36:40.595311 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABEC8AC0>]}
[0m02:36:40.596326 [info ] [Thread-2  ]: 2 of 11 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.70s]
[0m02:36:40.598303 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m02:36:40.600306 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m02:36:40.601989 [info ] [Thread-2  ]: 3 of 11 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m02:36:40.604311 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_products)
[0m02:36:40.605314 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m02:36:40.609325 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m02:36:40.611733 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:36:40.615325 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 02:36:39.958912 => 02:36:40.615325
[0m02:36:40.616388 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m02:36:40.618217 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 02:36:40.605314 => 02:36:40.617299
[0m02:36:40.619349 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m02:36:40.625355 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m02:36:40.627357 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m02:36:40.627357 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m02:36:40.628823 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:36:41.154167 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABF16640>]}
[0m02:36:41.155351 [info ] [Thread-1  ]: 1 of 11 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.26s]
[0m02:36:41.157361 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m02:36:41.158349 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_salesorders
[0m02:36:41.159372 [info ] [Thread-1  ]: 4 of 11 START sql view model INTERMEDIATE.stg_salesorders ...................... [RUN]
[0m02:36:41.161253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_salesorders)
[0m02:36:41.162250 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_salesorders
[0m02:36:41.164400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:36:41.170144 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (compile): 02:36:41.162250 => 02:36:41.164400
[0m02:36:41.170718 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_salesorders
[0m02:36:41.175705 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:36:41.177507 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_salesorders"
[0m02:36:41.178645 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_salesorders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_salesorders
  
   as (
    SELECT 
ro.id As order_id,
ri.id As item_id,
customer As customer_id,
ro.store_id,
ri.sku As product_id,
unit_price As subtotal,
(unit_price * tax_rate) As tax_paid,
unit_price + (unit_price * tax_rate) As order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders as ro
JOIN JAFFLE_SHOP.RAW.raw_items as ri
ON ro.id=ri.order_id
LEFT JOIN JAFFLE_SHOP.RAW.raw_products as rp
ON ri.sku=rp.sku
LEFT JOIN JAFFLE_SHOP.RAW.raw_stores as rs
ON ro.store_id=rs.id
  );
[0m02:36:41.179267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:36:42.476971 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:42.479992 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 02:36:40.620375 => 02:36:42.478983
[0m02:36:42.479992 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m02:36:42.809188 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b48840-0205-3127-0006-1c670001e036
[0m02:36:42.810188 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 0
invalid identifier 'UNIT_PRICE'
[0m02:36:42.811196 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (execute): 02:36:41.171821 => 02:36:42.811196
[0m02:36:42.812176 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: Close
[0m02:36:43.085350 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABD02C70>]}
[0m02:36:43.087120 [info ] [Thread-2  ]: 3 of 11 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.48s]
[0m02:36:43.088057 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m02:36:43.089479 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m02:36:43.090186 [info ] [Thread-2  ]: 5 of 11 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m02:36:43.093056 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_stores)
[0m02:36:43.094046 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m02:36:43.098069 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m02:36:43.099074 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 02:36:43.094046 => 02:36:43.099074
[0m02:36:43.100057 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m02:36:43.104175 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m02:36:43.106065 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m02:36:43.106065 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m02:36:43.107053 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:36:43.359343 [debug] [Thread-1  ]: Database Error in model stg_salesorders (models\INTERMEDIATE\stg_salesorders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 0
  invalid identifier 'UNIT_PRICE'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_salesorders.sql
[0m02:36:43.360476 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABF967C0>]}
[0m02:36:43.361545 [error] [Thread-1  ]: 4 of 11 ERROR creating sql view model INTERMEDIATE.stg_salesorders ............. [[31mERROR[0m in 2.20s]
[0m02:36:43.363821 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_salesorders
[0m02:36:43.364700 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m02:36:43.365854 [info ] [Thread-1  ]: 6 of 11 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m02:36:43.367544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_salesorders, now model.dbt_jaffle_shop.stg_supplies)
[0m02:36:43.368504 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m02:36:43.374956 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:36:43.376960 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 02:36:43.368504 => 02:36:43.375959
[0m02:36:43.376960 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m02:36:43.518624 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:36:43.521502 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m02:36:43.522018 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m02:36:43.523139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:36:44.906715 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:44.916366 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 02:36:43.100057 => 02:36:44.916366
[0m02:36:44.920569 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m02:36:45.357001 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:36:45.357001 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 02:36:43.378329 => 02:36:45.357001
[0m02:36:45.357001 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m02:36:45.510825 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AC112D60>]}
[0m02:36:45.510825 [info ] [Thread-2  ]: 5 of 11 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 2.42s]
[0m02:36:45.514432 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m02:36:45.514432 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m02:36:45.515916 [info ] [Thread-2  ]: 7 of 11 START sql table model CORE.dim_customers ............................... [RUN]
[0m02:36:45.518943 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m02:36:45.519937 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m02:36:45.521934 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m02:36:45.535986 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 02:36:45.519937 => 02:36:45.535691
[0m02:36:45.537475 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m02:36:45.560058 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m02:36:45.561551 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m02:36:45.561551 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m02:36:45.562567 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:36:45.887629 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABEFC940>]}
[0m02:36:45.887629 [info ] [Thread-1  ]: 6 of 11 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 2.52s]
[0m02:36:45.894117 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m02:36:45.895111 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m02:36:45.896128 [info ] [Thread-1  ]: 8 of 11 START sql table model CORE.dim_date .................................... [RUN]
[0m02:36:45.898517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m02:36:45.899512 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m02:36:45.901154 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m02:36:45.904827 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 02:36:45.900149 => 02:36:45.901154
[0m02:36:45.904827 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m02:36:45.906831 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m02:36:45.910342 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m02:36:45.911638 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2)) AS INTEGER) As month_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m02:36:45.912402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:36:48.912638 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:36:48.916854 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 02:36:45.537992 => 02:36:48.915732
[0m02:36:48.916854 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m02:36:49.094179 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:36:49.099770 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 02:36:45.905830 => 02:36:49.098780
[0m02:36:49.100760 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m02:36:49.481351 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABFC2DF0>]}
[0m02:36:49.486015 [info ] [Thread-2  ]: 7 of 11 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 3.96s]
[0m02:36:49.487206 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m02:36:49.488396 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m02:36:49.490543 [info ] [Thread-2  ]: 9 of 11 START sql table model CORE.dim_products ................................ [RUN]
[0m02:36:49.492850 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.dim_products)
[0m02:36:49.494038 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m02:36:49.500856 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m02:36:49.502578 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 02:36:49.495212 => 02:36:49.502578
[0m02:36:49.503624 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m02:36:49.510672 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m02:36:49.512625 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m02:36:49.513745 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m02:36:49.514285 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:36:49.657048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABC75940>]}
[0m02:36:49.658045 [info ] [Thread-1  ]: 8 of 11 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 3.76s]
[0m02:36:49.659857 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m02:36:49.660857 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m02:36:49.660857 [info ] [Thread-1  ]: 10 of 11 SKIP relation CORE.fact_orders ........................................ [[33mSKIP[0m]
[0m02:36:49.663136 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m02:36:49.664147 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m02:36:49.665145 [info ] [Thread-1  ]: 11 of 11 START sql table model CORE.dim_stores ................................. [RUN]
[0m02:36:49.668110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_stores)
[0m02:36:49.668204 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m02:36:49.674378 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m02:36:49.675226 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 02:36:49.669370 => 02:36:49.675226
[0m02:36:49.676204 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m02:36:49.679202 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m02:36:49.681958 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m02:36:49.682973 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m02:36:49.683451 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:36:52.595084 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:36:52.597068 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:36:52.598616 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 02:36:49.504855 => 02:36:52.598616
[0m02:36:52.603337 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 02:36:49.677213 => 02:36:52.603337
[0m02:36:52.604355 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m02:36:52.604355 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m02:36:53.196166 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AC007CD0>]}
[0m02:36:53.200642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e11ae4a0-2a62-4e72-a18a-4b88c4d03ab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271ABBB0850>]}
[0m02:36:53.199149 [info ] [Thread-2  ]: 9 of 11 OK created sql table model CORE.dim_products ........................... [[32mSUCCESS 1[0m in 3.70s]
[0m02:36:53.204169 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m02:36:53.202145 [info ] [Thread-1  ]: 11 of 11 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.53s]
[0m02:36:53.206148 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m02:36:53.209156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:53.210165 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:36:53.211165 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:36:53.211738 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m02:36:53.212155 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m02:36:53.213145 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m02:36:53.213315 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_products' was properly closed.
[0m02:36:53.214146 [info ] [MainThread]: 
[0m02:36:53.216144 [info ] [MainThread]: Finished running 6 view models, 5 table models in 0 hours 0 minutes and 26.61 seconds (26.61s).
[0m02:36:53.219469 [debug] [MainThread]: Command end result
[0m02:36:53.234516 [info ] [MainThread]: 
[0m02:36:53.236523 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:36:53.237520 [info ] [MainThread]: 
[0m02:36:53.239082 [error] [MainThread]:   Database Error in model stg_salesorders (models\INTERMEDIATE\stg_salesorders.sql)
  000904 (42000): SQL compilation error: error line 10 at position 0
  invalid identifier 'UNIT_PRICE'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_salesorders.sql
[0m02:36:53.240322 [info ] [MainThread]: 
[0m02:36:53.241339 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=1 TOTAL=11
[0m02:36:53.243330 [debug] [MainThread]: Command `dbt run` failed at 02:36:53.243330 after 28.31 seconds
[0m02:36:53.244762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027187F60F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AB58B8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271AB69EB50>]}
[0m02:36:53.245757 [debug] [MainThread]: Flushing usage events
[0m02:39:16.574136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E48DFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E37AD5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E37AD880>]}


============================== 02:39:16.578080 | d8999d8b-b779-4294-8e4f-d8c22d88cc09 ==============================
[0m02:39:16.578080 [info ] [MainThread]: Running with dbt=1.7.11
[0m02:39:16.580320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:39:18.098636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E37AD730>]}
[0m02:39:18.185009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E4F165B0>]}
[0m02:39:18.187713 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m02:39:18.206578 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m02:39:18.390917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:39:18.391917 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\INTERMEDIATE\stg_salesorders.sql
[0m02:39:18.557750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38856E0D0>]}
[0m02:39:18.577340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3882B50D0>]}
[0m02:39:18.578348 [info ] [MainThread]: Found 11 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m02:39:18.579338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3882B5130>]}
[0m02:39:18.583335 [info ] [MainThread]: 
[0m02:39:18.585346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:39:18.590335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:39:18.603348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:39:18.619342 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:39:18.625354 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:39:18.626722 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:39:18.628340 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:39:18.629336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:18.630342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:21.488993 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m02:39:21.491649 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:39:21.521934 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m02:39:21.523054 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:39:22.049019 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:39:22.050074 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:39:22.050614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:23.766101 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:39:23.767791 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:39:24.309428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m02:39:24.311245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m02:39:24.322520 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m02:39:24.325385 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m02:39:24.325385 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m02:39:24.327335 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m02:39:24.328470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:24.328470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:26.153083 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m02:39:26.156958 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m02:39:26.272564 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:39:26.275028 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m02:39:26.711035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m02:39:26.716922 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m02:39:26.717938 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m02:39:26.717938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:28.435460 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m02:39:28.438764 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m02:39:29.085566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388020730>]}
[0m02:39:29.087563 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m02:39:29.089571 [info ] [MainThread]: 
[0m02:39:29.094562 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m02:39:29.096151 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m02:39:29.098360 [info ] [Thread-1  ]: 1 of 11 START sql view model RAW.dates ......................................... [RUN]
[0m02:39:29.101559 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m02:39:29.099618 [info ] [Thread-2  ]: 2 of 11 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m02:39:29.102799 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m02:39:29.104561 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m02:39:29.147241 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m02:39:29.149759 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:39:29.155336 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m02:39:29.155759 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m02:39:29.156757 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:39:29.158758 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 02:39:29.150763 => 02:39:29.158758
[0m02:39:29.161764 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m02:39:29.194496 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m02:39:29.196500 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m02:39:29.196500 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m02:39:29.198177 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:39:30.995144 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:39:31.058382 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m02:39:31.074576 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 02:39:29.105561 => 02:39:31.074029
[0m02:39:31.075578 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m02:39:31.078456 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m02:39:31.085221 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:39:31.085221 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m02:39:31.113334 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:39:31.133592 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 02:39:29.162757 => 02:39:31.133592
[0m02:39:31.136040 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m02:39:31.694849 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3887D9130>]}
[0m02:39:31.696847 [info ] [Thread-2  ]: 2 of 11 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.59s]
[0m02:39:31.698816 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m02:39:31.700850 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m02:39:31.702921 [info ] [Thread-2  ]: 3 of 11 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m02:39:31.706126 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_products)
[0m02:39:31.707376 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m02:39:31.715611 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m02:39:31.718840 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 02:39:31.708380 => 02:39:31.718253
[0m02:39:31.720844 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m02:39:31.727055 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m02:39:31.729726 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m02:39:31.730727 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m02:39:31.732728 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:39:31.782733 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:39:31.787388 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 02:39:31.075578 => 02:39:31.787388
[0m02:39:31.788387 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m02:39:32.381491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38893B7C0>]}
[0m02:39:32.382511 [info ] [Thread-1  ]: 1 of 11 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.28s]
[0m02:39:32.384645 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m02:39:32.386657 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_salesorders
[0m02:39:32.387667 [info ] [Thread-1  ]: 4 of 11 START sql view model INTERMEDIATE.stg_salesorders ...................... [RUN]
[0m02:39:32.389657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_salesorders)
[0m02:39:32.390530 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_salesorders
[0m02:39:32.397984 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:39:32.399986 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (compile): 02:39:32.391542 => 02:39:32.398983
[0m02:39:32.401150 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_salesorders
[0m02:39:32.405354 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:39:32.407923 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_salesorders"
[0m02:39:32.409212 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_salesorders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_salesorders
  
   as (
    SELECT 
ro.id As order_id,
ri.id As item_id,
customer As customer_id,
ro.store_id,
ri.sku As product_id,
price As subtotal,
(price * tax_rate) As tax_paid,
price + (price * tax_rate) As order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders as ro
JOIN JAFFLE_SHOP.RAW.raw_items as ri
ON ro.id=ri.order_id
LEFT JOIN JAFFLE_SHOP.RAW.raw_products as rp
ON ri.sku=rp.sku
LEFT JOIN JAFFLE_SHOP.RAW.raw_stores as rs
ON ro.store_id=rs.id
  );
[0m02:39:32.409212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:39:33.580907 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:39:33.584860 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 02:39:31.721836 => 02:39:33.584300
[0m02:39:33.586118 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m02:39:34.181149 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388938E50>]}
[0m02:39:34.183376 [info ] [Thread-2  ]: 3 of 11 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.48s]
[0m02:39:34.186379 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m02:39:34.187385 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m02:39:34.189387 [info ] [Thread-2  ]: 5 of 11 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m02:39:34.191383 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_stores)
[0m02:39:34.192441 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m02:39:34.197218 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m02:39:34.198790 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 02:39:34.193446 => 02:39:34.197786
[0m02:39:34.199797 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m02:39:34.203980 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m02:39:34.206975 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m02:39:34.208017 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m02:39:34.209023 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:39:34.240787 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b48843-0205-3129-0006-1c6700029042
[0m02:39:34.240787 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name '_AIRBYTE_EXTRACTED_AT'
[0m02:39:34.247817 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (execute): 02:39:32.402155 => 02:39:34.247817
[0m02:39:34.248820 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: Close
[0m02:39:34.804644 [debug] [Thread-1  ]: Database Error in model stg_salesorders (models\INTERMEDIATE\stg_salesorders.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name '_AIRBYTE_EXTRACTED_AT'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_salesorders.sql
[0m02:39:34.804644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3887D9FD0>]}
[0m02:39:34.812163 [error] [Thread-1  ]: 4 of 11 ERROR creating sql view model INTERMEDIATE.stg_salesorders ............. [[31mERROR[0m in 2.42s]
[0m02:39:34.814188 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_salesorders
[0m02:39:34.815159 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m02:39:34.816187 [info ] [Thread-1  ]: 6 of 11 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m02:39:34.819167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_salesorders, now model.dbt_jaffle_shop.stg_supplies)
[0m02:39:34.820222 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m02:39:34.902966 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:39:34.907662 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 02:39:34.821230 => 02:39:34.902966
[0m02:39:34.908678 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m02:39:34.909681 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:39:34.914779 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m02:39:34.914779 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m02:39:34.915793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:39:36.014499 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:39:36.027270 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 02:39:34.200978 => 02:39:36.027270
[0m02:39:36.027270 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m02:39:36.581886 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3889B00D0>]}
[0m02:39:36.582898 [info ] [Thread-2  ]: 5 of 11 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 2.39s]
[0m02:39:36.584820 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m02:39:36.585831 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m02:39:36.587831 [info ] [Thread-2  ]: 7 of 11 START sql table model CORE.dim_customers ............................... [RUN]
[0m02:39:36.589830 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m02:39:36.590828 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m02:39:36.610132 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m02:39:36.611846 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 02:39:36.590828 => 02:39:36.611286
[0m02:39:36.613130 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m02:39:36.642123 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m02:39:36.643730 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m02:39:36.644867 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m02:39:36.645408 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:39:36.671249 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:39:36.674257 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 02:39:34.908678 => 02:39:36.674257
[0m02:39:36.675323 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m02:39:37.229968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388853970>]}
[0m02:39:37.231049 [info ] [Thread-1  ]: 6 of 11 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 2.41s]
[0m02:39:37.233069 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m02:39:37.234076 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m02:39:37.235090 [info ] [Thread-1  ]: 8 of 11 START sql table model CORE.dim_date .................................... [RUN]
[0m02:39:37.237085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m02:39:37.239087 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m02:39:37.243089 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m02:39:37.245237 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 02:39:37.239087 => 02:39:37.245237
[0m02:39:37.246241 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m02:39:37.253350 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m02:39:37.255491 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m02:39:37.256615 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2)) AS INTEGER) As month_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m02:39:37.257177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:39:39.741637 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:39:39.746017 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 02:39:36.613801 => 02:39:39.746017
[0m02:39:39.747135 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m02:39:40.429936 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:39:40.434692 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 02:39:37.247254 => 02:39:40.434692
[0m02:39:40.437058 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3885156A0>]}
[0m02:39:40.438672 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m02:39:40.439510 [info ] [Thread-2  ]: 7 of 11 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 3.85s]
[0m02:39:40.443514 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m02:39:40.445518 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m02:39:40.446491 [info ] [Thread-2  ]: 9 of 11 START sql table model CORE.dim_products ................................ [RUN]
[0m02:39:40.448645 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.dim_products)
[0m02:39:40.449938 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m02:39:40.455006 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m02:39:40.456922 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 02:39:40.450492 => 02:39:40.455919
[0m02:39:40.456922 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m02:39:40.462211 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m02:39:40.464063 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m02:39:40.465065 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m02:39:40.465065 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:39:40.998025 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3889610A0>]}
[0m02:39:40.999228 [info ] [Thread-1  ]: 8 of 11 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 3.76s]
[0m02:39:41.000949 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m02:39:41.002090 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m02:39:41.003205 [info ] [Thread-1  ]: 10 of 11 SKIP relation CORE.fact_orders ........................................ [[33mSKIP[0m]
[0m02:39:41.004908 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m02:39:41.006074 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m02:39:41.007263 [info ] [Thread-1  ]: 11 of 11 START sql table model CORE.dim_stores ................................. [RUN]
[0m02:39:41.009104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.dim_stores)
[0m02:39:41.009654 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m02:39:41.014648 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m02:39:41.016353 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 02:39:41.010188 => 02:39:41.015743
[0m02:39:41.017458 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m02:39:41.021644 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m02:39:41.022893 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m02:39:41.024011 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m02:39:41.024627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:39:43.067738 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:39:43.071740 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 02:39:40.457947 => 02:39:43.070738
[0m02:39:43.072023 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m02:39:43.720849 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:39:43.723924 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 02:39:41.017998 => 02:39:43.723924
[0m02:39:43.724924 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m02:39:43.774063 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38895F580>]}
[0m02:39:43.774063 [info ] [Thread-2  ]: 9 of 11 OK created sql table model CORE.dim_products ........................... [[32mSUCCESS 1[0m in 3.33s]
[0m02:39:43.785609 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m02:39:44.275599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8999d8b-b779-4294-8e4f-d8c22d88cc09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3887F5100>]}
[0m02:39:44.277195 [info ] [Thread-1  ]: 11 of 11 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.27s]
[0m02:39:44.278605 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m02:39:44.282596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:39:44.283184 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:39:44.283929 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:39:44.284597 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m02:39:44.284879 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m02:39:44.284879 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m02:39:44.286227 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_products' was properly closed.
[0m02:39:44.286900 [info ] [MainThread]: 
[0m02:39:44.287894 [info ] [MainThread]: Finished running 6 view models, 5 table models in 0 hours 0 minutes and 25.70 seconds (25.70s).
[0m02:39:44.289891 [debug] [MainThread]: Command end result
[0m02:39:44.306401 [info ] [MainThread]: 
[0m02:39:44.308404 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:39:44.309416 [info ] [MainThread]: 
[0m02:39:44.310699 [error] [MainThread]:   Database Error in model stg_salesorders (models\INTERMEDIATE\stg_salesorders.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name '_AIRBYTE_EXTRACTED_AT'
  compiled Code at target\run\dbt_jaffle_shop\models\INTERMEDIATE\stg_salesorders.sql
[0m02:39:44.311699 [info ] [MainThread]: 
[0m02:39:44.313002 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=1 TOTAL=11
[0m02:39:44.315007 [debug] [MainThread]: Command `dbt run` failed at 02:39:44.315007 after 27.80 seconds
[0m02:39:44.316009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E48DFEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E4F165B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B388974F70>]}
[0m02:39:44.317984 [debug] [MainThread]: Flushing usage events
[0m02:40:46.625693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B55F4F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B54E1DEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B54E1D5B0>]}


============================== 02:40:46.629785 | 891761e5-939c-4261-99a1-aa303caa3dc9 ==============================
[0m02:40:46.629785 [info ] [MainThread]: Running with dbt=1.7.11
[0m02:40:46.631526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\airflow\\dbt\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:40:47.767970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79578730>]}
[0m02:40:47.860255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B795F57C0>]}
[0m02:40:47.862770 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m02:40:47.883640 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m02:40:48.068758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:40:48.069866 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\INTERMEDIATE\stg_salesorders.sql
[0m02:40:48.208595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79BDE0D0>]}
[0m02:40:48.225876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79922370>]}
[0m02:40:48.226884 [info ] [MainThread]: Found 11 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m02:40:48.227899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79922130>]}
[0m02:40:48.229902 [info ] [MainThread]: 
[0m02:40:48.232604 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:40:48.234926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:40:48.246381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m02:40:48.251450 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:40:48.256143 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:40:48.257364 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:40:48.258152 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:40:48.259146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:48.260146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:50.390320 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:40:50.392383 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:40:50.394415 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:40:50.397584 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:40:50.958925 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m02:40:50.959881 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m02:40:50.961260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:52.633150 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:40:52.636457 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m02:40:53.231963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m02:40:53.234567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m02:40:53.243628 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m02:40:53.248715 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m02:40:53.249862 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m02:40:53.251297 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m02:40:53.251847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:53.252987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:40:55.183661 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m02:40:55.186543 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m02:40:55.221291 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m02:40:55.235876 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m02:40:55.803494 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m02:40:55.810251 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m02:40:55.810251 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m02:40:55.812891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:40:57.613703 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m02:40:57.616281 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m02:40:58.191784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79A2B4F0>]}
[0m02:40:58.192978 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m02:40:58.193999 [info ] [MainThread]: 
[0m02:40:58.200633 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m02:40:58.202112 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m02:40:58.203583 [info ] [Thread-1  ]: 1 of 11 START sql view model RAW.dates ......................................... [RUN]
[0m02:40:58.206115 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m02:40:58.205112 [info ] [Thread-2  ]: 2 of 11 START sql view model INTERMEDIATE.stg_customers ........................ [RUN]
[0m02:40:58.207122 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m02:40:58.209601 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m02:40:58.236327 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:40:58.246884 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m02:40:58.248953 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m02:40:58.255139 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m02:40:58.256160 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m02:40:58.260633 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 02:40:58.249965 => 02:40:58.259619
[0m02:40:58.261631 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m02:40:58.292445 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_customers"
[0m02:40:58.294432 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_customers"
[0m02:40:58.294432 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_customers"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_customers
  
   as (
    SELECT 
ID As customer_id,
NAME As customer_name,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_customers
  );
[0m02:40:58.295446 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m02:41:00.278184 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:41:00.315495 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 02:40:58.262629 => 02:41:00.315122
[0m02:41:00.316492 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_customers: Close
[0m02:41:00.571585 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:41:00.633389 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m02:41:00.647472 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 02:40:58.211129 => 02:41:00.646989
[0m02:41:00.648680 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m02:41:00.649703 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dates"
[0m02:41:00.655061 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m02:41:00.655061 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
create or replace   view JAFFLE_SHOP.RAW.dates
  
   as (
    


    
with base_dates as (
    
    with date_spine as
(

    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2921
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        (row_number() over (order by 1) - 1),
        cast('2018-01-01' as timestamp)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as timestamp)

)

select * from filtered



)
select
    cast(d.date_day as timestamp) as date_day
from
    date_spine d


),
dates_with_prior_year_dates as (

    select
        cast(d.date_day as date) as date_day,
        cast(

    dateadd(
        year,
        -1,
        d.date_day
        )

 as date) as prior_year_date_day,
        cast(

    dateadd(
        day,
        -364,
        d.date_day
        )

 as date) as prior_year_over_year_date_day
    from
    	base_dates d

)
select
    d.date_day,
    cast(

    dateadd(
        day,
        -1,
        d.date_day
        )

 as date) as prior_date_day,
    cast(

    dateadd(
        day,
        1,
        d.date_day
        )

 as date) as next_date_day,
    d.prior_year_date_day as prior_year_date_day,
    d.prior_year_over_year_date_day,
    case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end as day_of_week,
    date_part('dayofweekiso', d.date_day) as day_of_week_iso,
    -- long version not implemented on Snowflake so we're doing it manually :/
    case dayname(d.date_day)
        when 'Mon' then 'Monday'
        when 'Tue' then 'Tuesday'
        when 'Wed' then 'Wednesday'
        when 'Thu' then 'Thursday'
        when 'Fri' then 'Friday'
        when 'Sat' then 'Saturday'
        when 'Sun' then 'Sunday'
    end as day_of_week_name,
    dayname(d.date_day) as day_of_week_name_short,
    date_part('day', d.date_day) as day_of_month,
    date_part('dayofyear', d.date_day) as day_of_year,

    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date) as week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.date_day) = 7 then 1
            else date_part('dayofweek', d.date_day) + 1
        end - 1),
        d.date_day
        )

 as date)
        )

 as date) as week_end_date,
    
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date) as prior_year_week_start_date,
    cast(

    dateadd(
        day,
        6,
        
    
    cast(

    dateadd(
        day,
        -1 * (case
            when date_part('dayofweek', d.prior_year_over_year_date_day) = 7 then 1
            else date_part('dayofweek', d.prior_year_over_year_date_day) + 1
        end - 1),
        d.prior_year_over_year_date_day
        )

 as date)
        )

 as date) as prior_year_week_end_date,
    cast(date_part('week', d.date_day) as integer) as week_of_year,

    cast(date_trunc('week', d.date_day) as date) as iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.date_day) as date)
        )

 as date) as iso_week_end_date,
    cast(date_trunc('week', d.prior_year_over_year_date_day) as date) as prior_year_iso_week_start_date,
    cast(

    dateadd(
        day,
        6,
        cast(date_trunc('week', d.prior_year_over_year_date_day) as date)
        )

 as date) as prior_year_iso_week_end_date,
    cast(date_part('weekiso', d.date_day) as integer) as iso_week_of_year,

    cast(date_part('week', d.prior_year_over_year_date_day) as integer) as prior_year_week_of_year,
    cast(date_part('weekiso', d.prior_year_over_year_date_day) as integer) as prior_year_iso_week_of_year,

    cast(date_part('month', d.date_day) as integer) as month_of_year,
    to_char(d.date_day, 'MMMM')  as month_name,
    to_char(d.date_day, 'MON')  as month_name_short,

    cast(date_trunc('month', d.date_day) as date) as month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.date_day)
        )


        )


        as date) as date) as month_end_date,

    cast(date_trunc('month', d.prior_year_date_day) as date) as prior_year_month_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        month,
        1,
        date_trunc('month', d.prior_year_date_day)
        )


        )


        as date) as date) as prior_year_month_end_date,

    cast(date_part('quarter', d.date_day) as integer) as quarter_of_year,
    cast(date_trunc('quarter', d.date_day) as date) as quarter_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        quarter,
        1,
        date_trunc('quarter', d.date_day)
        )


        )


        as date) as date) as quarter_end_date,

    cast(date_part('year', d.date_day) as integer) as year_number,
    cast(date_trunc('year', d.date_day) as date) as year_start_date,
    cast(cast(
        

    dateadd(
        day,
        -1,
        

    dateadd(
        year,
        1,
        date_trunc('year', d.date_day)
        )


        )


        as date) as date) as year_end_date
from
    dates_with_prior_year_dates d
order by 1


  );
[0m02:41:00.934297 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79EB7B50>]}
[0m02:41:00.934297 [info ] [Thread-2  ]: 2 of 11 OK created sql view model INTERMEDIATE.stg_customers ................... [[32mSUCCESS 1[0m in 2.73s]
[0m02:41:00.938973 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m02:41:00.938973 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m02:41:00.940379 [info ] [Thread-2  ]: 3 of 11 START sql view model INTERMEDIATE.stg_products ......................... [RUN]
[0m02:41:00.943538 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_products)
[0m02:41:00.944476 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m02:41:00.949480 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m02:41:00.950490 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 02:41:00.945486 => 02:41:00.950490
[0m02:41:00.951478 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m02:41:00.954893 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_products"
[0m02:41:00.954893 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_products"
[0m02:41:00.958469 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_products"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_products
  
   as (
    SELECT
SKU As product_id,
NAME As product_name,
TYPE As product_type,
PRICE As unit_price,
DESCRIPTION As description,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_products
  );
[0m02:41:00.959484 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:41:01.188590 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m02:41:01.188590 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 02:41:00.648680 => 02:41:01.188590
[0m02:41:01.188590 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m02:41:01.750866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79F54FA0>]}
[0m02:41:01.750866 [info ] [Thread-1  ]: 1 of 11 OK created sql view model RAW.dates .................................... [[32mSUCCESS 1[0m in 3.55s]
[0m02:41:01.756825 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m02:41:01.758241 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_salesorders
[0m02:41:01.759266 [info ] [Thread-1  ]: 4 of 11 START sql view model INTERMEDIATE.stg_salesorders ...................... [RUN]
[0m02:41:01.762267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dates, now model.dbt_jaffle_shop.stg_salesorders)
[0m02:41:01.763242 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_salesorders
[0m02:41:01.769536 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:41:01.771327 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (compile): 02:41:01.764412 => 02:41:01.771327
[0m02:41:01.772356 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_salesorders
[0m02:41:01.774347 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_salesorders"
[0m02:41:01.778057 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_salesorders"
[0m02:41:01.779074 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_salesorders"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_salesorders
  
   as (
    SELECT 
ro.id As order_id,
ri.id As item_id,
ro.customer As customer_id,
ro.store_id,
ri.sku As product_id,
rp.price As subtotal,
(rp.price * tax_rate) As tax_paid,
rp.price + (rp.price * tax_rate) As order_total,
TRY_CAST(ordered_at As TIMESTAMP) As ordered_date,
ro._AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_orders as ro
JOIN JAFFLE_SHOP.RAW.raw_items as ri
ON ro.id=ri.order_id
LEFT JOIN JAFFLE_SHOP.RAW.raw_products as rp
ON ri.sku=rp.sku
LEFT JOIN JAFFLE_SHOP.RAW.raw_stores as rs
ON ro.store_id=rs.id
  );
[0m02:41:01.779074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:41:02.743909 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:41:02.748774 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 02:41:00.951478 => 02:41:02.747775
[0m02:41:02.749773 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_products: Close
[0m02:41:03.297722 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79F5FEE0>]}
[0m02:41:03.298601 [info ] [Thread-2  ]: 3 of 11 OK created sql view model INTERMEDIATE.stg_products .................... [[32mSUCCESS 1[0m in 2.35s]
[0m02:41:03.299696 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m02:41:03.300855 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m02:41:03.301858 [info ] [Thread-2  ]: 5 of 11 START sql view model INTERMEDIATE.stg_stores ........................... [RUN]
[0m02:41:03.303265 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_stores)
[0m02:41:03.304276 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m02:41:03.306368 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m02:41:03.306368 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 02:41:03.305339 => 02:41:03.306368
[0m02:41:03.310746 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m02:41:03.314789 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_stores"
[0m02:41:03.316840 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_stores"
[0m02:41:03.317546 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_stores"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_stores
  
   as (
    SELECT
ID as store_id,
NAME As store_name,
tax_rate,
CAST(opened_at as DATE) As opened_at,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_stores
  );
[0m02:41:03.318547 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:41:03.534974 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:41:03.543762 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (execute): 02:41:01.772356 => 02:41:03.543762
[0m02:41:03.543762 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_salesorders: Close
[0m02:41:04.103937 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79F62580>]}
[0m02:41:04.105017 [info ] [Thread-1  ]: 4 of 11 OK created sql view model INTERMEDIATE.stg_salesorders ................. [[32mSUCCESS 1[0m in 2.34s]
[0m02:41:04.107481 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_salesorders
[0m02:41:04.107481 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m02:41:04.109438 [info ] [Thread-1  ]: 6 of 11 START sql view model INTERMEDIATE.stg_supplies ......................... [RUN]
[0m02:41:04.110853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_salesorders, now model.dbt_jaffle_shop.stg_supplies)
[0m02:41:04.112604 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m02:41:04.210498 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:41:04.212498 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 02:41:04.113710 => 02:41:04.211500
[0m02:41:04.213497 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m02:41:04.219901 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_supplies"
[0m02:41:04.222987 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_supplies"
[0m02:41:04.224807 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_supplies"} */
create or replace   view JAFFLE_SHOP.INTERMEDIATE.stg_supplies
  
   as (
    SELECT
ID As supplies_id,
sku As product_id,
cost,
name As supplies_name,
perishable,
_AIRBYTE_EXTRACTED_AT
FROM JAFFLE_SHOP.RAW.raw_supplies
  );
[0m02:41:04.225676 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:41:05.077396 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:41:05.077396 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 02:41:03.311408 => 02:41:05.077396
[0m02:41:05.082109 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.stg_stores: Close
[0m02:41:05.612673 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79FFECA0>]}
[0m02:41:05.612673 [info ] [Thread-2  ]: 5 of 11 OK created sql view model INTERMEDIATE.stg_stores ...................... [[32mSUCCESS 1[0m in 2.31s]
[0m02:41:05.619638 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m02:41:05.620637 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m02:41:05.622624 [info ] [Thread-2  ]: 7 of 11 START sql table model CORE.dim_customers ............................... [RUN]
[0m02:41:05.625200 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.dim_customers)
[0m02:41:05.626736 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m02:41:05.648760 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m02:41:05.653875 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 02:41:05.627960 => 02:41:05.653121
[0m02:41:05.654872 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m02:41:05.669678 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_customers"
[0m02:41:05.679776 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_customers"
[0m02:41:05.680736 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_customers"} */
create or replace  table JAFFLE_SHOP.CORE.dim_customers
         as
        (SELECT 
md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_customers
        );
[0m02:41:05.681454 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:41:06.064711 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m02:41:06.081158 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 02:41:04.214624 => 02:41:06.081158
[0m02:41:06.081694 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_supplies: Close
[0m02:41:06.616048 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79FBF2B0>]}
[0m02:41:06.616048 [info ] [Thread-1  ]: 6 of 11 OK created sql view model INTERMEDIATE.stg_supplies .................... [[32mSUCCESS 1[0m in 2.51s]
[0m02:41:06.623347 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m02:41:06.624164 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m02:41:06.625183 [info ] [Thread-1  ]: 8 of 11 START sql table model CORE.dim_date .................................... [RUN]
[0m02:41:06.626165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_date)
[0m02:41:06.638864 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m02:41:06.644091 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m02:41:06.646392 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 02:41:06.640214 => 02:41:06.646147
[0m02:41:06.647145 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m02:41:06.651751 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_date"
[0m02:41:06.652987 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_date"
[0m02:41:06.654001 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_date"} */
create or replace  table JAFFLE_SHOP.CORE.dim_date
         as
        (SELECT
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2), SUBSTR(DATE_DAY, 9, 2)) AS INTEGER) As date_key,
TRY_CAST(CONCAT(LEFT(DATE_DAY, 4), SUBSTR(DATE_DAY, 6, 2)) AS INTEGER) As month_key,
*
FROM JAFFLE_SHOP.RAW.dates
        );
[0m02:41:06.655009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:41:08.653747 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:41:08.656756 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 02:41:05.655881 => 02:41:08.656756
[0m02:41:08.657921 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_customers: Close
[0m02:41:09.205842 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79E54A60>]}
[0m02:41:09.205842 [info ] [Thread-2  ]: 7 of 11 OK created sql table model CORE.dim_customers .......................... [[32mSUCCESS 1[0m in 3.58s]
[0m02:41:09.221249 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m02:41:09.221249 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m02:41:09.222715 [info ] [Thread-2  ]: 9 of 11 START sql table model CORE.dim_products ................................ [RUN]
[0m02:41:09.224742 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.dim_products)
[0m02:41:09.226350 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m02:41:09.232550 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m02:41:09.233547 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 02:41:09.227377 => 02:41:09.233547
[0m02:41:09.234567 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m02:41:09.240651 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_products"
[0m02:41:09.242069 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_products"
[0m02:41:09.243058 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_products"} */
create or replace  table JAFFLE_SHOP.CORE.dim_products
         as
        (SELECT 
md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_products
        );
[0m02:41:09.244054 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:41:09.590932 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:41:09.594105 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 02:41:06.648127 => 02:41:09.594105
[0m02:41:09.595197 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dim_date: Close
[0m02:41:10.128110 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79FBF2B0>]}
[0m02:41:10.128110 [info ] [Thread-1  ]: 8 of 11 OK created sql table model CORE.dim_date ............................... [[32mSUCCESS 1[0m in 3.50s]
[0m02:41:10.142065 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m02:41:10.142795 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m02:41:10.143793 [info ] [Thread-1  ]: 10 of 11 START sql table model CORE.fact_orders ................................ [RUN]
[0m02:41:10.146455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_date, now model.dbt_jaffle_shop.fact_orders)
[0m02:41:10.146839 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m02:41:10.155508 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m02:41:10.156737 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 02:41:10.147846 => 02:41:10.156737
[0m02:41:10.157511 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m02:41:10.161500 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.fact_orders"
[0m02:41:10.163489 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.fact_orders"
[0m02:41:10.164509 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.fact_orders"} */
create or replace  table JAFFLE_SHOP.CORE.fact_orders
         as
        (SELECT
    md5(cast(coalesce(cast(orders.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(orders.item_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as orders_key,
    md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_key,
    md5(cast(coalesce(cast(product_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as product_key,
    md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
    TRY_CAST(CONCAT(LEFT(ordered_date, 4), SUBSTR(ordered_date, 6, 2), SUBSTR(ordered_date, 9, 2)) As INTEGER) As date_key,
    TRY_CAST(CONCAT(LEFT(ordered_date, 4), SUBSTR(ordered_date, 6, 2)) As INTEGER) As month_key, -- New change
    orders.order_id as salesorderid,
    item_id as salesitemid,
    subtotal,
    tax_paid,
    order_total,
    ordered_date
from JAFFLE_SHOP.INTERMEDIATE.stg_salesorders as orders
        );
[0m02:41:10.165489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m02:41:12.842347 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.0 seconds
[0m02:41:12.845266 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 02:41:09.235058 => 02:41:12.845266
[0m02:41:12.845754 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_products: Close
[0m02:41:13.410753 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79FD2490>]}
[0m02:41:13.412216 [info ] [Thread-2  ]: 9 of 11 OK created sql table model CORE.dim_products ........................... [[32mSUCCESS 1[0m in 4.19s]
[0m02:41:13.413907 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m02:41:13.415007 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m02:41:13.416644 [info ] [Thread-2  ]: 11 of 11 START sql table model CORE.dim_stores ................................. [RUN]
[0m02:41:13.418776 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_products, now model.dbt_jaffle_shop.dim_stores)
[0m02:41:13.419904 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m02:41:13.426909 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m02:41:13.428565 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 02:41:13.420451 => 02:41:13.428565
[0m02:41:13.429477 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m02:41:13.436993 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.dim_stores"
[0m02:41:13.438677 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.dim_stores"
[0m02:41:13.439785 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_stores: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dim_stores"} */
create or replace  table JAFFLE_SHOP.CORE.dim_stores
         as
        (SELECT 
md5(cast(coalesce(cast(store_id as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as store_key,
*
FROM JAFFLE_SHOP.INTERMEDIATE.stg_stores
        );
[0m02:41:13.440894 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m02:41:16.022402 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m02:41:16.026695 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 02:41:13.430697 => 02:41:16.026151
[0m02:41:16.027258 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.dim_stores: Close
[0m02:41:16.602425 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79FD2490>]}
[0m02:41:16.603436 [info ] [Thread-2  ]: 11 of 11 OK created sql table model CORE.dim_stores ............................ [[32mSUCCESS 1[0m in 3.18s]
[0m02:41:16.604439 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m02:41:21.582490 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 11.0 seconds
[0m02:41:21.582490 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 02:41:10.157511 => 02:41:21.582490
[0m02:41:21.582490 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.fact_orders: Close
[0m02:41:22.172152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '891761e5-939c-4261-99a1-aa303caa3dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79F54FA0>]}
[0m02:41:22.173158 [info ] [Thread-1  ]: 10 of 11 OK created sql table model CORE.fact_orders ........................... [[32mSUCCESS 1[0m in 12.03s]
[0m02:41:22.180954 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m02:41:22.183843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:41:22.184654 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:41:22.185842 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m02:41:22.186649 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m02:41:22.186726 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m02:41:22.187596 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.fact_orders' was properly closed.
[0m02:41:22.188561 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_stores' was properly closed.
[0m02:41:22.189673 [info ] [MainThread]: 
[0m02:41:22.190808 [info ] [MainThread]: Finished running 6 view models, 5 table models in 0 hours 0 minutes and 33.96 seconds (33.96s).
[0m02:41:22.193698 [debug] [MainThread]: Command end result
[0m02:41:22.207943 [info ] [MainThread]: 
[0m02:41:22.210415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:41:22.211636 [info ] [MainThread]: 
[0m02:41:22.213739 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m02:41:22.215724 [debug] [MainThread]: Command `dbt run` succeeded at 02:41:22.215724 after 35.65 seconds
[0m02:41:22.216705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B55F4F820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79D76310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B79700A00>]}
[0m02:41:22.217514 [debug] [MainThread]: Flushing usage events
[0m00:43:28.524392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A110CCEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A13915A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A13915B50>]}


============================== 00:43:28.532375 | 557c0966-210d-40f0-8404-e2a45ea4ab77 ==============================
[0m00:43:28.532375 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:43:28.535575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:43:28.536579 [info ] [MainThread]: dbt version: 1.7.11
[0m00:43:28.539593 [info ] [MainThread]: python version: 3.9.13
[0m00:43:28.541574 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m00:43:28.543577 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m00:43:35.222049 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m00:43:35.223035 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m00:43:35.225048 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Data Engineering\First DE Project\MDS-for-Quality-Pipelines\dbt_jaffle_shop\dbt_project.yml
[0m00:43:35.228032 [info ] [MainThread]: adapter type: snowflake
[0m00:43:35.230036 [info ] [MainThread]: adapter version: 1.7.3
[0m00:43:35.331307 [info ] [MainThread]: Configuration:
[0m00:43:35.332305 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:43:35.334313 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:43:35.335315 [info ] [MainThread]: Required dependencies:
[0m00:43:35.337306 [debug] [MainThread]: Executing "git --help"
[0m00:43:35.367502 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:43:35.368501 [debug] [MainThread]: STDERR: "b''"
[0m00:43:35.369880 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:43:35.372520 [info ] [MainThread]: Connection:
[0m00:43:35.373496 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m00:43:35.374514 [info ] [MainThread]:   user: AIRBYTE014
[0m00:43:35.376508 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m00:43:35.378512 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m00:43:35.380500 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m00:43:35.382506 [info ] [MainThread]:   schema: RAW
[0m00:43:35.383519 [info ] [MainThread]:   authenticator: None
[0m00:43:35.385518 [info ] [MainThread]:   oauth_client_id: None
[0m00:43:35.387508 [info ] [MainThread]:   query_tag: None
[0m00:43:35.389497 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:43:35.390795 [info ] [MainThread]:   host: None
[0m00:43:35.392499 [info ] [MainThread]:   port: None
[0m00:43:35.394504 [info ] [MainThread]:   proxy_host: None
[0m00:43:35.396508 [info ] [MainThread]:   proxy_port: None
[0m00:43:35.397432 [info ] [MainThread]:   protocol: None
[0m00:43:35.399467 [info ] [MainThread]:   connect_retries: 1
[0m00:43:35.401458 [info ] [MainThread]:   connect_timeout: None
[0m00:43:35.403450 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:43:35.406449 [info ] [MainThread]:   retry_all: False
[0m00:43:35.408450 [info ] [MainThread]:   insecure_mode: False
[0m00:43:35.410449 [info ] [MainThread]:   reuse_connections: None
[0m00:43:35.411457 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:43:35.414450 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:43:35.416445 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:43:35.417820 [debug] [MainThread]: On debug: select 1 as id
[0m00:43:35.418948 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:43:39.101931 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m00:43:39.102930 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m00:43:39.103930 [debug] [MainThread]: On debug: No close available on handle
[0m00:43:39.104922 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:43:39.106923 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:43:39.108915 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ynb38656.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:43:39.112936 [debug] [MainThread]: Command `dbt debug` failed at 00:43:39.111922 after 10.69 seconds
[0m00:43:39.114919 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:43:39.116071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A110CCEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A0CF23C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A347B4700>]}
[0m00:43:39.117918 [debug] [MainThread]: Flushing usage events
[0m00:44:09.954772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D7ECEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D130031F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12C6B97F0>]}


============================== 00:44:09.960890 | 59bbe4e6-54a3-46ab-a267-193092faa473 ==============================
[0m00:44:09.960890 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:44:09.963086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --vars pass_: password1234', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:44:09.964761 [info ] [MainThread]: dbt version: 1.7.11
[0m00:44:09.966768 [info ] [MainThread]: python version: 3.9.13
[0m00:44:09.968765 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m00:44:09.970756 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m00:44:11.075081 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m00:44:11.077091 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m00:44:11.079081 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Data Engineering\First DE Project\MDS-for-Quality-Pipelines\dbt_jaffle_shop\dbt_project.yml
[0m00:44:11.083394 [info ] [MainThread]: adapter type: snowflake
[0m00:44:11.085138 [info ] [MainThread]: adapter version: 1.7.3
[0m00:44:11.229811 [info ] [MainThread]: Configuration:
[0m00:44:11.230947 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:44:11.232967 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:44:11.234047 [info ] [MainThread]: Required dependencies:
[0m00:44:11.235968 [debug] [MainThread]: Executing "git --help"
[0m00:44:11.262782 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:44:11.263768 [debug] [MainThread]: STDERR: "b''"
[0m00:44:11.264762 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:44:11.267764 [info ] [MainThread]: Connection:
[0m00:44:11.269765 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m00:44:11.271760 [info ] [MainThread]:   user: AIRBYTE014
[0m00:44:11.273761 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m00:44:11.275761 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m00:44:11.277758 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m00:44:11.279763 [info ] [MainThread]:   schema: RAW
[0m00:44:11.281765 [info ] [MainThread]:   authenticator: None
[0m00:44:11.283765 [info ] [MainThread]:   oauth_client_id: None
[0m00:44:11.286761 [info ] [MainThread]:   query_tag: None
[0m00:44:11.287775 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:44:11.289760 [info ] [MainThread]:   host: None
[0m00:44:11.290756 [info ] [MainThread]:   port: None
[0m00:44:11.292758 [info ] [MainThread]:   proxy_host: None
[0m00:44:11.294764 [info ] [MainThread]:   proxy_port: None
[0m00:44:11.295761 [info ] [MainThread]:   protocol: None
[0m00:44:11.296761 [info ] [MainThread]:   connect_retries: 1
[0m00:44:11.298760 [info ] [MainThread]:   connect_timeout: None
[0m00:44:11.299765 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:44:11.301770 [info ] [MainThread]:   retry_all: False
[0m00:44:11.303775 [info ] [MainThread]:   insecure_mode: False
[0m00:44:11.305767 [info ] [MainThread]:   reuse_connections: None
[0m00:44:11.307759 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:44:11.308974 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:44:11.310761 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:44:11.311760 [debug] [MainThread]: On debug: select 1 as id
[0m00:44:11.313756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:44:13.073204 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:44:13.075206 [debug] [MainThread]: On debug: Close
[0m00:44:13.642907 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:44:13.644918 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:44:13.647914 [debug] [MainThread]: Command `dbt debug` succeeded at 00:44:13.646912 after 3.76 seconds
[0m00:44:13.648912 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m00:44:13.648912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D12D7ECEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1508E7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D150ECDF10>]}
[0m00:44:13.649910 [debug] [MainThread]: Flushing usage events
[0m00:44:31.188845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042701C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020429848790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020429848250>]}


============================== 00:44:31.194612 | c63050d1-e587-4987-bb9c-d8c8cbd80c87 ==============================
[0m00:44:31.194612 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:44:31.196613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate --vars pass_: password1234', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:44:32.618536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020429848A30>]}
[0m00:44:32.727983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A654520>]}
[0m00:44:32.729990 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m00:44:32.785989 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m00:44:32.880641 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:44:32.882201 [debug] [MainThread]: previous checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, current checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7
[0m00:44:32.883199 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:44:32.885353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A7C5F70>]}
[0m00:44:36.941837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044AAB8F70>]}
[0m00:44:36.947816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044AB81BB0>]}
[0m00:44:36.949146 [info ] [MainThread]: Found 11 models, 11 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m00:44:36.950023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A7C5A90>]}
[0m00:44:36.953061 [info ] [MainThread]: 
[0m00:44:36.956037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:44:36.960030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m00:44:36.966026 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m00:44:36.973342 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m00:44:36.978590 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m00:44:36.980324 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m00:44:36.982319 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m00:44:36.983329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:36.985328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:39.060093 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m00:44:39.064048 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m00:44:39.070424 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m00:44:39.072423 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m00:44:39.633511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m00:44:39.647950 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m00:44:39.648948 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m00:44:39.648948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:41.260389 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m00:44:41.262403 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m00:44:41.806397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63050d1-e587-4987-bb9c-d8c8cbd80c87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A8BCA30>]}
[0m00:44:41.807247 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m00:44:41.809243 [info ] [MainThread]: 
[0m00:44:41.816247 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m00:44:41.817244 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m00:44:41.820253 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m00:44:41.821248 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m00:44:41.823246 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m00:44:41.824256 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m00:44:41.834522 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m00:44:41.840527 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m00:44:41.841821 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m00:44:41.843531 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m00:44:41.845526 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 00:44:41.835724 => 00:44:41.844530
[0m00:44:41.849538 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m00:44:41.850778 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 00:44:41.850778 => 00:44:41.850778
[0m00:44:41.853538 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m00:44:41.854538 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m00:44:41.856524 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_products)
[0m00:44:41.857523 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m00:44:41.864670 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m00:44:41.866487 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 00:44:41.858592 => 00:44:41.866487
[0m00:44:41.868531 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m00:44:41.868531 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 00:44:41.868531 => 00:44:41.868531
[0m00:44:41.870526 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m00:44:41.872006 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_salesorders
[0m00:44:41.873531 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_salesorders)
[0m00:44:41.873531 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_salesorders
[0m00:44:41.878815 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_salesorders"
[0m00:44:41.881808 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (compile): 00:44:41.874528 => 00:44:41.881808
[0m00:44:41.882813 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_salesorders
[0m00:44:41.883810 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (execute): 00:44:41.883810 => 00:44:41.883810
[0m00:44:41.885893 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_salesorders
[0m00:44:41.886809 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m00:44:41.888810 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_salesorders, now model.dbt_jaffle_shop.stg_stores)
[0m00:44:41.889808 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m00:44:41.894951 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m00:44:41.897136 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 00:44:41.890627 => 00:44:41.896961
[0m00:44:41.899269 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m00:44:41.900437 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 00:44:41.900437 => 00:44:41.900437
[0m00:44:41.902263 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m00:44:41.903262 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m00:44:41.905287 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.stg_supplies)
[0m00:44:41.906274 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m00:44:41.910262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m00:44:41.912264 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 00:44:41.906274 => 00:44:41.912264
[0m00:44:41.913575 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m00:44:41.914262 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 00:44:41.914262 => 00:44:41.914262
[0m00:44:41.917276 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m00:44:41.918271 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m00:44:41.920264 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.dim_customers)
[0m00:44:41.921262 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m00:44:41.927262 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m00:44:41.930264 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 00:44:41.922269 => 00:44:41.929717
[0m00:44:41.931261 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m00:44:41.932482 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 00:44:41.931261 => 00:44:41.931261
[0m00:44:41.934265 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m00:44:41.935266 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m00:44:41.936263 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.dim_products)
[0m00:44:41.937469 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m00:44:41.944260 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m00:44:41.947122 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 00:44:41.938260 => 00:44:41.946362
[0m00:44:41.948464 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m00:44:41.949122 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 00:44:41.949122 => 00:44:41.949122
[0m00:44:41.951124 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m00:44:41.952267 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m00:44:41.954124 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_products, now model.dbt_jaffle_shop.fact_orders)
[0m00:44:41.955430 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m00:44:41.964457 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m00:44:41.965990 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 00:44:41.956121 => 00:44:41.965457
[0m00:44:41.966463 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m00:44:41.968456 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 00:44:41.967462 => 00:44:41.967462
[0m00:44:41.969570 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m00:44:41.970454 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m00:44:41.972459 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.fact_orders, now model.dbt_jaffle_shop.dim_stores)
[0m00:44:41.974455 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m00:44:41.980455 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m00:44:41.982453 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 00:44:41.975063 => 00:44:41.981972
[0m00:44:41.984104 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m00:44:41.985110 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 00:44:41.984104 => 00:44:41.984104
[0m00:44:41.987102 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m00:44:41.988191 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m00:44:41.991108 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_stores, now test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411)
[0m00:44:41.992117 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m00:44:42.004120 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m00:44:42.006578 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (compile): 00:44:41.992117 => 00:44:42.006060
[0m00:44:42.007450 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m00:44:42.008448 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (execute): 00:44:42.008135 => 00:44:42.008135
[0m00:44:42.009445 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m00:44:42.010813 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m00:44:42.011443 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e)
[0m00:44:42.012444 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m00:44:42.021440 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m00:44:42.024494 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (compile): 00:44:42.013742 => 00:44:42.024444
[0m00:44:42.025439 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m00:44:42.026690 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (execute): 00:44:42.026690 => 00:44:42.026690
[0m00:44:42.028450 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m00:44:42.029707 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m00:44:42.031452 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e, now test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a)
[0m00:44:42.031452 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m00:44:42.037444 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m00:44:42.039443 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (compile): 00:44:42.032531 => 00:44:42.038451
[0m00:44:42.040462 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m00:44:42.041581 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (execute): 00:44:42.041525 => 00:44:42.041581
[0m00:44:42.043447 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m00:44:42.044520 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m00:44:42.046193 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a, now test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652)
[0m00:44:42.047069 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m00:44:42.053055 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m00:44:42.056067 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (compile): 00:44:42.048444 => 00:44:42.055224
[0m00:44:42.057074 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m00:44:42.059063 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (execute): 00:44:42.058061 => 00:44:42.058061
[0m00:44:42.060061 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m00:44:42.061312 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m00:44:42.062188 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652, now test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259)
[0m00:44:42.063086 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m00:44:42.069398 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259"
[0m00:44:42.071371 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259 (compile): 00:44:42.064072 => 00:44:42.071371
[0m00:44:42.072407 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m00:44:42.074402 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259 (execute): 00:44:42.073406 => 00:44:42.073406
[0m00:44:42.075400 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m00:44:42.076998 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m00:44:42.078395 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259, now test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94)
[0m00:44:42.079411 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m00:44:42.086397 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m00:44:42.088523 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (compile): 00:44:42.079788 => 00:44:42.088523
[0m00:44:42.089941 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m00:44:42.090769 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (execute): 00:44:42.090769 => 00:44:42.090769
[0m00:44:42.093397 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m00:44:42.094651 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m00:44:42.096402 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94, now test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36)
[0m00:44:42.097399 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m00:44:42.105396 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m00:44:42.108394 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (compile): 00:44:42.098524 => 00:44:42.108025
[0m00:44:42.109504 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m00:44:42.110396 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (execute): 00:44:42.110333 => 00:44:42.110396
[0m00:44:42.112482 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m00:44:42.113669 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m00:44:42.115665 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36, now test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b)
[0m00:44:42.116816 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m00:44:42.123665 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b"
[0m00:44:42.126664 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b (compile): 00:44:42.117667 => 00:44:42.125664
[0m00:44:42.127959 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m00:44:42.128666 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b (execute): 00:44:42.128666 => 00:44:42.128666
[0m00:44:42.130667 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m00:44:42.132665 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m00:44:42.134676 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b, now test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e)
[0m00:44:42.135676 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m00:44:42.143665 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m00:44:42.145761 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (compile): 00:44:42.137252 => 00:44:42.144670
[0m00:44:42.147296 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m00:44:42.148298 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (execute): 00:44:42.147474 => 00:44:42.147474
[0m00:44:42.150300 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m00:44:42.151297 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m00:44:42.153302 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e, now test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5)
[0m00:44:42.154635 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m00:44:42.162294 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m00:44:42.165297 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (compile): 00:44:42.155300 => 00:44:42.164657
[0m00:44:42.166295 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m00:44:42.168293 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (execute): 00:44:42.167296 => 00:44:42.167296
[0m00:44:42.170300 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m00:44:42.171308 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m00:44:42.173300 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5, now test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53)
[0m00:44:42.174857 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m00:44:42.181295 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m00:44:42.184296 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (compile): 00:44:42.175299 => 00:44:42.183525
[0m00:44:42.186295 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m00:44:42.187305 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (execute): 00:44:42.186295 => 00:44:42.186295
[0m00:44:42.189335 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m00:44:43.738374 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m00:44:43.767773 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m00:44:43.770786 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 00:44:41.825500 => 00:44:43.769775
[0m00:44:43.771841 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m00:44:43.773777 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 00:44:43.772795 => 00:44:43.772795
[0m00:44:43.775104 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m00:44:44.283821 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m00:44:44.285819 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m00:44:44.288823 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53, now model.dbt_jaffle_shop.dim_date)
[0m00:44:44.289820 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m00:44:44.296068 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m00:44:44.298823 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 00:44:44.291093 => 00:44:44.297825
[0m00:44:44.299823 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m00:44:44.301822 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 00:44:44.301822 => 00:44:44.301822
[0m00:44:44.304821 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m00:44:44.306823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:44.307817 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m00:44:44.310162 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m00:44:44.312165 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dates' was properly closed.
[0m00:44:44.313176 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_date' was properly closed.
[0m00:44:44.322163 [debug] [MainThread]: Command end result
[0m00:44:44.586255 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m00:44:44.587048 [info ] [MainThread]: Building catalog
[0m00:44:44.593597 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m00:44:44.611590 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m00:44:44.612587 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "JAFFLE_SHOP.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_products')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_products')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_salesorders')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_date')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_items')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('fact_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dates')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_stores')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_stores')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_stores')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_products')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_products')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_products')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_salesorders')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_date')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_items')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('fact_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dates')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_customers')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_stores')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_stores')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_stores')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_products')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m00:44:44.614587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:49.362433 [debug] [ThreadPool]: SQL status: SUCCESS 177 in 5.0 seconds
[0m00:44:50.549441 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: Close
[0m00:44:51.118118 [info ] [MainThread]: Catalog written to C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Data Engineering\First DE Project\MDS-for-Quality-Pipelines\dbt_jaffle_shop\target\catalog.json
[0m00:44:51.123362 [debug] [MainThread]: Command `dbt docs generate` succeeded at 00:44:51.123362 after 20.00 seconds
[0m00:44:51.125115 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m00:44:51.126492 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was properly closed.
[0m00:44:51.128694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002042701C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020429848A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044A6BA760>]}
[0m00:44:51.130126 [debug] [MainThread]: Flushing usage events
[0m00:45:03.595751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264F862C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264F768D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264FAE5D040>]}


============================== 00:45:03.600749 | 16be7ae4-5cd6-45b3-ae89-f3a4baaa5791 ==============================
[0m00:45:03.600749 [info ] [MainThread]: Running with dbt=1.7.11
[0m00:45:03.602739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --vars pass_: password1234', 'send_anonymous_usage_stats': 'True'}
[0m00:45:04.985595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16be7ae4-5cd6-45b3-ae89-f3a4baaa5791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264F8D40F10>]}
[0m00:45:05.079755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16be7ae4-5cd6-45b3-ae89-f3a4baaa5791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002649BC9F0A0>]}
[0m00:45:45.415438 [error] [MainThread]: Encountered an error:

[0m00:45:45.452028 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
  File "C:\Users\Thinkbook 14\venv\lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\selectors.py", line 324, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
  File "C:\Users\Thinkbook 14\AppData\Local\Programs\Python\Python39\lib\selectors.py", line 315, in _select
    r, w, x = select.select(r, w, w, timeout)
KeyboardInterrupt

[0m00:45:45.461031 [debug] [MainThread]: Command `dbt docs serve` failed at 00:45:45.460035 after 41.93 seconds
[0m00:45:45.464033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264F862C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002649BE09580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002649BE093D0>]}
[0m00:45:45.467268 [debug] [MainThread]: Flushing usage events
[0m01:02:45.592856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AAC2C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AD45B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AD45B160>]}


============================== 01:02:45.598785 | f268faf8-b15d-41ac-ba9d-405cc1753310 ==============================
[0m01:02:45.598785 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:02:45.601790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select source:*', 'send_anonymous_usage_stats': 'True'}
[0m01:02:47.032621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f268faf8-b15d-41ac-ba9d-405cc1753310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200A9AF8BB0>]}
[0m01:02:47.167437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f268faf8-b15d-41ac-ba9d-405cc1753310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CE2446A0>]}
[0m01:02:47.170424 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m01:02:47.195147 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m01:02:47.289668 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:02:47.290668 [debug] [MainThread]: previous checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, current checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba
[0m01:02:47.291904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f268faf8-b15d-41ac-ba9d-405cc1753310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CE397E50>]}
[0m01:02:49.472379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f268faf8-b15d-41ac-ba9d-405cc1753310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CEAF90D0>]}
[0m01:02:49.494725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f268faf8-b15d-41ac-ba9d-405cc1753310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CE468D60>]}
[0m01:02:49.496729 [info ] [MainThread]: Found 11 models, 12 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m01:02:49.497724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f268faf8-b15d-41ac-ba9d-405cc1753310', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CE2CF0A0>]}
[0m01:02:49.501615 [info ] [MainThread]: 
[0m01:02:49.503745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:02:49.509722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m01:02:49.511727 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m01:02:49.526727 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m01:02:49.531751 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m01:02:49.533039 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m01:02:49.533720 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m01:02:49.536109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:49.537939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:52.120267 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m01:02:52.122267 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m01:02:52.123267 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:02:52.125271 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:02:52.126309 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:02:52.128266 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:02:52.130262 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:02:52.131271 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:02:52.133265 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: No close available on handle
[0m01:02:52.135263 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: No close available on handle
[0m01:02:52.138511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m01:02:52.146595 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m01:02:52.147848 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m01:02:52.149527 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:53.480626 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m01:02:53.480626 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:02:53.481805 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m01:02:53.482505 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m01:02:53.483508 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: No close available on handle
[0m01:02:53.484502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:53.485657 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m01:02:53.487524 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m01:02:53.488546 [info ] [MainThread]: 
[0m01:02:53.490502 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m01:02:53.491520 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: ynb38656.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m01:02:53.495069 [debug] [MainThread]: Command `dbt test` failed at 01:02:53.494509 after 8.01 seconds
[0m01:02:53.495802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200AAC2C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CE831970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200CE8316D0>]}
[0m01:02:53.496084 [debug] [MainThread]: Flushing usage events
[0m01:03:13.814219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2543C0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D256BEC2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D25326EFD0>]}


============================== 01:03:13.818990 | 9f1e058b-c805-4d82-9979-e34f8506e59c ==============================
[0m01:03:13.818990 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:03:13.820990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select source:* --vars pass_: password1234', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:03:15.161933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2779C8B20>]}
[0m01:03:15.254243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277A0FB80>]}
[0m01:03:15.257214 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m01:03:15.279429 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m01:03:15.367662 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:03:15.369654 [debug] [MainThread]: previous checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, current checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7
[0m01:03:15.370817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277BF0070>]}
[0m01:03:17.456415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27828B0D0>]}
[0m01:03:17.477749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277BF76D0>]}
[0m01:03:17.478811 [info ] [MainThread]: Found 11 models, 12 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m01:03:17.480753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277FC2B50>]}
[0m01:03:17.482975 [info ] [MainThread]: 
[0m01:03:17.484974 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:03:17.488982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m01:03:17.500970 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m01:03:17.502970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m01:03:17.504307 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m01:03:17.509976 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m01:03:17.510975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:17.511976 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m01:03:17.515985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:19.522886 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m01:03:19.524905 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m01:03:19.557265 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m01:03:19.559266 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m01:03:20.085944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m01:03:20.091602 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m01:03:20.092604 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m01:03:20.093613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:21.700049 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m01:03:21.704825 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m01:03:22.197282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1e058b-c805-4d82-9979-e34f8506e59c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D27828B8E0>]}
[0m01:03:22.198808 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m01:03:22.201807 [info ] [MainThread]: 
[0m01:03:22.206806 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e
[0m01:03:22.208049 [info ] [Thread-1  ]: 1 of 1 START test source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_  [RUN]
[0m01:03:22.210814 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e'
[0m01:03:22.211878 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e
[0m01:03:22.219809 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e"
[0m01:03:22.222817 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e (compile): 01:03:22.212814 => 01:03:22.221932
[0m01:03:22.223809 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e
[0m01:03:22.250103 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e"
[0m01:03:22.253110 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e"
[0m01:03:22.254100 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer as from_field
    from JAFFLE_SHOP.RAW.raw_orders
    where customer is not null
),

parent as (
    select customer as to_field
    from JAFFLE_SHOP.RAW.raw_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:03:22.255101 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:03:23.966668 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4ed23-0105-3cfb-0006-1c670004303e
[0m01:03:23.967202 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 11
invalid identifier 'CUSTOMER'
[0m01:03:23.969541 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e (execute): 01:03:22.224897 => 01:03:23.968750
[0m01:03:23.970235 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e: Close
[0m01:03:24.508570 [debug] [Thread-1  ]: Database Error in test source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_ (models\_jaffle_shop_sources.yml)
  000904 (42000): SQL compilation error: error line 17 at position 11
  invalid identifier 'CUSTOMER'
  compiled Code at target\run\dbt_jaffle_shop\models\_jaffle_shop_sources.yml\source_relationships_jaffle_sh_102f7dc6f2dedf61799afab5c7e27b0f.sql
[0m01:03:24.510556 [error] [Thread-1  ]: 1 of 1 ERROR source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_  [[31mERROR[0m in 2.30s]
[0m01:03:24.513555 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e
[0m01:03:24.516568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:24.517558 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m01:03:24.519121 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m01:03:24.519547 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_.7300e37e7e' was properly closed.
[0m01:03:24.520543 [info ] [MainThread]: 
[0m01:03:24.523747 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 7.04 seconds (7.04s).
[0m01:03:24.527961 [debug] [MainThread]: Command end result
[0m01:03:24.556742 [info ] [MainThread]: 
[0m01:03:24.559846 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:03:24.562752 [info ] [MainThread]: 
[0m01:03:24.565801 [error] [MainThread]:   Database Error in test source_relationships_jaffle_shop_raw_orders_customer__customer__source_jaffle_shop_raw_customers_ (models\_jaffle_shop_sources.yml)
  000904 (42000): SQL compilation error: error line 17 at position 11
  invalid identifier 'CUSTOMER'
  compiled Code at target\run\dbt_jaffle_shop\models\_jaffle_shop_sources.yml\source_relationships_jaffle_sh_102f7dc6f2dedf61799afab5c7e27b0f.sql
[0m01:03:24.569412 [info ] [MainThread]: 
[0m01:03:24.571523 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:03:24.576982 [debug] [MainThread]: Command `dbt test` failed at 01:03:24.575456 after 10.83 seconds
[0m01:03:24.578477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2543C0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277A0FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D277AC8C70>]}
[0m01:03:24.581399 [debug] [MainThread]: Flushing usage events
[0m01:04:34.627779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A790C518E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78FAFF8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78FAFFAC0>]}


============================== 01:04:34.633233 | e272dae2-d7cb-4fe8-89f7-3dafe45a6491 ==============================
[0m01:04:34.633233 [info ] [MainThread]: Running with dbt=1.7.11
[0m01:04:34.634769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select source:* --vars pass_: password1234', 'send_anonymous_usage_stats': 'True'}
[0m01:04:36.005126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e272dae2-d7cb-4fe8-89f7-3dafe45a6491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A793519970>]}
[0m01:04:36.098747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e272dae2-d7cb-4fe8-89f7-3dafe45a6491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4286190>]}
[0m01:04:36.100723 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m01:04:36.120818 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m01:04:36.331778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:36.333774 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\_jaffle_shop_sources.yml
[0m01:04:36.777318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e272dae2-d7cb-4fe8-89f7-3dafe45a6491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4B1EEE0>]}
[0m01:04:36.798080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e272dae2-d7cb-4fe8-89f7-3dafe45a6491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4623760>]}
[0m01:04:36.799595 [info ] [MainThread]: Found 11 models, 12 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m01:04:36.801584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e272dae2-d7cb-4fe8-89f7-3dafe45a6491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4623460>]}
[0m01:04:36.804075 [info ] [MainThread]: 
[0m01:04:36.806340 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:04:36.809945 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m01:04:36.821079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m01:04:36.829789 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m01:04:36.834798 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m01:04:36.836782 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m01:04:36.838137 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m01:04:36.839783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:36.840781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:39.758673 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m01:04:39.760836 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m01:04:39.798968 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 3.0 seconds
[0m01:04:39.801909 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m01:04:40.284996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m01:04:40.291016 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m01:04:40.292281 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m01:04:40.294192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:41.897343 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m01:04:41.899735 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m01:04:42.440845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e272dae2-d7cb-4fe8-89f7-3dafe45a6491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4322070>]}
[0m01:04:42.442840 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m01:04:42.443849 [info ] [MainThread]: 
[0m01:04:42.449840 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m01:04:42.450839 [info ] [Thread-1  ]: 1 of 1 START test source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_  [RUN]
[0m01:04:42.452844 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d'
[0m01:04:42.455053 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m01:04:42.561512 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m01:04:42.563510 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d (compile): 01:04:42.455845 => 01:04:42.563453
[0m01:04:42.564679 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m01:04:42.588825 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m01:04:42.591455 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m01:04:42.592759 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer as from_field
    from JAFFLE_SHOP.RAW.raw_orders
    where customer is not null
),

parent as (
    select id as to_field
    from JAFFLE_SHOP.RAW.raw_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m01:04:42.594470 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m01:04:45.680816 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m01:04:45.688722 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d (execute): 01:04:42.565263 => 01:04:45.687727
[0m01:04:45.689776 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d: Close
[0m01:04:46.221062 [info ] [Thread-1  ]: 1 of 1 PASS source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_  [[32mPASS[0m in 3.77s]
[0m01:04:46.223070 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m01:04:46.227070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:46.228065 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m01:04:46.228701 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m01:04:46.229065 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d' was properly closed.
[0m01:04:46.230063 [info ] [MainThread]: 
[0m01:04:46.232064 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 9.42 seconds (9.42s).
[0m01:04:46.233058 [debug] [MainThread]: Command end result
[0m01:04:46.256143 [info ] [MainThread]: 
[0m01:04:46.258144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:04:46.260200 [info ] [MainThread]: 
[0m01:04:46.262154 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:04:46.266147 [debug] [MainThread]: Command `dbt test` succeeded at 01:04:46.265146 after 11.73 seconds
[0m01:04:46.267147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A790C518E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B4788A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7B49AB040>]}
[0m01:04:46.268144 [debug] [MainThread]: Flushing usage events
[0m09:49:13.828360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E02070430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E010CCA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0489C820>]}


============================== 09:49:13.836849 | 57f953c6-a412-40f7-9d6c-e86a6a07ac6e ==============================
[0m09:49:13.836849 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:49:13.839160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select source:* --vars pass_: password1234', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:49:16.288548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57f953c6-a412-40f7-9d6c-e86a6a07ac6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E00F1EEB0>]}
[0m09:49:16.421664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57f953c6-a412-40f7-9d6c-e86a6a07ac6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2575BE80>]}
[0m09:49:16.427260 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:49:16.480319 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m09:49:16.639328 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_jaffle_shop: _jaffle_shop_sources.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |       - name: raw_items
    14 |       - name: raw_orders
    15 |         columns:
    16 |           - name: `customer`
    17 |             tests:
    18 |               - relationships:
    19 |                   to: source('jaffle_shop', 'raw_customers')
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 16, column 19
[0m09:49:16.644620 [debug] [MainThread]: Command `dbt test` failed at 09:49:16.644620 after 2.93 seconds
[0m09:49:16.646126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E02070430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E259893D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E25989100>]}
[0m09:49:16.648139 [debug] [MainThread]: Flushing usage events
[0m09:49:16.658170 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m09:49:57.478399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A09CF9C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A09BFFC9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A09BE4ECA0>]}


============================== 09:49:57.485062 | 5ea04430-af1f-4469-b36f-a0a94da0b437 ==============================
[0m09:49:57.485062 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:49:57.487635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select source:* --vars pass_: password1234', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:50:00.295057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea04430-af1f-4469-b36f-a0a94da0b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A09BE6EB50>]}
[0m09:50:00.628543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea04430-af1f-4469-b36f-a0a94da0b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C05D4910>]}
[0m09:50:00.633948 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m09:50:00.699122 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m09:50:01.586535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:50:01.592797 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\_jaffle_shop_sources.yml
[0m09:50:01.726022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea04430-af1f-4469-b36f-a0a94da0b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C0AF30D0>]}
[0m09:50:01.783561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea04430-af1f-4469-b36f-a0a94da0b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C0973790>]}
[0m09:50:01.786700 [info ] [MainThread]: Found 11 models, 12 tests, 6 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m09:50:01.791184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea04430-af1f-4469-b36f-a0a94da0b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C0973550>]}
[0m09:50:01.797591 [info ] [MainThread]: 
[0m09:50:01.803524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:50:01.813414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m09:50:01.819418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m09:50:01.934909 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m09:50:01.942926 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m09:50:01.944925 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m09:50:01.947931 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m09:50:01.949927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:01.951924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:24.862665 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 23.0 seconds
[0m09:50:24.866962 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 23.0 seconds
[0m09:50:24.874487 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m09:50:24.884913 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m09:50:25.628288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_CORE)
[0m09:50:25.654459 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m09:50:25.663382 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m09:50:25.665836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:28.411685 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.0 seconds
[0m09:50:28.418118 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m09:50:29.602166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea04430-af1f-4469-b36f-a0a94da0b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C0973670>]}
[0m09:50:29.604827 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m09:50:29.610533 [info ] [MainThread]: 
[0m09:50:29.630421 [debug] [Thread-1  ]: Began running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m09:50:29.633295 [info ] [Thread-1  ]: 1 of 1 START test source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_  [RUN]
[0m09:50:29.649349 [debug] [Thread-1  ]: Acquiring new snowflake connection 'test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d'
[0m09:50:29.658372 [debug] [Thread-1  ]: Began compiling node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m09:50:29.708745 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m09:50:29.717580 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d (compile): 09:50:29.661000 => 09:50:29.717580
[0m09:50:29.722096 [debug] [Thread-1  ]: Began executing node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m09:50:29.787459 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m09:50:29.794364 [debug] [Thread-1  ]: Using snowflake connection "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m09:50:29.796816 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer as from_field
    from JAFFLE_SHOP.RAW.raw_orders
    where customer is not null
),

parent as (
    select id as to_field
    from JAFFLE_SHOP.RAW.raw_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:50:29.799366 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:50:32.173695 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:50:32.191670 [debug] [Thread-1  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d (execute): 09:50:29.725415 => 09:50:32.191670
[0m09:50:32.195855 [debug] [Thread-1  ]: On test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d: Close
[0m09:50:32.790058 [info ] [Thread-1  ]: 1 of 1 PASS source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_  [[32mPASS[0m in 3.15s]
[0m09:50:32.797307 [debug] [Thread-1  ]: Finished running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m09:50:32.803568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:50:32.806097 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m09:50:32.809853 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m09:50:32.812560 [debug] [MainThread]: Connection 'test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d' was properly closed.
[0m09:50:32.815650 [info ] [MainThread]: 
[0m09:50:32.820248 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 31.01 seconds (31.01s).
[0m09:50:32.824982 [debug] [MainThread]: Command end result
[0m09:50:32.875423 [info ] [MainThread]: 
[0m09:50:32.879032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:50:32.883647 [info ] [MainThread]: 
[0m09:50:32.887456 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:50:32.894775 [debug] [MainThread]: Command `dbt test` succeeded at 09:50:32.894201 after 35.50 seconds
[0m09:50:32.897122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A09CF9C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C05D4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0C0AEB490>]}
[0m09:50:32.900740 [debug] [MainThread]: Flushing usage events
[0m15:55:05.144956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001905752CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019059D713D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190563F94F0>]}


============================== 15:55:05.151815 | 311dfeba-1886-4665-a010-2dbbed04dbd8 ==============================
[0m15:55:05.151815 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:55:05.154893 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug --vars pass_: password1234', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:55:05.155882 [info ] [MainThread]: dbt version: 1.7.11
[0m15:55:05.157884 [info ] [MainThread]: python version: 3.9.13
[0m15:55:05.159881 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m15:55:05.163063 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m15:55:11.729046 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m15:55:11.734738 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m15:55:11.736719 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Data Engineering\First DE Project\MDS-for-Quality-Pipelines\dbt_jaffle_shop\dbt_project.yml
[0m15:55:11.740102 [info ] [MainThread]: adapter type: snowflake
[0m15:55:11.742296 [info ] [MainThread]: adapter version: 1.7.3
[0m15:55:11.841085 [info ] [MainThread]: Configuration:
[0m15:55:11.842437 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:55:11.844395 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:55:11.845385 [info ] [MainThread]: Required dependencies:
[0m15:55:11.848119 [debug] [MainThread]: Executing "git --help"
[0m15:55:11.878547 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:55:11.880537 [debug] [MainThread]: STDERR: "b''"
[0m15:55:11.882718 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:55:11.885619 [info ] [MainThread]: Connection:
[0m15:55:11.888528 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m15:55:11.890770 [info ] [MainThread]:   user: AIRBYTE014
[0m15:55:11.894043 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m15:55:11.897303 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m15:55:11.900399 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m15:55:11.902117 [info ] [MainThread]:   schema: RAW
[0m15:55:11.905373 [info ] [MainThread]:   authenticator: None
[0m15:55:11.906987 [info ] [MainThread]:   oauth_client_id: None
[0m15:55:11.910014 [info ] [MainThread]:   query_tag: None
[0m15:55:11.912229 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:55:11.915012 [info ] [MainThread]:   host: None
[0m15:55:11.918393 [info ] [MainThread]:   port: None
[0m15:55:11.921415 [info ] [MainThread]:   proxy_host: None
[0m15:55:11.923316 [info ] [MainThread]:   proxy_port: None
[0m15:55:11.927337 [info ] [MainThread]:   protocol: None
[0m15:55:11.929317 [info ] [MainThread]:   connect_retries: 1
[0m15:55:11.932318 [info ] [MainThread]:   connect_timeout: None
[0m15:55:11.934306 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:55:11.935613 [info ] [MainThread]:   retry_all: False
[0m15:55:11.937729 [info ] [MainThread]:   insecure_mode: False
[0m15:55:11.940177 [info ] [MainThread]:   reuse_connections: None
[0m15:55:11.942792 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:55:11.945857 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:55:11.948399 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:55:11.949737 [debug] [MainThread]: On debug: select 1 as id
[0m15:55:11.950745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:15.926752 [debug] [MainThread]: SQL status: SUCCESS 1 in 4.0 seconds
[0m15:55:15.928947 [debug] [MainThread]: On debug: Close
[0m15:55:16.417900 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:55:16.421473 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:55:16.424594 [debug] [MainThread]: Command `dbt debug` succeeded at 15:55:16.423583 after 11.40 seconds
[0m15:55:16.425636 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:55:16.427187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001905752CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019057C1C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001907AC42BE0>]}
[0m15:55:16.428271 [debug] [MainThread]: Flushing usage events
[0m15:55:59.358988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DB310880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DA1BE3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DA1BE8B0>]}


============================== 15:55:59.365883 | abd1c8ba-91bc-45cd-8fd1-bf44e7931ece ==============================
[0m15:55:59.365883 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:55:59.369124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:01.225917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abd1c8ba-91bc-45cd-8fd1-bf44e7931ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DBA20F10>]}
[0m15:56:01.335937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abd1c8ba-91bc-45cd-8fd1-bf44e7931ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199FEB292E0>]}
[0m15:56:01.337947 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:56:01.394559 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:56:01.501120 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:56:01.503051 [debug] [MainThread]: previous checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, current checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba
[0m15:56:01.504038 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:56:01.505792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'abd1c8ba-91bc-45cd-8fd1-bf44e7931ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199FEB4AEB0>]}
[0m15:56:05.783343 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_jaffle_shop.tf_requests_approvals' (models\Flex\tf_requests_approvals.sql) depends on a node named 'app_data_events' which was not found
[0m15:56:05.787045 [debug] [MainThread]: Command `dbt run` failed at 15:56:05.787045 after 6.51 seconds
[0m15:56:05.789038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DB310880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199FEF88A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199FEF88070>]}
[0m15:56:05.791047 [debug] [MainThread]: Flushing usage events
[0m15:58:00.819066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CF6928E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CE53EBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CE53E8B0>]}


============================== 15:58:00.823359 | 2b515318-e555-4f5c-be35-8532affbcec7 ==============================
[0m15:58:00.823359 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:58:00.826623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:02.076501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b515318-e555-4f5c-be35-8532affbcec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CE55D430>]}
[0m15:58:02.201394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b515318-e555-4f5c-be35-8532affbcec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CE53E9D0>]}
[0m15:58:02.205396 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:58:02.236019 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:58:02.338118 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:58:02.339863 [debug] [MainThread]: previous checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, current checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba
[0m15:58:02.340465 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:58:02.342551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b515318-e555-4f5c-be35-8532affbcec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F2DED640>]}
[0m15:58:04.639493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b515318-e555-4f5c-be35-8532affbcec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F358C0D0>]}
[0m15:58:04.662472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b515318-e555-4f5c-be35-8532affbcec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F2ECBB20>]}
[0m15:58:04.664463 [info ] [MainThread]: Found 12 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m15:58:04.666712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b515318-e555-4f5c-be35-8532affbcec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F32F09D0>]}
[0m15:58:04.670091 [info ] [MainThread]: 
[0m15:58:04.672807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:04.676827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m15:58:04.689644 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m15:58:04.690649 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m15:58:04.692629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:07.467570 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m15:58:07.469524 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:58:07.470697 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:58:07.472704 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:58:07.474728 [debug] [ThreadPool]: On list_orbit_mds_dev: No close available on handle
[0m15:58:07.477714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:07.479799 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m15:58:07.482504 [info ] [MainThread]: 
[0m15:58:07.485528 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m15:58:07.488515 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "orbit_mds_dev"
  Database Error
    250001 (08001): Failed to connect to DB: ynb38656.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m15:58:07.494800 [debug] [MainThread]: Command `dbt run` failed at 15:58:07.494031 after 6.75 seconds
[0m15:58:07.496014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233CF6928E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F2D9DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233F35E9C40>]}
[0m15:58:07.498017 [debug] [MainThread]: Flushing usage events
[0m15:58:26.227455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017034E66820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017037662220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017037662400>]}


============================== 15:58:26.232366 | 430ffac5-e71d-417a-8696-59e3fa785f04 ==============================
[0m15:58:26.232366 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:58:26.235290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:58:27.690499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '430ffac5-e71d-417a-8696-59e3fa785f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017037662A00>]}
[0m15:58:27.776624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '430ffac5-e71d-417a-8696-59e3fa785f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017058538160>]}
[0m15:58:27.780631 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:58:27.801548 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m15:58:27.892764 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:58:27.897611 [debug] [MainThread]: previous checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, current checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7
[0m15:58:27.898971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '430ffac5-e71d-417a-8696-59e3fa785f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017058561F70>]}
[0m15:58:30.175562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '430ffac5-e71d-417a-8696-59e3fa785f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017058D0D0D0>]}
[0m15:58:30.199780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430ffac5-e71d-417a-8696-59e3fa785f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017058692550>]}
[0m15:58:30.201435 [info ] [MainThread]: Found 12 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m15:58:30.202436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430ffac5-e71d-417a-8696-59e3fa785f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170588ACD00>]}
[0m15:58:30.207436 [info ] [MainThread]: 
[0m15:58:30.210234 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:30.213445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m15:58:30.227097 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m15:58:30.228184 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m15:58:30.229075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:33.392941 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m15:58:33.392941 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m15:58:33.876423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev, now create_orbit_mds_dev_public)
[0m15:58:33.877452 [debug] [ThreadPool]: Creating schema "database: "orbit_mds_dev"
schema: "public"
"
[0m15:58:33.881623 [debug] [ThreadPool]: Using snowflake connection "create_orbit_mds_dev_public"
[0m15:58:33.881623 [debug] [ThreadPool]: On create_orbit_mds_dev_public: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "create_orbit_mds_dev_public"} */
create schema if not exists orbit_mds_dev.public
[0m15:58:33.881623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:35.592710 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b4f642-0105-3f1a-0006-1c670004400e
[0m15:58:35.592710 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m15:58:35.595022 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m15:58:35.596031 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:58:35.598314 [debug] [ThreadPool]: On create_orbit_mds_dev_public: Close
[0m15:58:36.061599 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:36.062600 [debug] [MainThread]: Connection 'create_orbit_mds_dev_public' was properly closed.
[0m15:58:36.064890 [info ] [MainThread]: 
[0m15:58:36.066891 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.86 seconds (5.86s).
[0m15:58:36.068893 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m15:58:36.072893 [debug] [MainThread]: Command `dbt run` failed at 15:58:36.072893 after 9.92 seconds
[0m15:58:36.074885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017034E66820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017058A4FB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017058D8B220>]}
[0m15:58:36.074885 [debug] [MainThread]: Flushing usage events
[0m15:59:18.902918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A2A76820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A5272220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A5272400>]}


============================== 15:59:18.908916 | e90f1228-e46c-4114-82b9-7d36899d108f ==============================
[0m15:59:18.908916 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:59:18.911921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:20.339920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A5272A00>]}
[0m15:59:20.435937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C614E160>]}
[0m15:59:20.438924 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:59:20.462923 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m15:59:20.559924 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:59:20.562931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C6171F70>]}
[0m15:59:22.793989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C691A0D0>]}
[0m15:59:22.819702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C62A2550>]}
[0m15:59:22.820702 [info ] [MainThread]: Found 12 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m15:59:22.822705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C64BCD00>]}
[0m15:59:22.826691 [info ] [MainThread]: 
[0m15:59:22.829347 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:22.834038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m15:59:22.848504 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m15:59:22.849636 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m15:59:22.851030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:25.514119 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m15:59:25.517082 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m15:59:25.998420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m15:59:26.001435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m15:59:26.005639 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m15:59:26.019269 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m15:59:26.021274 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m15:59:26.022280 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m15:59:26.023290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:26.024500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:27.698012 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m15:59:27.698012 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m15:59:27.739373 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m15:59:27.741370 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m15:59:28.172882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m15:59:28.179012 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m15:59:28.190142 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m15:59:28.193143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:28.195800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m15:59:28.205651 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m15:59:28.207259 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m15:59:28.209264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:29.848486 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:59:29.850876 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m15:59:29.925251 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:59:29.928157 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m15:59:30.430891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C691A280>]}
[0m15:59:30.432090 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m15:59:30.434078 [info ] [MainThread]: 
[0m15:59:30.441940 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:59:30.442929 [info ] [Thread-1  ]: 1 of 1 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m15:59:30.446610 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m15:59:30.448417 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:59:30.456984 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m15:59:30.460469 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 15:59:30.449867 => 15:59:30.459543
[0m15:59:30.461545 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:59:30.520805 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m15:59:30.524990 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m15:59:30.525984 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  table orbit_mds_dev.core.tf_requests_approvals
         as
        (

with windowed_requests_approval (
    select
        max(created_at) OVER (PARTITION BY REQUEST_ID) final_date,
        min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
        first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
        last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
        first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
        last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
        *
    from orbit_mds_dev.public.requests_approvals
    
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval

        );
[0m15:59:30.525984 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:59:32.121439 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f643-0105-3ee8-0006-1c670004c012
[0m15:59:32.121439 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 4 unexpected 'select'.
syntax error line 7 at position 24 unexpected 'OVER'.
syntax error line 7 at position 55 unexpected 'final_date'.
[0m15:59:32.130682 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 15:59:30.461545 => 15:59:32.130682
[0m15:59:32.132466 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m15:59:32.626127 [debug] [Thread-1  ]: Database Error in model tf_requests_approvals (models\Flex\tf_requests_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'select'.
  syntax error line 7 at position 24 unexpected 'OVER'.
  syntax error line 7 at position 55 unexpected 'final_date'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\tf_requests_approvals.sql
[0m15:59:32.626127 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90f1228-e46c-4114-82b9-7d36899d108f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C699EAF0>]}
[0m15:59:32.635789 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[31mERROR[0m in 2.18s]
[0m15:59:32.638023 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:59:32.641029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:32.641029 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m15:59:32.642990 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m15:59:32.643978 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m15:59:32.644988 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m15:59:32.646990 [info ] [MainThread]: 
[0m15:59:32.648963 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.82 seconds (9.82s).
[0m15:59:32.650881 [debug] [MainThread]: Command end result
[0m15:59:32.674270 [info ] [MainThread]: 
[0m15:59:32.676263 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:59:32.678526 [info ] [MainThread]: 
[0m15:59:32.680784 [error] [MainThread]:   Database Error in model tf_requests_approvals (models\Flex\tf_requests_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'select'.
  syntax error line 7 at position 24 unexpected 'OVER'.
  syntax error line 7 at position 55 unexpected 'final_date'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\tf_requests_approvals.sql
[0m15:59:32.683212 [info ] [MainThread]: 
[0m15:59:32.684942 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:59:32.689946 [debug] [MainThread]: Command `dbt run` failed at 15:59:32.688975 after 13.86 seconds
[0m15:59:32.690938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237A2A76820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C614E160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237C6241250>]}
[0m15:59:32.692929 [debug] [MainThread]: Flushing usage events
[0m16:04:03.664466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C6C79C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C6B7FDA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C6EFC27F0>]}


============================== 16:04:03.670255 | ca0afef6-db83-4016-b802-9eef55cc4619 ==============================
[0m16:04:03.670255 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:04:03.672258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'send_anonymous_usage_stats': 'True'}
[0m16:04:04.932848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0FDD6940>]}
[0m16:04:05.092758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0FEF4070>]}
[0m16:04:05.096231 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:04:05.130951 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:04:05.377816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:05.377816 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals.sql
[0m16:04:05.607068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C104170D0>]}
[0m16:04:05.636347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C101701F0>]}
[0m16:04:05.638339 [info ] [MainThread]: Found 12 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:04:05.640341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C10170F10>]}
[0m16:04:05.642428 [info ] [MainThread]: 
[0m16:04:05.647224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:05.651219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:04:05.676007 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:04:05.678019 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:04:05.681335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:08.868062 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:04:08.869938 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:04:09.359050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:04:09.360476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:04:09.365954 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:04:09.377362 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:04:09.378611 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:04:09.379610 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:04:09.381659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:09.382663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:11.018551 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:04:11.028397 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:04:11.116950 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:04:11.119951 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:04:11.542795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_orbit_mds_dev_core)
[0m16:04:11.549808 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:04:11.550881 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:04:11.553670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:11.593876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_CORE)
[0m16:04:11.608616 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:04:11.610631 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:04:11.621693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:13.206281 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:04:13.206281 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:04:13.262389 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:04:13.265409 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:04:13.807770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0FDEAD30>]}
[0m16:04:13.810773 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:04:13.811712 [info ] [MainThread]: 
[0m16:04:13.817733 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:04:13.818733 [info ] [Thread-1  ]: 1 of 1 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:04:13.821204 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:04:13.822921 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:04:13.832984 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:04:13.835985 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:04:13.823911 => 16:04:13.834987
[0m16:04:13.837980 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:04:13.938743 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:04:13.943611 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:04:13.946192 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  table orbit_mds_dev.core.tf_requests_approvals
         as
        (

with windowed_requests_approval (
    select
        max(created_at) OVER (PARTITION BY REQUEST_ID) final_date,
        min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
        first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
        last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
        first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
        last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
        *
    from orbit_mds_dev.public.requests_approvals
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval

        );
[0m16:04:13.947291 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:04:15.629133 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f648-0105-3f18-0006-1c670004b01e
[0m16:04:15.630305 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 4 unexpected 'select'.
syntax error line 7 at position 24 unexpected 'OVER'.
syntax error line 7 at position 55 unexpected 'final_date'.
[0m16:04:15.631275 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:04:13.837980 => 16:04:15.631275
[0m16:04:15.633329 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:04:16.086998 [debug] [Thread-1  ]: Database Error in model tf_requests_approvals (models\Flex\tf_requests_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'select'.
  syntax error line 7 at position 24 unexpected 'OVER'.
  syntax error line 7 at position 55 unexpected 'final_date'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\tf_requests_approvals.sql
[0m16:04:16.088001 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca0afef6-db83-4016-b802-9eef55cc4619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C106F9DC0>]}
[0m16:04:16.089006 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[31mERROR[0m in 2.27s]
[0m16:04:16.092003 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:04:16.095004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:16.096011 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:04:16.098236 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:04:16.100519 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m16:04:16.101992 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:04:16.103003 [info ] [MainThread]: 
[0m16:04:16.105212 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 10.46 seconds (10.46s).
[0m16:04:16.107000 [debug] [MainThread]: Command end result
[0m16:04:16.139845 [info ] [MainThread]: 
[0m16:04:16.142119 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:04:16.144957 [info ] [MainThread]: 
[0m16:04:16.148353 [error] [MainThread]:   Database Error in model tf_requests_approvals (models\Flex\tf_requests_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'select'.
  syntax error line 7 at position 24 unexpected 'OVER'.
  syntax error line 7 at position 55 unexpected 'final_date'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\tf_requests_approvals.sql
[0m16:04:16.152434 [info ] [MainThread]: 
[0m16:04:16.155181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:04:16.158947 [debug] [MainThread]: Command `dbt run` failed at 16:04:16.158402 after 12.57 seconds
[0m16:04:16.160688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C6C79C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0FEF4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C0FE466D0>]}
[0m16:04:16.162631 [debug] [MainThread]: Flushing usage events
[0m16:05:24.294469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FC00DC820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FC29021F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FBEF8C790>]}


============================== 16:05:24.300274 | 70771332-ef98-4d6c-b098-743f3f0cfcf6 ==============================
[0m16:05:24.300274 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:05:24.303282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:25.684015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FBEFAD490>]}
[0m16:05:25.785305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE37D8F10>]}
[0m16:05:25.789898 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:05:25.811741 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:05:26.021202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:26.021202 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals.sql
[0m16:05:26.168143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE3D570D0>]}
[0m16:05:26.190821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE3AAF1C0>]}
[0m16:05:26.192822 [info ] [MainThread]: Found 12 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:05:26.193840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE3AAFEE0>]}
[0m16:05:26.199265 [info ] [MainThread]: 
[0m16:05:26.202252 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:05:26.205248 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:05:26.233422 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:05:26.234625 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:05:26.237001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:28.850963 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:05:28.850963 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:05:29.339343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m16:05:29.341337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:05:29.352138 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:05:29.357127 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:05:29.358154 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:05:29.361163 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:05:29.363192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:29.364379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:30.901473 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:05:30.904865 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:05:30.909462 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:05:30.915906 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:05:31.398695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_CORE)
[0m16:05:31.401478 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:05:31.405634 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:05:31.406629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:31.417143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m16:05:31.436545 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:05:31.438228 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:05:31.438228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:32.947790 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:05:32.947790 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:05:32.982549 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:05:32.984558 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:05:33.475530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE37F29A0>]}
[0m16:05:33.478064 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:05:33.479980 [info ] [MainThread]: 
[0m16:05:33.487303 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:05:33.488934 [info ] [Thread-1  ]: 1 of 1 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:05:33.491727 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:05:33.492932 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:05:33.502011 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:05:33.505643 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:05:33.493569 => 16:05:33.504470
[0m16:05:33.507974 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:05:33.578665 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:05:33.583185 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:05:33.586329 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  table orbit_mds_dev.core.tf_requests_approvals
         as
        (

with windowed_requests_approval (
    select
        max(created_at) OVER (PARTITION BY request_id) as final_date,
        min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
        first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
        last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
        first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
        last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
        *
    from orbit_mds_dev.public.requests_approvals
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval

        );
[0m16:05:33.587689 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:05:35.134266 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f649-0105-3ee8-0006-1c670004c01e
[0m16:05:35.134266 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 4 unexpected 'select'.
syntax error line 7 at position 24 unexpected 'OVER'.
syntax error line 7 at position 55 unexpected 'as'.
[0m16:05:35.139593 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:05:33.509249 => 16:05:35.139593
[0m16:05:35.140828 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:05:35.604294 [debug] [Thread-1  ]: Database Error in model tf_requests_approvals (models\Flex\tf_requests_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'select'.
  syntax error line 7 at position 24 unexpected 'OVER'.
  syntax error line 7 at position 55 unexpected 'as'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\tf_requests_approvals.sql
[0m16:05:35.605376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70771332-ef98-4d6c-b098-743f3f0cfcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE4037CD0>]}
[0m16:05:35.607125 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[31mERROR[0m in 2.11s]
[0m16:05:35.611008 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:05:35.615286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:35.616457 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:05:35.617510 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:05:35.618665 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m16:05:35.620269 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:05:35.621533 [info ] [MainThread]: 
[0m16:05:35.624140 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 9.42 seconds (9.42s).
[0m16:05:35.627076 [debug] [MainThread]: Command end result
[0m16:05:35.661365 [info ] [MainThread]: 
[0m16:05:35.664701 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:05:35.666735 [info ] [MainThread]: 
[0m16:05:35.670220 [error] [MainThread]:   Database Error in model tf_requests_approvals (models\Flex\tf_requests_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 4 unexpected 'select'.
  syntax error line 7 at position 24 unexpected 'OVER'.
  syntax error line 7 at position 55 unexpected 'as'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\tf_requests_approvals.sql
[0m16:05:35.674312 [info ] [MainThread]: 
[0m16:05:35.677480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:05:35.682502 [debug] [MainThread]: Command `dbt run` failed at 16:05:35.681930 after 11.46 seconds
[0m16:05:35.684551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FC00DC820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE37D8F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FE3894160>]}
[0m16:05:35.687506 [debug] [MainThread]: Flushing usage events
[0m16:16:14.513997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020644A7C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064392EAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002064392E760>]}


============================== 16:16:14.520016 | 561ca185-fa02-4942-a467-135ddc59617c ==============================
[0m16:16:14.520016 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:16:14.522020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:15.973746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020645190F10>]}
[0m16:16:16.064377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206472C5C70>]}
[0m16:16:16.067380 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:16:16.091735 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:16:16.330297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:16:16.332277 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\Flex\stg_request_approvals.sql
[0m16:16:16.333272 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals.sql
[0m16:16:16.504859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206686F60D0>]}
[0m16:16:16.526064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066844F100>]}
[0m16:16:16.528089 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:16:16.529092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002066844FFD0>]}
[0m16:16:16.533892 [info ] [MainThread]: 
[0m16:16:16.536399 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:16.541449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:16:16.558036 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:16:16.560634 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:16:16.561638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:19.636456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:16:19.636456 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:16:20.171638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m16:16:20.172638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:16:20.183059 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:16:20.184085 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:16:20.184085 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:16:20.192427 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:16:20.193541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:20.194541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:21.925233 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:16:21.925233 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:16:21.992128 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:16:21.992128 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:16:22.523063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m16:16:22.542730 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:16:22.547328 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:16:22.548333 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:22.596487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_orbit_mds_dev_core)
[0m16:16:22.602610 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:16:22.615664 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:16:22.617856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:24.201032 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:16:24.201032 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:16:25.418375 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m16:16:25.420391 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:16:25.972220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206682563D0>]}
[0m16:16:25.975127 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:16:25.977358 [info ] [MainThread]: 
[0m16:16:25.984136 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:16:25.986476 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:16:25.990572 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:16:25.992273 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:16:26.000610 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:16:26.015110 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:16:25.994100 => 16:16:26.014496
[0m16:16:26.017177 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:16:26.068532 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:16:26.073800 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:16:26.075557 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval (
    select
        max(created_at) OVER (PARTITION BY request_id) as final_date,
        min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
        first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
        last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
        first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
        last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
        *
    from orbit_mds_dev.public.requests_approvals
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:16:26.076751 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:16:28.673723 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f654-0105-3f1a-0006-1c670004402e
[0m16:16:28.673723 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 4 unexpected 'select'.
syntax error line 8 at position 24 unexpected 'OVER'.
syntax error line 8 at position 55 unexpected 'as'.
[0m16:16:28.681484 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:16:26.018428 => 16:16:28.680581
[0m16:16:28.682698 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:16:29.219857 [debug] [Thread-1  ]: Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 4 unexpected 'select'.
  syntax error line 8 at position 24 unexpected 'OVER'.
  syntax error line 8 at position 55 unexpected 'as'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:16:29.220866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '561ca185-fa02-4942-a467-135ddc59617c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206689F6790>]}
[0m16:16:29.221869 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model orbit_mds_dev.core.stg_request_approvals .. [[31mERROR[0m in 3.23s]
[0m16:16:29.224859 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:16:29.226858 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:16:29.227871 [info ] [Thread-2  ]: 2 of 2 SKIP relation core.tf_requests_approvals ................................ [[33mSKIP[0m]
[0m16:16:29.230698 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:16:29.237281 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:29.238678 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:16:29.239671 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m16:16:29.240674 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m16:16:29.243470 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:16:29.244480 [info ] [MainThread]: 
[0m16:16:29.247157 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 12.71 seconds (12.71s).
[0m16:16:29.253366 [debug] [MainThread]: Command end result
[0m16:16:29.280028 [info ] [MainThread]: 
[0m16:16:29.281774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:16:29.283778 [info ] [MainThread]: 
[0m16:16:29.286785 [error] [MainThread]:   Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 4 unexpected 'select'.
  syntax error line 8 at position 24 unexpected 'OVER'.
  syntax error line 8 at position 55 unexpected 'as'.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:16:29.289102 [info ] [MainThread]: 
[0m16:16:29.290170 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:16:29.293587 [debug] [MainThread]: Command `dbt run` failed at 16:16:29.293168 after 14.85 seconds
[0m16:16:29.294371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020644A7C880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206472C5C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206681AFB50>]}
[0m16:16:29.294956 [debug] [MainThread]: Flushing usage events
[0m16:18:38.423756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C7C3CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C6AED8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C6AED9A0>]}


============================== 16:18:38.428686 | 19aa9999-501c-4515-b22c-579e38afea20 ==============================
[0m16:18:38.428686 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:18:38.430708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:40.131375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CA508970>]}
[0m16:18:40.285664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EB28E700>]}
[0m16:18:40.289050 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:18:40.322073 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:18:40.598486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:18:40.598486 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\stg_request_approvals.sql
[0m16:18:40.784173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EB8620D0>]}
[0m16:18:40.809383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EB61B130>]}
[0m16:18:40.811450 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:18:40.813695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EB61B3D0>]}
[0m16:18:40.818304 [info ] [MainThread]: 
[0m16:18:40.822656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:18:40.825097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:18:40.863199 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:18:40.867156 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:18:40.868182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:44.896345 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.0 seconds
[0m16:18:44.898367 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:18:45.520581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:18:45.522625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:18:45.526743 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:18:45.539641 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:18:45.544686 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:18:45.547443 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:18:45.549647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:45.550822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:47.349729 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:18:47.367561 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:18:47.431159 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:18:47.431159 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:18:47.900518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m16:18:47.902658 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:18:47.916461 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:18:47.918303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:47.982244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m16:18:47.987481 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:18:47.991691 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:18:47.992938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:49.688631 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:18:49.700942 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:18:50.704064 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 3.0 seconds
[0m16:18:50.707748 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:18:51.255744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EB3F8310>]}
[0m16:18:51.256892 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:18:51.259540 [info ] [MainThread]: 
[0m16:18:51.266838 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:18:51.268540 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:18:51.271402 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:18:51.272549 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:18:51.283307 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:18:51.284933 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:18:51.273569 => 16:18:51.284933
[0m16:18:51.288741 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:18:51.334377 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:18:51.338199 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:18:51.339812 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.public.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:18:51.341523 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:18:53.053227 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f656-0105-3f18-0006-1c670004b026
[0m16:18:53.054707 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'ORBIT_MDS_DEV.PUBLIC' does not exist or not authorized.
[0m16:18:53.058385 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:18:51.289295 => 16:18:53.057296
[0m16:18:53.060764 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:18:53.618668 [debug] [Thread-1  ]: Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (02000): SQL compilation error:
  Schema 'ORBIT_MDS_DEV.PUBLIC' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:18:53.618668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19aa9999-501c-4515-b22c-579e38afea20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EBAFCEB0>]}
[0m16:18:53.622690 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model orbit_mds_dev.core.stg_request_approvals .. [[31mERROR[0m in 2.35s]
[0m16:18:53.626121 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:18:53.629728 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:18:53.632158 [info ] [Thread-2  ]: 2 of 2 SKIP relation core.tf_requests_approvals ................................ [[33mSKIP[0m]
[0m16:18:53.634957 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:18:53.640054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:18:53.641027 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:18:53.643605 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m16:18:53.645572 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:18:53.647510 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:18:53.649005 [info ] [MainThread]: 
[0m16:18:53.652352 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 12.83 seconds (12.83s).
[0m16:18:53.655348 [debug] [MainThread]: Command end result
[0m16:18:53.699115 [info ] [MainThread]: 
[0m16:18:53.701694 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:18:53.706084 [info ] [MainThread]: 
[0m16:18:53.708409 [error] [MainThread]:   Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (02000): SQL compilation error:
  Schema 'ORBIT_MDS_DEV.PUBLIC' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:18:53.712754 [info ] [MainThread]: 
[0m16:18:53.714866 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:18:53.720650 [debug] [MainThread]: Command `dbt run` failed at 16:18:53.720650 after 15.38 seconds
[0m16:18:53.722958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C7C3CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EB28E700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255EAD40820>]}
[0m16:18:53.724648 [debug] [MainThread]: Flushing usage events
[0m16:21:25.801032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CDCC8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115BE2D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115BC7DCA0>]}


============================== 16:21:25.807893 | 823f6ac8-f84e-4883-9de6-8d8b692fd551 ==============================
[0m16:21:25.807893 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:21:25.810153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'send_anonymous_usage_stats': 'True'}
[0m16:21:27.563956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115BC9DB50>]}
[0m16:21:27.694050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021100415C10>]}
[0m16:21:27.697310 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:21:27.733109 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:21:28.094679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:21:28.097982 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\_flex_sources.yml
[0m16:21:28.100720 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals.sql
[0m16:21:28.415798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021100BEE0D0>]}
[0m16:21:28.448719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211007BD310>]}
[0m16:21:28.449745 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:21:28.452746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211007BD1C0>]}
[0m16:21:28.455753 [info ] [MainThread]: 
[0m16:21:28.459599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:21:28.463997 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:21:28.479239 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:21:28.483530 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:21:28.485622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:31.996309 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.0 seconds
[0m16:21:32.000309 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:21:32.568571 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m16:21:32.570420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:21:32.587292 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:21:32.591813 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:21:32.594028 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:21:32.595866 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:21:32.597798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:32.599929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:34.352155 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:21:34.356155 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:21:34.465621 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:21:34.468628 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:21:34.825225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_CORE)
[0m16:21:34.835937 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:21:34.838301 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:21:34.839946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:35.037522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m16:21:35.048514 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:21:35.050707 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:21:35.052791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:36.412520 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:21:36.414520 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:21:37.726829 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 3.0 seconds
[0m16:21:37.732828 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:21:38.280183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021100BE38E0>]}
[0m16:21:38.282183 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:21:38.284508 [info ] [MainThread]: 
[0m16:21:38.292274 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:21:38.294532 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:21:38.299484 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:21:38.301355 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:21:38.314240 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:21:38.317219 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:21:38.302256 => 16:21:38.316492
[0m16:21:38.319226 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:21:38.372309 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:21:38.376229 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:21:38.378220 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:21:38.379223 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:21:39.985165 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f659-0105-3f20-0006-1c670004704a
[0m16:21:39.987172 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORBIT_MDS_DEV.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
[0m16:21:39.989173 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:21:38.321230 => 16:21:39.988173
[0m16:21:39.990710 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:21:40.465495 [debug] [Thread-1  ]: Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORBIT_MDS_DEV.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:21:40.467495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '823f6ac8-f84e-4883-9de6-8d8b692fd551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021100E8B880>]}
[0m16:21:40.470496 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model orbit_mds_dev.core.stg_request_approvals .. [[31mERROR[0m in 2.17s]
[0m16:21:40.473495 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:21:40.475487 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:21:40.477490 [info ] [Thread-2  ]: 2 of 2 SKIP relation core.tf_requests_approvals ................................ [[33mSKIP[0m]
[0m16:21:40.479490 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:21:40.484496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:40.485491 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:21:40.486971 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:21:40.487497 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m16:21:40.489489 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:21:40.491489 [info ] [MainThread]: 
[0m16:21:40.493637 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 12.03 seconds (12.03s).
[0m16:21:40.496583 [debug] [MainThread]: Command end result
[0m16:21:40.525226 [info ] [MainThread]: 
[0m16:21:40.527492 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:21:40.529772 [info ] [MainThread]: 
[0m16:21:40.532497 [error] [MainThread]:   Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORBIT_MDS_DEV.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:21:40.535490 [info ] [MainThread]: 
[0m16:21:40.537506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:21:40.541490 [debug] [MainThread]: Command `dbt run` failed at 16:21:40.541490 after 14.88 seconds
[0m16:21:40.543489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115CDCC8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021100415C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021100534430>]}
[0m16:21:40.545490 [debug] [MainThread]: Flushing usage events
[0m16:23:43.910634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A10B1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A010CA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A38D27F0>]}


============================== 16:23:43.915990 | 3e49a7c5-b99f-4460-b0ca-da8af8e03428 ==============================
[0m16:23:43.915990 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:23:43.920601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:45.656354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C46D6940>]}
[0m16:23:45.767384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C47F4070>]}
[0m16:23:45.771773 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:23:45.801487 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:23:46.105013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:23:46.107851 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\_flex_sources.yml
[0m16:23:46.433254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C4EAF0D0>]}
[0m16:23:46.463452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C4A7C550>]}
[0m16:23:46.464696 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:23:46.467356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C4A7C280>]}
[0m16:23:46.472979 [info ] [MainThread]: 
[0m16:23:46.475664 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:46.479927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:23:46.503468 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:23:46.505041 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:23:46.506437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:49.270331 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:23:49.272337 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:23:49.809926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m16:23:49.811940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m16:23:49.817730 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:23:49.827315 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:23:49.828649 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:23:49.830189 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:23:49.830189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:49.832262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:51.564731 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:23:51.569617 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:23:51.594689 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:23:51.597801 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:23:52.073906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m16:23:52.075919 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:23:52.081219 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:23:52.081384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:52.125894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m16:23:52.132986 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:23:52.133992 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:23:52.135985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:53.851260 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:23:53.853255 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:23:54.053611 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:23:54.058898 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:23:54.647460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C4F54190>]}
[0m16:23:54.648469 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:23:54.650941 [info ] [MainThread]: 
[0m16:23:54.658699 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:23:54.659952 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:23:54.663521 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:23:54.665219 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:23:54.671743 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:23:54.674414 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:23:54.666345 => 16:23:54.673266
[0m16:23:54.676140 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:23:54.721114 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:23:54.726869 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:23:54.728992 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:23:54.730990 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:23:56.257465 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f65b-0105-3f18-0006-1c670004b036
[0m16:23:56.258654 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'ORBIT_MDS.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
[0m16:23:56.261773 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:23:54.677973 => 16:23:56.260748
[0m16:23:56.262583 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:23:56.762592 [debug] [Thread-1  ]: Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORBIT_MDS.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:23:56.762592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e49a7c5-b99f-4460-b0ca-da8af8e03428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C5108490>]}
[0m16:23:56.767611 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model orbit_mds_dev.core.stg_request_approvals .. [[31mERROR[0m in 2.10s]
[0m16:23:56.770379 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:23:56.772383 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:23:56.773930 [info ] [Thread-2  ]: 2 of 2 SKIP relation core.tf_requests_approvals ................................ [[33mSKIP[0m]
[0m16:23:56.776249 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:23:56.781548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:56.781548 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:23:56.781548 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m16:23:56.784775 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m16:23:56.787579 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:23:56.789399 [info ] [MainThread]: 
[0m16:23:56.792633 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 10.31 seconds (10.31s).
[0m16:23:56.796389 [debug] [MainThread]: Command end result
[0m16:23:56.827771 [info ] [MainThread]: 
[0m16:23:56.830200 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:23:56.831352 [info ] [MainThread]: 
[0m16:23:56.833354 [error] [MainThread]:   Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (42S02): SQL compilation error:
  Object 'ORBIT_MDS.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:23:56.835351 [info ] [MainThread]: 
[0m16:23:56.836712 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:23:56.840052 [debug] [MainThread]: Command `dbt run` failed at 16:23:56.840052 after 13.02 seconds
[0m16:23:56.841097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A10B1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C47F4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211C4EB0730>]}
[0m16:23:56.842079 [debug] [MainThread]: Flushing usage events
[0m16:25:48.605748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE543B1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5325C8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE5325C9A0>]}


============================== 16:25:48.613817 | 24ae0748-f2d4-49e5-8782-4c4fddb05249 ==============================
[0m16:25:48.613817 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:25:48.617290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:50.314666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE56C78970>]}
[0m16:25:50.452613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE77A07AF0>]}
[0m16:25:50.456626 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:25:50.491176 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:25:50.608182 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:25:50.611418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE54C676A0>]}
[0m16:25:53.415078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE782A80D0>]}
[0m16:25:53.440740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE77BDAFA0>]}
[0m16:25:53.442755 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:25:53.444806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE77A9A9A0>]}
[0m16:25:53.448455 [info ] [MainThread]: 
[0m16:25:53.451920 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:53.455857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP'
[0m16:25:53.464152 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP"
[0m16:25:53.471169 [debug] [ThreadPool]: On list_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP"} */
show terse schemas in database JAFFLE_SHOP
    limit 10000
[0m16:25:53.474171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:57.282183 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 4.0 seconds
[0m16:25:57.287456 [debug] [ThreadPool]: On list_JAFFLE_SHOP: Close
[0m16:25:57.859109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m16:25:57.861305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:25:57.878723 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:25:57.881745 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:25:57.885322 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:25:57.887736 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:25:57.890007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:57.892541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:59.801535 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:25:59.805844 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:25:59.811644 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:25:59.813910 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:26:00.372692 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_core)
[0m16:26:00.373913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m16:26:00.385962 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_core"
[0m16:26:00.388607 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:26:00.393556 [debug] [ThreadPool]: On list_JAFFLE_SHOP_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_core"} */
show terse objects in JAFFLE_SHOP.core limit 10000
[0m16:26:00.395557 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:26:00.397003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:00.399261 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:02.175822 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:26:02.182002 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:26:02.202915 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:26:02.208176 [debug] [ThreadPool]: On list_JAFFLE_SHOP_core: Close
[0m16:26:02.758399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE783CE220>]}
[0m16:26:02.760951 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:26:02.763257 [info ] [MainThread]: 
[0m16:26:02.768990 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:26:02.771912 [info ] [Thread-1  ]: 1 of 2 START sql view model core.stg_request_approvals ......................... [RUN]
[0m16:26:02.777179 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:26:02.778425 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:26:02.788093 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:26:02.791227 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:26:02.779556 => 16:26:02.791227
[0m16:26:02.791227 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:26:02.844913 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:26:02.849034 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:26:02.851022 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view JAFFLE_SHOP.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from jaffle_shop.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:26:02.853333 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:26:05.653963 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01b4f65e-0105-3f19-0006-1c6700045056
[0m16:26:05.655675 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'JAFFLE_SHOP.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
[0m16:26:05.659513 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:26:02.795648 => 16:26:05.657685
[0m16:26:05.661827 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:26:06.260788 [debug] [Thread-1  ]: Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (42S02): SQL compilation error:
  Object 'JAFFLE_SHOP.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:26:06.263606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24ae0748-f2d4-49e5-8782-4c4fddb05249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE783DF370>]}
[0m16:26:06.265880 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model core.stg_request_approvals ................ [[31mERROR[0m in 3.49s]
[0m16:26:06.268058 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:26:06.271054 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:26:06.273048 [info ] [Thread-2  ]: 2 of 2 SKIP relation core.tf_requests_approvals ................................ [[33mSKIP[0m]
[0m16:26:06.275448 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:26:06.281129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:06.283226 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP' was properly closed.
[0m16:26:06.285795 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_core' was properly closed.
[0m16:26:06.289656 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m16:26:06.294920 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:26:06.297563 [info ] [MainThread]: 
[0m16:26:06.301326 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 12.85 seconds (12.85s).
[0m16:26:06.303863 [debug] [MainThread]: Command end result
[0m16:26:06.333394 [info ] [MainThread]: 
[0m16:26:06.336339 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:26:06.339529 [info ] [MainThread]: 
[0m16:26:06.341852 [error] [MainThread]:   Database Error in model stg_request_approvals (models\Flex\stg_request_approvals.sql)
  002003 (42S02): SQL compilation error:
  Object 'JAFFLE_SHOP.RAW.REQUESTS_APPROVALS' does not exist or not authorized.
  compiled Code at target\run\dbt_jaffle_shop\models\Flex\stg_request_approvals.sql
[0m16:26:06.344851 [info ] [MainThread]: 
[0m16:26:06.347923 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:26:06.349873 [debug] [MainThread]: Command `dbt run` failed at 16:26:06.349873 after 17.85 seconds
[0m16:26:06.352974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE543B1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE77A07AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE78589370>]}
[0m16:26:06.354285 [debug] [MainThread]: Flushing usage events
[0m16:31:35.568754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CE690430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CD6ECA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D0EB27F0>]}


============================== 16:31:35.575160 | f40061b4-0ea4-421a-a0ad-d4b98ee0d436 ==============================
[0m16:31:35.575160 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:31:35.577499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:37.199090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F1CC6940>]}
[0m16:31:37.326241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F1DE4070>]}
[0m16:31:37.329538 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:31:37.355017 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:31:37.464553 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:31:37.477194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F1E959D0>]}
[0m16:31:40.217928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F258A0D0>]}
[0m16:31:40.247380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F1E959A0>]}
[0m16:31:40.249545 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:31:40.251730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F1CCE460>]}
[0m16:31:40.254727 [info ] [MainThread]: 
[0m16:31:40.257242 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:40.261356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:31:40.272767 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:31:40.272767 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:31:40.279330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:44.117257 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.0 seconds
[0m16:31:44.119645 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:31:44.769040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:31:44.770120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m16:31:44.784532 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:31:44.789554 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:31:44.791218 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:31:44.792240 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:31:44.794231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:44.795302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:46.891103 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:31:46.894924 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:31:47.029608 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:31:47.033615 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:31:47.454263 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m16:31:47.481426 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:31:47.482848 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:31:47.484052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:47.605542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m16:31:47.618272 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:31:47.620461 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:31:47.622279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:49.123065 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:31:49.125797 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:31:50.496005 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 3.0 seconds
[0m16:31:50.500014 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:31:51.079779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F265A3D0>]}
[0m16:31:51.080746 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:31:51.085996 [info ] [MainThread]: 
[0m16:31:51.099657 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:31:51.100709 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:31:51.106703 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:31:51.109174 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:31:51.119772 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:31:51.122267 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:31:51.109988 => 16:31:51.122267
[0m16:31:51.126135 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:31:51.200062 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:31:51.205969 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:31:51.208764 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:31:51.210747 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:31:53.174185 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:31:53.198854 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:31:51.127571 => 16:31:53.198854
[0m16:31:53.203701 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:31:53.806868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F281B370>]}
[0m16:31:53.806868 [info ] [Thread-1  ]: 1 of 2 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.70s]
[0m16:31:53.811746 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:31:53.814726 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:31:53.816722 [info ] [Thread-2  ]: 2 of 2 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:31:53.820093 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:31:53.821168 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:31:53.829391 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:31:53.832497 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:31:53.822219 => 16:31:53.832361
[0m16:31:53.835165 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:31:53.896382 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:31:53.899381 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:31:53.900395 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  table orbit_mds_dev.core.tf_requests_approvals
         as
        (

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals

        );
[0m16:31:53.902716 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:31:56.984560 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:31:56.994996 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:31:57.002461 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:31:57.002461 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m16:31:57.268941 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:31:57.268941 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:31:53.836465 => 16:31:57.268941
[0m16:31:57.273344 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:31:57.731150 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f40061b4-0ea4-421a-a0ad-d4b98ee0d436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F28728B0>]}
[0m16:31:57.731150 [info ] [Thread-2  ]: 2 of 2 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 1[0m in 3.91s]
[0m16:31:57.748893 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:31:57.751831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:57.753810 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:31:57.754812 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m16:31:57.756296 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m16:31:57.757301 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:31:57.759081 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:31:57.760257 [info ] [MainThread]: 
[0m16:31:57.762987 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 17.50 seconds (17.50s).
[0m16:31:57.767659 [debug] [MainThread]: Command end result
[0m16:31:57.790423 [info ] [MainThread]: 
[0m16:31:57.793426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:57.796838 [info ] [MainThread]: 
[0m16:31:57.799224 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:31:57.803242 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:57.802228 after 22.37 seconds
[0m16:31:57.804067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5CE690430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F22C1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5F212CA60>]}
[0m16:31:57.807091 [debug] [MainThread]: Flushing usage events
[0m16:33:06.734805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7C072C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7BF78D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7BF5DDCA0>]}


============================== 16:33:06.739141 | ba804046-0087-4409-b72d-4db1128bd608 ==============================
[0m16:33:06.739141 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:33:06.743051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:08.595651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7BF5FDB50>]}
[0m16:33:08.706734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E3D65C10>]}
[0m16:33:08.717321 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:33:08.743121 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:33:09.034975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:09.034975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:09.048209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E421B0D0>]}
[0m16:33:09.085185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E410C250>]}
[0m16:33:09.087859 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:33:09.090665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E410C430>]}
[0m16:33:09.095417 [info ] [MainThread]: 
[0m16:33:09.098520 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:33:09.104468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:33:09.130419 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:33:09.131924 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:33:09.132928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:12.360527 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:33:12.364716 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:33:12.927058 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:33:12.930478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m16:33:12.935958 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:33:12.950286 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:33:12.951846 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:33:12.954484 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:33:12.956236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:12.957225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:14.767164 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:33:14.772997 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:33:14.781050 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:33:14.784141 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:33:15.416819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_CORE)
[0m16:33:15.417831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m16:33:15.434210 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:33:15.438599 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:33:15.444556 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:33:15.447713 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:33:15.449710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:15.451593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:17.348427 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:33:17.348427 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:33:17.413109 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:33:17.426200 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:33:17.968326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E42E9C70>]}
[0m16:33:17.970366 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:33:17.972120 [info ] [MainThread]: 
[0m16:33:17.977466 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:33:17.980117 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:33:17.983970 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:33:17.985046 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:33:17.995060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:33:17.998550 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:33:17.986056 => 16:33:17.998550
[0m16:33:18.000873 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:33:18.046958 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:33:18.050134 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:33:18.052388 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:33:18.053553 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:33:20.080959 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:33:20.116952 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:33:18.001212 => 16:33:20.116952
[0m16:33:20.116952 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:33:20.779651 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E44ECBB0>]}
[0m16:33:20.780655 [info ] [Thread-1  ]: 1 of 2 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.80s]
[0m16:33:20.783650 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:33:20.785781 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:33:20.788487 [info ] [Thread-2  ]: 2 of 2 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:33:20.790881 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:33:20.793100 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:33:20.811106 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:20.814681 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:33:20.794268 => 16:33:20.813698
[0m16:33:20.816554 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:33:20.865342 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:20.865342 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m16:33:20.876082 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:33:23.200325 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:33:23.208090 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:23.212472 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:33:23.572657 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:33:23.581787 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:23.584449 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m16:33:23.880619 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:33:23.884571 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:23.892666 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m16:33:24.196383 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:33:24.233451 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:24.233451 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:24.246836 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m16:33:24.638016 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:24.638016 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:24.647232 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m16:33:25.571150 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m16:33:25.571150 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:25.573495 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m16:33:26.376591 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:33:26.381748 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:33:26.398862 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:33:26.398862 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m16:33:26.721939 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:33:26.724856 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:33:20.817014 => 16:33:26.724856
[0m16:33:26.727089 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:33:27.299308 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba804046-0087-4409-b72d-4db1128bd608', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E454EDF0>]}
[0m16:33:27.300299 [info ] [Thread-2  ]: 2 of 2 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 6.51s]
[0m16:33:27.303087 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:33:27.306633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:27.306633 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:33:27.309759 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m16:33:27.310840 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:33:27.315018 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:33:27.315941 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:33:27.317625 [info ] [MainThread]: 
[0m16:33:27.320548 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 18.22 seconds (18.22s).
[0m16:33:27.323898 [debug] [MainThread]: Command end result
[0m16:33:27.349788 [info ] [MainThread]: 
[0m16:33:27.353769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:27.356472 [info ] [MainThread]: 
[0m16:33:27.357916 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:33:27.364752 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:27.364141 after 20.71 seconds
[0m16:33:27.366315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7C072C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E42E9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D7E3DB38B0>]}
[0m16:33:27.367741 [debug] [MainThread]: Flushing usage events
[0m16:35:06.601644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546AC7C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546D4A21F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025469B2D790>]}


============================== 16:35:06.606632 | 39162d00-66fe-44f3-9a89-6f23035f5b95 ==============================
[0m16:35:06.606632 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:35:06.609644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:08.540219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025469B4D490>]}
[0m16:35:08.675225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E37EF10>]}
[0m16:35:08.678212 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:35:08.709224 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:35:08.988238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:08.989237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:09.000234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E76B0D0>]}
[0m16:35:09.027215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E65C310>]}
[0m16:35:09.028344 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:35:09.030235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E65C1C0>]}
[0m16:35:09.035238 [info ] [MainThread]: 
[0m16:35:09.038524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:35:09.042219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:35:09.061214 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:35:09.062218 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:35:09.063227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:12.561541 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:35:12.564480 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:35:13.279857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m16:35:13.281862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m16:35:13.304856 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:35:13.311037 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:35:13.312858 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:35:13.313863 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:35:13.315856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:13.316885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:15.361164 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:35:15.363178 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:35:15.795779 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:35:15.799776 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:35:16.149130 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m16:35:16.161766 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:35:16.163285 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:35:16.165036 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:16.383695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m16:35:16.388719 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:35:16.390711 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:35:16.391728 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:18.382568 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:35:18.386682 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:35:18.543371 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:35:18.549895 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:35:19.196046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E3A03D0>]}
[0m16:35:19.197453 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:35:19.200424 [info ] [MainThread]: 
[0m16:35:19.207414 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:35:19.209607 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:35:19.213418 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:35:19.214415 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:35:19.222424 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:35:19.225472 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:35:19.216563 => 16:35:19.224419
[0m16:35:19.227488 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:35:19.281415 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:35:19.285644 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:35:19.288424 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:35:19.290140 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:35:21.843817 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:35:21.877069 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:35:19.229365 => 16:35:21.876822
[0m16:35:21.878815 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:35:22.513734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540EA3EE80>]}
[0m16:35:22.515704 [info ] [Thread-1  ]: 1 of 2 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 3.30s]
[0m16:35:22.518744 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:35:22.520747 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:35:22.522707 [info ] [Thread-2  ]: 2 of 2 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:35:22.525709 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:35:22.527706 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:35:22.548706 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:22.551706 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:35:22.529701 => 16:35:22.551706
[0m16:35:22.553711 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:35:22.609491 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:22.610455 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m16:35:22.613452 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:35:24.843498 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:35:24.855495 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:24.857800 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:35:25.201200 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:35:25.211197 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:25.213198 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m16:35:25.562235 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:35:25.595876 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:25.598046 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m16:35:25.965390 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:35:26.009876 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:26.014776 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:26.016155 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m16:35:26.478728 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:35:26.478728 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:26.484305 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m16:35:27.411983 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:27.413034 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:27.414044 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m16:35:27.987647 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:35:27.994981 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:35:28.011425 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:35:28.011425 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m16:35:28.394945 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:35:28.394945 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:35:22.554429 => 16:35:28.394945
[0m16:35:28.405660 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:35:29.042516 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39162d00-66fe-44f3-9a89-6f23035f5b95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E9DCA30>]}
[0m16:35:29.043513 [info ] [Thread-2  ]: 2 of 2 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 1[0m in 6.52s]
[0m16:35:29.046518 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:35:29.051328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:29.051328 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:35:29.051328 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m16:35:29.053733 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m16:35:29.054849 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:35:29.055739 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:35:29.056757 [info ] [MainThread]: 
[0m16:35:29.059810 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 20.02 seconds (20.02s).
[0m16:35:29.063205 [debug] [MainThread]: Command end result
[0m16:35:29.089510 [info ] [MainThread]: 
[0m16:35:29.091557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:35:29.095316 [info ] [MainThread]: 
[0m16:35:29.097524 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:35:29.100808 [debug] [MainThread]: Command `dbt run` succeeded at 16:35:29.100808 after 22.60 seconds
[0m16:35:29.103195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002546AC7C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E740F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002540E2BE4F0>]}
[0m16:35:29.103195 [debug] [MainThread]: Flushing usage events
[0m16:37:11.665854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137798F1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001377C1131F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001377879D790>]}


============================== 16:37:11.672895 | 12c21177-f7fb-4cc5-959c-d9b3806676e0 ==============================
[0m16:37:11.672895 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:37:11.675000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:37:13.426179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137787BD490>]}
[0m16:37:13.544254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371CFEEF10>]}
[0m16:37:13.560035 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:37:13.590324 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:37:13.841118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:37:13.854518 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals.sql
[0m16:37:14.071341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D5BC0D0>]}
[0m16:37:14.105371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D2CB1C0>]}
[0m16:37:14.107394 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:37:14.110578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D4E87C0>]}
[0m16:37:14.115469 [info ] [MainThread]: 
[0m16:37:14.117452 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:14.122633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:37:14.146164 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:37:14.149714 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:37:14.151331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:17.172371 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:37:17.176154 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:37:17.816913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:37:17.819103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m16:37:17.840140 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:37:17.846814 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:37:17.849282 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:37:17.850958 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:37:17.852600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:17.854479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:19.558775 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:37:19.558775 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:37:19.792697 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:37:19.793912 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:37:20.043897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m16:37:20.050863 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:37:20.052298 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:37:20.053796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:20.375434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_orbit_mds_dev_core)
[0m16:37:20.382503 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:37:20.383765 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:37:20.386020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:21.596198 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:37:21.600271 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:37:21.955343 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:37:21.958385 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:37:22.496387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D096520>]}
[0m16:37:22.498412 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:37:22.500932 [info ] [MainThread]: 
[0m16:37:22.508853 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:37:22.510110 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:37:22.512817 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:37:22.515103 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:37:22.521246 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:37:22.526428 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:37:22.515919 => 16:37:22.525200
[0m16:37:22.528885 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:37:22.577442 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:37:22.582683 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:37:22.583601 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:37:22.584609 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:37:25.933324 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:37:25.979684 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:37:22.529873 => 16:37:25.979684
[0m16:37:25.981987 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:37:26.524921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D66B4F0>]}
[0m16:37:26.524921 [info ] [Thread-1  ]: 1 of 2 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 4.01s]
[0m16:37:26.543051 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:37:26.545280 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:37:26.547289 [info ] [Thread-2  ]: 2 of 2 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:37:26.550345 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:37:26.551627 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:37:26.563385 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:26.574668 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:37:26.553716 => 16:37:26.572971
[0m16:37:26.575556 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:37:26.640767 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:26.642435 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m16:37:26.644381 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:37:28.968861 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:37:28.991888 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:28.994413 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:37:30.276971 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 1.0 seconds
[0m16:37:30.284869 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:30.287013 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m16:37:30.611689 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:37:30.627407 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:30.628672 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m16:37:30.961301 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:37:31.011138 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:31.014589 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:31.017038 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m16:37:31.397510 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:37:31.398568 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:31.399867 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m16:37:33.990869 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 3.0 seconds
[0m16:37:33.992874 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:33.993866 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m16:37:34.653137 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:37:34.676051 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:37:34.683365 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:37:34.683365 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m16:37:35.027558 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:37:35.027558 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:37:26.577907 => 16:37:35.027558
[0m16:37:35.043582 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:37:35.690657 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12c21177-f7fb-4cc5-959c-d9b3806676e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D837A00>]}
[0m16:37:35.692906 [info ] [Thread-2  ]: 2 of 2 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 9.14s]
[0m16:37:35.693913 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:37:35.704818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:35.704818 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:37:35.708068 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m16:37:35.709879 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m16:37:35.709879 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:37:35.713222 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:37:35.713222 [info ] [MainThread]: 
[0m16:37:35.720405 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 21.60 seconds (21.60s).
[0m16:37:35.726991 [debug] [MainThread]: Command end result
[0m16:37:35.767992 [info ] [MainThread]: 
[0m16:37:35.771050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:35.772600 [info ] [MainThread]: 
[0m16:37:35.777182 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:37:35.781903 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:35.781219 after 24.20 seconds
[0m16:37:35.783560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000137798F1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D837A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001371D04C580>]}
[0m16:37:35.785121 [debug] [MainThread]: Flushing usage events
[0m16:39:55.622435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB33C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DA39DA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DDB627F0>]}


============================== 16:39:55.629644 | be821e66-b1aa-4d26-8266-eff160e1e816 ==============================
[0m16:39:55.629644 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:39:55.632078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:57.318592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FE976940>]}
[0m16:39:57.454460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FEA94070>]}
[0m16:39:57.458061 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:39:57.484005 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:39:57.846181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:57.846481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:57.858517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FEE2A070>]}
[0m16:39:57.882824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FED1D4F0>]}
[0m16:39:57.884821 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:39:57.885821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FED1D1F0>]}
[0m16:39:57.891670 [info ] [MainThread]: 
[0m16:39:57.893814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:39:57.897990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:39:57.920739 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:39:57.922257 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:39:57.924478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:01.518522 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.0 seconds
[0m16:40:01.522727 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:40:02.105854 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:40:02.108722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m16:40:02.130273 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:40:02.136243 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:40:02.138603 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:40:02.140058 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:40:02.142174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:02.143811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:04.034264 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:40:04.040127 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:40:04.388327 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:40:04.392141 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:40:04.556496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m16:40:04.564400 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:40:04.565955 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:40:04.567074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:04.954686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_CORE)
[0m16:40:04.971067 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:40:04.972890 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:40:04.973709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:06.647617 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:40:06.649614 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:40:07.619489 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 3.0 seconds
[0m16:40:07.619489 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:40:08.207912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FEEF9A90>]}
[0m16:40:08.208924 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:40:08.211025 [info ] [MainThread]: 
[0m16:40:08.218108 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:40:08.220191 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:40:08.222820 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:40:08.226114 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:40:08.234311 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:40:08.237641 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:40:08.227113 => 16:40:08.235871
[0m16:40:08.239475 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:40:08.277763 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:40:08.287671 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:40:08.289845 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:40:08.291845 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:40:10.474385 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:40:10.505833 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:40:08.240499 => 16:40:10.505279
[0m16:40:10.506866 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:40:11.163680 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FF0FCCD0>]}
[0m16:40:11.167007 [info ] [Thread-1  ]: 1 of 2 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.94s]
[0m16:40:11.167007 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:40:11.173576 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:40:11.175820 [info ] [Thread-2  ]: 2 of 2 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:40:11.180729 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:40:11.182320 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:40:11.209221 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:11.214431 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:40:11.183202 => 16:40:11.213323
[0m16:40:11.216223 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:40:11.276476 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:11.277628 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m16:40:11.279404 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:40:13.384992 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:40:13.406894 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:13.408862 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:40:13.721614 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:40:13.721614 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:13.731974 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m16:40:14.083036 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:40:14.095992 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:14.096986 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m16:40:14.388206 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:40:14.421824 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:14.425079 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:14.427018 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m16:40:14.774804 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:40:14.774804 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:14.779772 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m16:40:16.353804 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 2.0 seconds
[0m16:40:16.354804 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:16.356512 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m16:40:16.932305 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:40:16.943606 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:40:16.957906 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:40:16.957906 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m16:40:17.310639 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:40:17.316992 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:40:11.218702 => 16:40:17.316992
[0m16:40:17.318413 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:40:17.828384 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be821e66-b1aa-4d26-8266-eff160e1e816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FF099E80>]}
[0m16:40:17.828384 [info ] [Thread-2  ]: 2 of 2 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 2[0m in 6.65s]
[0m16:40:17.833263 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:40:17.840429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:17.841445 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:40:17.843565 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m16:40:17.844573 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:40:17.845599 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:40:17.847573 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:40:17.849806 [info ] [MainThread]: 
[0m16:40:17.851676 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 19.96 seconds (19.96s).
[0m16:40:17.854581 [debug] [MainThread]: Command end result
[0m16:40:17.877086 [info ] [MainThread]: 
[0m16:40:17.881046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:17.883591 [info ] [MainThread]: 
[0m16:40:17.888008 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:40:17.893370 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:17.892344 after 22.37 seconds
[0m16:40:17.895355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DB33C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227FEDFAEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DD697760>]}
[0m16:40:17.897872 [debug] [MainThread]: Flushing usage events
[0m16:41:15.844216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D021C61EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D020CBC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D020B0D820>]}


============================== 16:41:15.849851 | 028a8a97-9cc5-4c18-a0de-d3a97c6c2fca ==============================
[0m16:41:15.849851 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:41:15.853434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:17.504900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D045267B20>]}
[0m16:41:17.623341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0452E2160>]}
[0m16:41:17.633718 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m16:41:17.658348 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m16:41:17.894336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:17.900068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:17.905863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D04574A0D0>]}
[0m16:41:17.933942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D04563B3A0>]}
[0m16:41:17.935591 [info ] [MainThread]: Found 13 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m16:41:17.937870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D04563B430>]}
[0m16:41:17.940982 [info ] [MainThread]: 
[0m16:41:17.943194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:17.946660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m16:41:17.972565 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m16:41:17.974469 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m16:41:17.976387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:21.105604 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m16:41:21.110370 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m16:41:21.670197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m16:41:21.672068 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m16:41:21.681688 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m16:41:21.689241 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m16:41:21.691177 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m16:41:21.693286 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m16:41:21.694457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:21.696472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:23.632757 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:41:23.635704 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m16:41:23.679613 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m16:41:23.682185 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m16:41:24.190422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_orbit_mds_dev_core)
[0m16:41:24.191429 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m16:41:24.191429 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m16:41:24.201314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:24.301867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_CORE)
[0m16:41:24.306878 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m16:41:24.318667 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m16:41:24.320465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:26.037098 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m16:41:26.037098 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m16:41:26.102538 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m16:41:26.104752 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m16:41:26.777790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D045819E80>]}
[0m16:41:26.778811 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m16:41:26.781023 [info ] [MainThread]: 
[0m16:41:26.790843 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:41:26.792650 [info ] [Thread-1  ]: 1 of 2 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m16:41:26.796836 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m16:41:26.803476 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m16:41:26.809735 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:41:26.816353 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 16:41:26.805754 => 16:41:26.815585
[0m16:41:26.817396 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m16:41:26.873274 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:41:26.880918 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m16:41:26.883081 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m16:41:26.884565 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:41:28.627383 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:28.654511 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 16:41:26.819157 => 16:41:28.654511
[0m16:41:28.670214 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m16:41:29.147420 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D045A1DBE0>]}
[0m16:41:29.149504 [info ] [Thread-1  ]: 1 of 2 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.35s]
[0m16:41:29.152396 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m16:41:29.154460 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:41:29.156700 [info ] [Thread-2  ]: 2 of 2 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m16:41:29.160101 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals'
[0m16:41:29.162089 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:41:29.183047 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:29.186076 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 16:41:29.164587 => 16:41:29.186076
[0m16:41:29.189464 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:41:29.240471 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:29.240471 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m16:41:29.240471 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m16:41:31.871230 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:41:31.885534 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:31.887513 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:41:32.188954 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:41:32.188954 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:32.195875 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m16:41:32.482519 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:41:32.502919 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:32.505071 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m16:41:32.852256 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m16:41:32.889526 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:32.895101 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:32.896115 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m16:41:33.303580 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:33.304589 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:33.306608 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m16:41:34.830061 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:34.831381 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:34.833064 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m16:41:35.289440 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.314047 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m16:41:35.320005 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m16:41:35.320005 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m16:41:35.642531 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.642531 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 16:41:29.192360 => 16:41:35.642531
[0m16:41:35.652909 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m16:41:36.206470 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '028a8a97-9cc5-4c18-a0de-d3a97c6c2fca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D045A7C5E0>]}
[0m16:41:36.208471 [info ] [Thread-2  ]: 2 of 2 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 1[0m in 7.05s]
[0m16:41:36.210906 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m16:41:36.214499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:36.215646 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m16:41:36.216657 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m16:41:36.218697 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m16:41:36.220663 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m16:41:36.222269 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m16:41:36.225092 [info ] [MainThread]: 
[0m16:41:36.227128 [info ] [MainThread]: Finished running 1 view model, 1 incremental model in 0 hours 0 minutes and 18.28 seconds (18.28s).
[0m16:41:36.229750 [debug] [MainThread]: Command end result
[0m16:41:36.258636 [info ] [MainThread]: 
[0m16:41:36.260920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:36.262922 [info ] [MainThread]: 
[0m16:41:36.265584 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:41:36.269746 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:36.269205 after 20.52 seconds
[0m16:41:36.270758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D021C61EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0458192B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D045315220>]}
[0m16:41:36.272738 [debug] [MainThread]: Flushing usage events
[0m21:31:06.628482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DF30C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260E1B321F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DE1BD790>]}


============================== 21:31:06.636838 | c821969a-c8e1-42d8-8cd8-cf8bf253d1ef ==============================
[0m21:31:06.636838 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:31:06.639270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:31:09.271138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DE1DD490>]}
[0m21:31:09.430648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026082A08F10>]}
[0m21:31:09.435705 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:31:09.474007 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:31:09.914994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:31:09.916940 [debug] [MainThread]: Partial parsing: added file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:31:10.125911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026082F79F10>]}
[0m21:31:10.157515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026082CE27C0>]}
[0m21:31:10.158678 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:31:10.160723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026082EE9160>]}
[0m21:31:10.163812 [info ] [MainThread]: 
[0m21:31:10.168174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:10.173921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:31:10.193578 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:31:10.195489 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:31:10.196496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:12.353601 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:31:12.356712 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:31:12.892146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:31:12.894569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:31:12.906354 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:31:12.906354 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:31:12.922946 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:31:12.924571 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:31:12.926113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:12.927516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:14.758502 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:31:14.759501 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:31:14.768656 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:31:14.769660 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:31:15.294146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_orbit_mds_dev_core)
[0m21:31:15.296957 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:31:15.302712 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:31:15.303741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:15.442567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m21:31:15.444346 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:31:15.447912 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:31:15.448998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:16.994367 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m21:31:16.997371 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:31:17.252492 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:31:17.257321 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:31:17.846083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260830668B0>]}
[0m21:31:17.847107 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:31:17.849174 [info ] [MainThread]: 
[0m21:31:17.858421 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:31:17.859454 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:31:17.860730 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:31:17.863377 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:31:17.866187 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:31:17.868840 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:31:17.870200 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:31:17.871758 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:31:17.879377 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:31:17.891243 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:31:17.896611 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:31:17.876904 => 21:31:17.895828
[0m21:31:17.899017 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:31:17.882824 => 21:31:17.897957
[0m21:31:17.899967 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:31:17.901376 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:31:17.953563 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:31:18.007273 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:31:18.020403 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:31:18.023310 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:31:18.027029 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:31:18.029035 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:31:18.030295 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  table orbit_mds_dev.core.tf_requests_approvals_v2
         as
        (

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval

        );
[0m21:31:18.035785 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:31:20.048282 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:31:20.064349 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:31:17.902621 => 21:31:20.064349
[0m21:31:20.077346 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:31:20.636337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002608328CFA0>]}
[0m21:31:20.639019 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.77s]
[0m21:31:20.641008 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:31:20.642504 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:31:20.644790 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:31:20.647243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:31:20.648739 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:31:20.658835 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:20.661209 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:31:20.649753 => 21:31:20.661091
[0m21:31:20.662456 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:31:20.669373 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:20.671305 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:31:20.671765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:31:21.018720 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:31:21.029154 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:31:21.043450 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:31:21.044575 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp cascade
[0m21:31:21.417551 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:31:21.422549 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:31:17.944669 => 21:31:21.422549
[0m21:31:21.423872 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:31:21.923185 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260832486D0>]}
[0m21:31:21.932411 [info ] [Thread-2  ]: 2 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[32mSUCCESS 1[0m in 4.06s]
[0m21:31:21.935492 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:31:22.565317 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:31:22.584147 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:22.586295 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:31:22.909950 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:31:22.918114 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:22.920490 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:31:23.238612 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:31:23.259141 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:23.261043 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:31:23.620580 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:31:23.675912 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:23.679019 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:23.681025 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:31:24.094016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:31:24.094016 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:24.097443 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:31:25.308047 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:31:25.309048 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:25.311044 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:31:25.856279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:31:25.857265 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:31:25.864682 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:31:25.864682 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:31:26.197206 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:31:26.202068 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:31:20.663476 => 21:31:26.200136
[0m21:31:26.204010 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:31:26.777584 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c821969a-c8e1-42d8-8cd8-cf8bf253d1ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026083083550>]}
[0m21:31:26.778576 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 2[0m in 6.13s]
[0m21:31:26.781767 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:31:26.786956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:26.788757 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:31:26.788892 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m21:31:26.788892 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:31:26.794125 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:31:26.796669 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:31:26.798547 [info ] [MainThread]: 
[0m21:31:26.801205 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 16.63 seconds (16.63s).
[0m21:31:26.806799 [debug] [MainThread]: Command end result
[0m21:31:26.837679 [info ] [MainThread]: 
[0m21:31:26.840966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:31:26.842964 [info ] [MainThread]: 
[0m21:31:26.844959 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:31:26.848489 [debug] [MainThread]: Command `dbt run` succeeded at 21:31:26.848489 after 20.33 seconds
[0m21:31:26.850484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260DF30C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026082F59C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026082A6B580>]}
[0m21:31:26.851352 [debug] [MainThread]: Flushing usage events
[0m21:36:27.975364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561FFFC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561EEAEAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561EEAE760>]}


============================== 21:36:27.979950 | 939aef1f-a7e6-44c5-8398-4e028ad382d1 ==============================
[0m21:36:27.979950 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:36:27.985412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:36:29.618343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256206F3F10>]}
[0m21:36:29.729979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025622845C70>]}
[0m21:36:29.733241 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:36:29.762420 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:36:30.036086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:36:30.036086 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:36:30.056067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643AF3D90>]}
[0m21:36:30.082101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256439E3880>]}
[0m21:36:30.084372 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:36:30.086132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256439E35E0>]}
[0m21:36:30.089568 [info ] [MainThread]: 
[0m21:36:30.091713 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:30.095980 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:36:30.117118 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:36:30.118112 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:36:30.119112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:33.119400 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:36:33.121444 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:36:33.644735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m21:36:33.646166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:36:33.653327 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:36:33.673629 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:36:33.675633 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:36:33.676682 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:36:33.676682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:33.680790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:35.384970 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:36:35.384970 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:36:35.401799 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:36:35.403857 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:36:35.892370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_RAW)
[0m21:36:35.897605 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:36:35.908383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m21:36:35.909629 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:36:35.914366 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:36:35.917365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:35.918692 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:36:35.924880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:36:37.591979 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:36:37.594808 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:36:37.634410 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:36:37.637009 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:36:38.169558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564378EEE0>]}
[0m21:36:38.171366 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:36:38.173285 [info ] [MainThread]: 
[0m21:36:38.178695 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:36:38.179720 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:36:38.181792 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:36:38.186615 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:36:38.184272 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:36:38.188996 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:36:38.191795 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:36:38.202354 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:36:38.206649 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:36:38.231191 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:38.233249 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:36:38.193977 => 21:36:38.233249
[0m21:36:38.233249 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:36:38.237576 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:36:38.208931 => 21:36:38.237576
[0m21:36:38.284169 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:36:38.303484 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:36:38.366349 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:38.368219 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2) and first_date = created_at


  );
[0m21:36:38.370323 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:36:38.373748 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:36:38.380079 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:36:38.382560 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:36:40.389247 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:36:40.391011 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:36:40.395898 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:40.432850 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:36:38.238668 => 21:36:40.432850
[0m21:36:40.434256 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:36:40.435648 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:36:40.889236 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:36:40.889236 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:40.906014 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2
[0m21:36:41.209713 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:36:41.217548 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:41.229667 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS_V2"
[0m21:36:41.518192 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:36:41.551049 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:41.557692 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:41.557692 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
-- back compat for old kwarg name
  
  begin;
[0m21:36:41.858327 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:36:41.859419 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:41.861471 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
merge into orbit_mds_dev.core.tf_requests_approvals_v2 as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:36:41.889551 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643DF0040>]}
[0m21:36:41.892406 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 3.71s]
[0m21:36:41.895173 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:36:41.896881 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:36:41.898881 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:36:41.903288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:36:41.905035 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:36:41.913735 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:41.918296 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:36:41.906037 => 21:36:41.917111
[0m21:36:41.919771 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:36:41.926039 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:41.926039 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:36:41.926039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:36:43.090179 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:36:43.090472 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:43.092987 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
COMMIT
[0m21:36:43.507304 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:36:43.526557 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:36:43.536514 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:36:43.536514 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp cascade
[0m21:36:43.719877 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:36:43.719877 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:43.734299 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:36:43.853781 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:36:43.853781 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:36:38.304593 => 21:36:43.853781
[0m21:36:43.853781 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:36:44.026435 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:36:44.035902 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:44.035902 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:36:44.328986 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:36:44.337573 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:44.340065 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:36:44.506790 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643BF02E0>]}
[0m21:36:44.506790 [info ] [Thread-2  ]: 2 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[32mSUCCESS 2[0m in 6.31s]
[0m21:36:44.512569 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:36:44.600920 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:36:44.607204 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:44.610736 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:44.610736 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:36:44.915252 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:36:44.916248 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:44.917968 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:36:45.997847 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:36:45.997847 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:46.000862 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:36:46.487975 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:36:46.502813 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:36:46.504820 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:36:46.505822 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:36:46.842867 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:36:46.849760 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:36:41.920796 => 21:36:46.848524
[0m21:36:46.851319 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:36:47.429688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '939aef1f-a7e6-44c5-8398-4e028ad382d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643EBBF40>]}
[0m21:36:47.431844 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 2[0m in 5.53s]
[0m21:36:47.434839 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:36:47.438105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:47.439098 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:36:47.439098 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m21:36:47.442802 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:36:47.444134 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:36:47.445052 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:36:47.447045 [info ] [MainThread]: 
[0m21:36:47.448303 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 17.36 seconds (17.36s).
[0m21:36:47.451347 [debug] [MainThread]: Command end result
[0m21:36:47.476322 [info ] [MainThread]: 
[0m21:36:47.478739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:47.481742 [info ] [MainThread]: 
[0m21:36:47.483772 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:36:47.487101 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:47.487101 after 19.61 seconds
[0m21:36:47.489652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002561FFFC880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025643EBBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564372FB50>]}
[0m21:36:47.491419 [debug] [MainThread]: Flushing usage events
[0m21:37:55.732742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EAD01C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EAF8531F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EABECD790>]}


============================== 21:37:55.739450 | 19a81bf9-6f26-4ee8-820b-68c6a0f07468 ==============================
[0m21:37:55.739450 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:37:55.741124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:57.584481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EABEED490>]}
[0m21:37:57.744911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED072FF10>]}
[0m21:37:57.749437 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:37:57.775100 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:37:58.029585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:37:58.030595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:37:58.039862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0B23E50>]}
[0m21:37:58.062932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0A13940>]}
[0m21:37:58.064937 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:37:58.065936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0A136A0>]}
[0m21:37:58.069548 [info ] [MainThread]: 
[0m21:37:58.072539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:37:58.076576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:37:58.097250 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:37:58.099759 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:37:58.101772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:02.677524 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.0 seconds
[0m21:38:02.680432 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:38:03.223505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m21:38:03.225932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:38:03.238098 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:38:03.250835 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:38:03.252763 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:38:03.253842 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:38:03.255504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:03.256922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:05.036683 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:38:05.036683 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:38:05.053155 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:38:05.053155 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:38:05.592716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m21:38:05.595858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_CORE)
[0m21:38:05.613103 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:38:05.616733 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:38:05.620323 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:38:05.622083 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:38:05.623325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:05.625385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:07.410504 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:38:07.412522 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:38:07.427206 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:38:07.428207 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:38:07.999395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED067AF40>]}
[0m21:38:08.001406 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:38:08.003833 [info ] [MainThread]: 
[0m21:38:08.009904 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:38:08.012322 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:38:08.014535 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:38:08.017919 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:38:08.022086 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:38:08.024791 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:38:08.026925 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:38:08.032633 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:38:08.041612 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:38:08.066902 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:08.070632 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:38:08.033629 => 21:38:08.070632
[0m21:38:08.073148 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:38:08.043630 => 21:38:08.072780
[0m21:38:08.074561 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:38:08.076945 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:38:08.158039 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:38:08.192879 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:08.196021 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2) and first_date = created_at


  );
[0m21:38:08.198370 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:38:08.203232 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:38:08.207228 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:38:08.209237 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:38:10.283340 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:38:10.283340 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:10.296242 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:38:10.318546 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:38:10.351200 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:38:08.078179 => 21:38:10.350203
[0m21:38:10.352490 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:38:10.677733 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:38:10.699783 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:10.701786 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2
[0m21:38:10.943017 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0E20040>]}
[0m21:38:10.943017 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.92s]
[0m21:38:10.957004 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:38:10.959459 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:38:10.960461 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:38:10.964336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:38:10.966722 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:38:10.976894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:10.980186 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:38:10.969011 => 21:38:10.979624
[0m21:38:10.982158 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:38:10.992818 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:10.995723 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:38:10.997868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:38:11.008370 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:38:11.020852 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:11.021887 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS_V2"
[0m21:38:11.341292 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:38:11.382151 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:11.387090 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:11.387090 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
-- back compat for old kwarg name
  
  begin;
[0m21:38:11.719600 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:38:11.719600 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:11.728436 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
merge into orbit_mds_dev.core.tf_requests_approvals_v2 as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:38:12.638484 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:38:12.639483 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:12.642659 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
COMMIT
[0m21:38:12.902431 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:38:12.909414 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:12.909414 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:38:13.213598 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:38:13.216611 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:13.220914 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:38:13.388723 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:38:13.399211 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:38:13.416682 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:38:13.418573 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp cascade
[0m21:38:13.523412 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:38:13.533036 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:13.533036 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:38:13.750428 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:38:13.755548 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:38:08.112384 => 21:38:13.754540
[0m21:38:13.756724 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:38:13.819360 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:38:13.821369 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:13.827668 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:13.828845 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:38:14.219489 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:38:14.219489 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:14.219489 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:38:14.279880 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0D85CA0>]}
[0m21:38:14.279880 [info ] [Thread-2  ]: 2 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[32mSUCCESS 1[0m in 6.26s]
[0m21:38:14.294717 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:38:15.801623 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:38:15.803106 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:15.804105 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:38:16.388419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:38:16.389430 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:38:16.398065 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:38:16.398065 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:38:16.749771 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:38:16.753779 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:38:10.983185 => 21:38:16.753779
[0m21:38:16.755906 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:38:17.292453 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a81bf9-6f26-4ee8-820b-68c6a0f07468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0EC6A90>]}
[0m21:38:17.294346 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 1[0m in 6.33s]
[0m21:38:17.297233 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:38:17.302112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:17.303831 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:38:17.305519 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:38:17.306069 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:38:17.307185 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:38:17.308509 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:38:17.310652 [info ] [MainThread]: 
[0m21:38:17.312226 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 19.24 seconds (19.24s).
[0m21:38:17.315490 [debug] [MainThread]: Command end result
[0m21:38:17.343983 [info ] [MainThread]: 
[0m21:38:17.347254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:38:17.349341 [info ] [MainThread]: 
[0m21:38:17.351522 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:38:17.356164 [debug] [MainThread]: Command `dbt run` succeeded at 21:38:17.355480 after 21.72 seconds
[0m21:38:17.359674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EAD01C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED0E6CE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED078C580>]}
[0m21:38:17.361560 [debug] [MainThread]: Flushing usage events
[0m21:40:21.986623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9C0AC8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9B10D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9AF5DCA0>]}


============================== 21:40:21.992652 | 5265ec81-07df-4a32-91e4-c0d319930367 ==============================
[0m21:40:21.992652 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:40:21.997129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:40:23.669324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9AF7DB50>]}
[0m21:40:23.785933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBF6E5C10>]}
[0m21:40:23.796096 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:40:23.849758 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:40:24.134200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:24.135342 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:40:24.353428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBFD19F40>]}
[0m21:40:24.387417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBFA9E5E0>]}
[0m21:40:24.389187 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:40:24.391372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBFCB3160>]}
[0m21:40:24.398512 [info ] [MainThread]: 
[0m21:40:24.401359 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:40:24.406929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:40:24.431702 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:40:24.432941 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:40:24.435022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:26.750047 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:40:26.750047 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:40:27.273879 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:40:27.277179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:40:27.286498 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:40:27.295855 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:40:27.296859 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:40:27.299782 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:40:27.302314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:27.303416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:29.049516 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:40:29.052669 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:40:29.166517 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:40:29.168733 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:40:29.582089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_orbit_mds_dev_core)
[0m21:40:29.596747 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:40:29.598089 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:40:29.599571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:29.782266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m21:40:29.783282 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:40:29.783282 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:40:29.790705 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:31.337171 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:40:31.337171 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:40:31.507214 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:40:31.509972 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:40:32.061549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBFE08850>]}
[0m21:40:32.064558 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:40:32.066554 [info ] [MainThread]: 
[0m21:40:32.072207 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:40:32.072207 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:40:32.074564 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:40:32.077644 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:40:32.079639 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:40:32.082053 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:40:32.084052 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:40:32.086402 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:40:32.095393 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:40:32.107827 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:40:32.111233 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:40:32.088518 => 21:40:32.109917
[0m21:40:32.113589 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:40:32.114960 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:40:32.097368 => 21:40:32.114603
[0m21:40:32.149665 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:40:32.160566 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:40:32.202984 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:40:32.214521 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:40:32.211035 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:40:32.216542 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:40:32.218521 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:40:32.219542 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:40:34.041018 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f798-0105-3f1b-0006-1c670004f0c2
[0m21:40:34.042022 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 49 at position 19
invalid identifier 'CREATED_AT'
[0m21:40:34.044028 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:40:32.164789 => 21:40:34.043001
[0m21:40:34.046010 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:40:34.181604 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:40:34.215442 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:40:32.116858 => 21:40:34.215442
[0m21:40:34.216712 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:40:34.634580 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:40:34.637087 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBFE542E0>]}
[0m21:40:34.638178 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 2.56s]
[0m21:40:34.641603 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:40:34.752813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC00452E0>]}
[0m21:40:34.754501 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.67s]
[0m21:40:34.757434 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:40:34.760581 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:40:34.762275 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:40:34.767832 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:40:34.769850 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:40:34.782086 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:34.785585 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:40:34.771151 => 21:40:34.784672
[0m21:40:34.787410 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:40:34.802493 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:34.804159 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:40:34.805718 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:40:36.630439 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:40:36.646479 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:36.646479 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:40:37.021473 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:40:37.032119 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:37.034171 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:40:37.389575 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:40:37.403163 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:37.404162 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:40:37.682072 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:40:37.729008 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:37.732827 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:37.735328 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:40:38.055639 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:40:38.055639 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:38.058636 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:40:39.313368 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:40:39.315125 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:39.317678 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:40:39.821391 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:40:39.832132 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:40:39.845477 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:40:39.846562 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:40:40.175938 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:40:40.183261 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:40:34.789149 => 21:40:40.179812
[0m21:40:40.184617 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:40:40.728216 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5265ec81-07df-4a32-91e4-c0d319930367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC01ABAC0>]}
[0m21:40:40.729073 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 2[0m in 5.96s]
[0m21:40:40.731074 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:40:40.735737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:40.736734 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:40:40.737402 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:40:40.738413 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m21:40:40.739081 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:40:40.741321 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:40:40.742315 [info ] [MainThread]: 
[0m21:40:40.744318 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 16.34 seconds (16.34s).
[0m21:40:40.747321 [debug] [MainThread]: Command end result
[0m21:40:40.772017 [info ] [MainThread]: 
[0m21:40:40.774011 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:40:40.775294 [info ] [MainThread]: 
[0m21:40:40.778667 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:40:40.781815 [info ] [MainThread]: 
[0m21:40:40.784375 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:40:40.787386 [debug] [MainThread]: Command `dbt run` failed at 21:40:40.787386 after 18.89 seconds
[0m21:40:40.788378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF9C0AC8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBF6FD5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC0228F70>]}
[0m21:40:40.790722 [debug] [MainThread]: Flushing usage events
[0m21:42:16.844084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022547D318E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546D8C9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546BCDCA0>]}


============================== 21:42:16.849468 | dc6f743b-c59b-45cd-947f-3aadbab33200 ==============================
[0m21:42:16.849468 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:42:16.852093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:42:18.510650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022546BEDB50>]}
[0m21:42:18.658055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B355C10>]}
[0m21:42:18.660746 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:42:18.683744 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:42:18.953035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:42:18.955041 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:42:19.153032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B989F40>]}
[0m21:42:19.184170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B70E5E0>]}
[0m21:42:19.186161 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:42:19.188363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B923160>]}
[0m21:42:19.192437 [info ] [MainThread]: 
[0m21:42:19.195160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:42:19.199167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:42:19.218251 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:42:19.219256 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:42:19.220265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:22.113846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:42:22.113846 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:42:22.851855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:42:22.856809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:42:22.882891 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:42:22.884555 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:42:22.886249 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:42:22.887530 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:42:22.889174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:22.891150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:24.844720 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:42:24.844720 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:42:24.977570 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:42:24.981575 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:42:25.565447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_orbit_mds_dev_core)
[0m21:42:25.581503 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:42:25.582404 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:42:25.583976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:25.624703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m21:42:25.631775 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:42:25.634116 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:42:25.634116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:27.553177 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:42:27.556428 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:42:27.562097 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:42:27.562097 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:42:28.530190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BA77850>]}
[0m21:42:28.531194 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:42:28.534201 [info ] [MainThread]: 
[0m21:42:28.541949 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:42:28.543315 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:42:28.545862 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:42:28.547379 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:42:28.550567 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:42:28.553556 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:42:28.554840 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:42:28.556664 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:42:28.567250 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:42:28.579044 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:42:28.582248 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:42:28.558707 => 21:42:28.580998
[0m21:42:28.583380 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:42:28.584667 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:42:28.567343 => 21:42:28.583380
[0m21:42:28.620834 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:42:28.624677 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:42:28.660198 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:42:28.684227 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:42:28.688235 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:42:28.689242 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:42:28.691238 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:42:28.696049 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:42:31.929419 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f79a-0105-3f20-0006-1c6700047112
[0m21:42:31.931658 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000990 (42601): SQL compilation error: error line 20 at position 8
aggregate function alias 'FINAL_DATE' cannot be used in the WHERE clause
[0m21:42:31.933849 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:42:28.627200 => 21:42:31.933138
[0m21:42:31.935607 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:42:32.012012 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:42:32.053882 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:42:28.585504 => 21:42:32.053882
[0m21:42:32.055810 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:42:32.502713 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000990 (42601): SQL compilation error: error line 20 at position 8
  aggregate function alias 'FINAL_DATE' cannot be used in the WHERE clause
[0m21:42:32.502713 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B432370>]}
[0m21:42:32.509523 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 3.95s]
[0m21:42:32.514198 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:42:32.731685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BAC2CA0>]}
[0m21:42:32.731685 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 4.18s]
[0m21:42:32.736176 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:42:32.738241 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:42:32.740462 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:42:32.743059 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:42:32.745978 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:42:32.755803 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:32.757747 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:42:32.747760 => 21:42:32.757747
[0m21:42:32.760689 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:42:32.771139 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:32.772138 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:42:32.772969 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:42:35.448671 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m21:42:35.469711 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:35.475827 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:42:36.120444 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 1.0 seconds
[0m21:42:36.126553 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:36.128832 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:42:36.982236 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 1.0 seconds
[0m21:42:37.005240 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:37.007609 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:42:38.013822 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 1.0 seconds
[0m21:42:38.066774 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:38.071974 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:38.073461 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:42:38.589462 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:42:38.590747 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:38.591884 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:42:40.084558 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:42:40.084558 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:40.084558 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:42:40.564407 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:42:40.583472 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:42:40.598670 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:42:40.598670 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:42:40.986891 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:42:40.990570 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:42:32.762358 => 21:42:40.990570
[0m21:42:40.992539 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:42:41.583120 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc6f743b-c59b-45cd-947f-3aadbab33200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BE22E20>]}
[0m21:42:41.583120 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 2[0m in 8.84s]
[0m21:42:41.591290 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:42:41.596538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:41.598188 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:42:41.600029 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:42:41.601749 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:42:41.603144 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:42:41.604923 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:42:41.607233 [info ] [MainThread]: 
[0m21:42:41.610690 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 22.41 seconds (22.41s).
[0m21:42:41.614857 [debug] [MainThread]: Command end result
[0m21:42:41.643420 [info ] [MainThread]: 
[0m21:42:41.647124 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:42:41.650322 [info ] [MainThread]: 
[0m21:42:41.652613 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000990 (42601): SQL compilation error: error line 20 at position 8
  aggregate function alias 'FINAL_DATE' cannot be used in the WHERE clause
[0m21:42:41.654739 [info ] [MainThread]: 
[0m21:42:41.657984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:42:41.662308 [debug] [MainThread]: Command `dbt run` failed at 21:42:41.660939 after 24.93 seconds
[0m21:42:41.664145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022547D318E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256B355C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002256BE87DC0>]}
[0m21:42:41.666600 [debug] [MainThread]: Flushing usage events
[0m21:43:59.114292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F69C830820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F69F0531F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F69B6DD790>]}


============================== 21:43:59.120776 | bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5 ==============================
[0m21:43:59.120776 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:43:59.124046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:44:00.795083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F69B6FD490>]}
[0m21:44:00.905873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6BFF2EF10>]}
[0m21:44:00.920243 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:44:00.945271 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:44:01.223105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:44:01.223105 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:44:01.461961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C0499F10>]}
[0m21:44:01.495084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C0212940>]}
[0m21:44:01.496962 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:44:01.499121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C0433160>]}
[0m21:44:01.503169 [info ] [MainThread]: 
[0m21:44:01.505675 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:44:01.511962 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:44:01.531495 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:44:01.532975 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:44:01.533992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:04.411046 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:44:04.411046 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:44:04.948665 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:44:04.950094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:44:04.953868 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:44:04.968306 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:44:04.970133 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:44:04.971720 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:44:04.973157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:04.974953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:06.810551 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:44:06.810551 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:44:06.880989 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:44:06.880989 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:44:07.388163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m21:44:07.388163 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m21:44:07.404934 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:44:07.404934 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:44:07.413712 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:44:07.415422 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:44:07.417146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:07.418718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:09.332768 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:44:09.335925 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:44:09.338382 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:44:09.344377 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:44:09.901951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C05888B0>]}
[0m21:44:09.904882 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:44:09.906866 [info ] [MainThread]: 
[0m21:44:09.913042 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:44:09.914919 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:44:09.916075 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:44:09.920850 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:44:09.918812 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:44:09.923357 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:44:09.924378 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:44:09.937157 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:44:09.938982 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:44:09.941134 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:44:09.928234 => 21:44:09.941134
[0m21:44:09.955932 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:44:09.957082 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:44:09.991056 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:44:09.943699 => 21:44:09.991056
[0m21:44:09.991056 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:44:10.001915 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:44:10.052725 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:44:10.055017 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:44:10.057026 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:44:10.060295 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:44:10.064934 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:44:10.065935 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:44:11.893027 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f79c-0105-3f1a-0006-1c6700044106
[0m21:44:11.894090 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 49 at position 19
invalid identifier 'CREATED_AT'
[0m21:44:11.896292 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:44:10.002943 => 21:44:11.896292
[0m21:44:11.898349 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:44:12.028956 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:44:12.049866 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:44:09.960295 => 21:44:12.049866
[0m21:44:12.060372 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:44:12.481421 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:44:12.489632 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C0768F70>]}
[0m21:44:12.489718 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 2.56s]
[0m21:44:12.496599 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:44:12.610748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C07C02B0>]}
[0m21:44:12.612377 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.69s]
[0m21:44:12.614593 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:44:12.615821 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:44:12.617009 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:44:12.621163 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:44:12.622610 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:44:12.630927 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:12.632573 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:44:12.623719 => 21:44:12.632573
[0m21:44:12.634080 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:44:12.645870 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:12.646866 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:44:12.648234 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:44:14.442429 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:44:14.443426 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:14.443426 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:44:14.753693 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:44:14.759926 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:14.761834 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:44:15.051025 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:44:15.061746 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:15.062966 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:44:15.331597 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:44:15.375493 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:15.380472 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:15.381752 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:44:15.692750 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:44:15.693750 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:15.696032 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:44:17.227514 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 2.0 seconds
[0m21:44:17.229534 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:17.230432 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:44:17.747530 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:44:17.751914 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:44:17.774077 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:44:17.774077 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:44:18.176881 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:44:18.194906 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:44:12.635220 => 21:44:18.193903
[0m21:44:18.195905 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:44:18.715915 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bee17e08-13e1-4ea9-bcc3-7a0b73fe9fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C0912E80>]}
[0m21:44:18.715915 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 2[0m in 6.09s]
[0m21:44:18.719521 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:44:18.724064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:18.726517 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:44:18.728020 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:44:18.729944 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:44:18.731517 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:44:18.732507 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:44:18.734724 [info ] [MainThread]: 
[0m21:44:18.736842 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 17.23 seconds (17.23s).
[0m21:44:18.740403 [debug] [MainThread]: Command end result
[0m21:44:18.769051 [info ] [MainThread]: 
[0m21:44:18.773325 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:44:18.773487 [info ] [MainThread]: 
[0m21:44:18.779111 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:44:18.782286 [info ] [MainThread]: 
[0m21:44:18.786007 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:44:18.791223 [debug] [MainThread]: Command `dbt run` failed at 21:44:18.788588 after 19.78 seconds
[0m21:44:18.791223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F69C830820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6BFF2EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F6C05CF910>]}
[0m21:44:18.791223 [debug] [MainThread]: Flushing usage events
[0m21:45:19.312976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B515C61EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B514CBC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B514B0D820>]}


============================== 21:45:19.317103 | f1fbe9ab-8a60-4009-ab09-b799382485f6 ==============================
[0m21:45:19.317103 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:45:19.321377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:21.091524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539267B20>]}
[0m21:45:21.201745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5392E2160>]}
[0m21:45:21.211221 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:45:21.240318 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:45:21.546533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:45:21.549259 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:45:21.802469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5398CAF40>]}
[0m21:45:21.829430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539642910>]}
[0m21:45:21.830630 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:45:21.832697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5398630D0>]}
[0m21:45:21.836556 [info ] [MainThread]: 
[0m21:45:21.839980 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:21.843338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:45:21.862676 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:45:21.862676 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:45:21.866228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:24.825253 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:45:24.829561 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:45:25.347482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:45:25.350387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:45:25.361187 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:45:25.364288 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:45:25.367736 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:45:25.368834 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:45:25.370831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:25.371835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:27.127546 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:45:27.128566 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:45:27.143593 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:45:27.146611 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:45:27.679518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m21:45:27.680517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m21:45:27.699755 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:45:27.703378 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:45:27.708092 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:45:27.709512 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:45:27.712057 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:27.713663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:29.490064 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:45:29.495406 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:45:29.498026 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:45:29.506751 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:45:30.059840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5399B8880>]}
[0m21:45:30.062842 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:45:30.065663 [info ] [MainThread]: 
[0m21:45:30.075519 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:45:30.077085 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:45:30.079146 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:45:30.082676 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:45:30.081662 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:45:30.084366 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:45:30.087468 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:45:30.096169 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:45:30.098155 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:45:30.115766 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:45:30.117766 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:45:30.088370 => 21:45:30.116773
[0m21:45:30.118934 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:45:30.139197 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:45:30.101459 => 21:45:30.137667
[0m21:45:30.165885 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:45:30.167332 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:45:30.206961 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:45:30.221469 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:45:30.223472 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:45:30.224605 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where ra.created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:45:30.226763 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:45:30.227964 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:45:32.010329 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f79d-0105-3f1c-0006-1c67000460fe
[0m21:45:32.010329 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 49 at position 19
invalid identifier 'CREATED_AT'
[0m21:45:32.016747 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:45:30.169798 => 21:45:32.010329
[0m21:45:32.017746 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:45:32.145602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:45:32.162970 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:45:30.119947 => 21:45:32.162970
[0m21:45:32.173911 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:45:32.562054 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:45:32.562054 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539A033A0>]}
[0m21:45:32.575999 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 2.48s]
[0m21:45:32.579707 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:45:32.771243 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539BFA0D0>]}
[0m21:45:32.773240 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.69s]
[0m21:45:32.775237 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:45:32.777542 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:45:32.778575 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:45:32.781716 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:45:32.782439 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:45:32.792951 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:32.797088 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:45:32.783477 => 21:45:32.794972
[0m21:45:32.798701 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:45:32.809605 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:32.810610 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:45:32.813986 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:45:34.844774 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:45:34.848577 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:34.863622 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:45:35.149122 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:45:35.149122 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:35.157101 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:45:35.444193 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:45:35.446738 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:35.446738 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:45:35.743368 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:45:35.795306 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:35.801130 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:35.803700 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:45:36.146976 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:45:36.146976 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:36.146976 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:45:37.361697 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:45:37.369410 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:37.369945 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:45:38.447090 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:45:38.464076 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:45:38.479178 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:45:38.481027 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:45:38.834856 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:45:38.839388 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:45:32.799097 => 21:45:38.839388
[0m21:45:38.840905 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:45:39.458798 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fbe9ab-8a60-4009-ab09-b799382485f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B539C17D60>]}
[0m21:45:39.460353 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 6.68s]
[0m21:45:39.462805 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:45:39.466189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:39.467624 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:45:39.469980 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:45:39.471413 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:45:39.472429 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:45:39.474428 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:45:39.475424 [info ] [MainThread]: 
[0m21:45:39.479330 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 17.64 seconds (17.64s).
[0m21:45:39.482053 [debug] [MainThread]: Command end result
[0m21:45:39.504116 [info ] [MainThread]: 
[0m21:45:39.506381 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:39.509126 [info ] [MainThread]: 
[0m21:45:39.511573 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:45:39.513756 [info ] [MainThread]: 
[0m21:45:39.514895 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:45:39.519879 [debug] [MainThread]: Command `dbt run` failed at 21:45:39.518879 after 20.30 seconds
[0m21:45:39.520715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B515C61EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5392E2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B53963BB50>]}
[0m21:45:39.522733 [debug] [MainThread]: Flushing usage events
[0m21:45:51.777904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D610820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14FE331F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14C4BD790>]}


============================== 21:45:51.783077 | 2f0758db-5759-4a89-9b4f-67f584a5fea0 ==============================
[0m21:45:51.783077 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:45:51.786936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:45:53.408480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14C4DD490>]}
[0m21:45:53.526862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B170D0AF10>]}
[0m21:45:53.531304 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:45:53.562852 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:45:53.828578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:45:53.842574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:45:53.844848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B171103E50>]}
[0m21:45:53.886277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B170FF2940>]}
[0m21:45:53.887778 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:45:53.890458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B170FF26A0>]}
[0m21:45:53.894547 [info ] [MainThread]: 
[0m21:45:53.897384 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:53.901585 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:45:53.926701 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:45:53.929316 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:45:53.930233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:56.079484 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:45:56.079484 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:45:56.684538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:45:56.686125 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:45:56.711579 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:45:56.718926 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:45:56.720354 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:45:56.722900 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:45:56.722900 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:56.727387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:58.544188 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:45:58.544188 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:45:58.627891 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:45:58.627891 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:45:59.161360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m21:45:59.167036 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:45:59.171390 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:45:59.172401 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:45:59.177477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m21:45:59.191436 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:45:59.191436 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:45:59.195339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:00.878366 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:46:00.885539 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:46:00.947622 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:46:00.948651 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:46:01.552266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B170DB6D60>]}
[0m21:46:01.554270 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:46:01.557187 [info ] [MainThread]: 
[0m21:46:01.564339 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:01.565428 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:01.567431 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:46:01.569417 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:46:01.574594 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:46:01.577606 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:46:01.579608 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:01.580615 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:01.587560 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:46:01.605268 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:46:01.608920 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:46:01.581603 => 21:46:01.607900
[0m21:46:01.610913 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:01.611909 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:46:01.589024 => 21:46:01.611909
[0m21:46:01.659092 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:46:01.660093 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:01.707751 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:46:01.714913 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:46:01.715471 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where ra.created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:46:01.717808 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:46:01.719235 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:46:01.721507 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:46:03.542178 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f79e-0105-3ee8-0006-1c670004c0ee
[0m21:46:03.543375 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 49 at position 19
invalid identifier 'CREATED_AT'
[0m21:46:03.545956 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:46:01.662253 => 21:46:03.544797
[0m21:46:03.548506 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:46:03.550226 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:46:03.591278 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:46:01.612914 => 21:46:03.591278
[0m21:46:03.595435 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:46:04.173994 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:46:04.173994 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B17121CAC0>]}
[0m21:46:04.177778 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 2.60s]
[0m21:46:04.180778 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:04.184708 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1714150D0>]}
[0m21:46:04.184708 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.61s]
[0m21:46:04.190537 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:04.192965 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:04.195252 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:46:04.198733 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:46:04.199721 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:04.209003 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:04.212794 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:46:04.201657 => 21:46:04.211778
[0m21:46:04.215194 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:04.222083 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:04.223199 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:46:04.225042 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:46:06.102448 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:46:06.114218 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:06.120289 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:46:06.462686 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:46:06.477896 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:06.478795 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:46:06.745060 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:46:06.761205 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:06.761205 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:46:07.099037 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:46:07.140948 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:07.145146 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:07.146146 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:46:07.467791 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:46:07.468816 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:07.470166 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:46:08.761481 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:46:08.762490 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:08.764489 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:46:09.366720 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:46:09.377218 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:46:09.391885 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:09.393895 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:46:09.834570 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:46:09.838203 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:46:04.216207 => 21:46:09.838203
[0m21:46:09.841877 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:46:10.355979 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f0758db-5759-4a89-9b4f-67f584a5fea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1715B0580>]}
[0m21:46:10.357268 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 6.16s]
[0m21:46:10.360338 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:10.366198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:10.367721 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:46:10.369411 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:46:10.370600 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:46:10.372306 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:46:10.374861 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:46:10.377256 [info ] [MainThread]: 
[0m21:46:10.379796 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 16.48 seconds (16.48s).
[0m21:46:10.382539 [debug] [MainThread]: Command end result
[0m21:46:10.407961 [info ] [MainThread]: 
[0m21:46:10.409297 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:46:10.411971 [info ] [MainThread]: 
[0m21:46:10.414012 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 49 at position 19
  invalid identifier 'CREATED_AT'
[0m21:46:10.416504 [info ] [MainThread]: 
[0m21:46:10.418499 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:46:10.423196 [debug] [MainThread]: Command `dbt run` failed at 21:46:10.421560 after 18.74 seconds
[0m21:46:10.425216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14D610820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B170D0AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B17134FE80>]}
[0m21:46:10.426209 [debug] [MainThread]: Flushing usage events
[0m21:46:25.355475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3EA808E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3DADD9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3D92DCA0>]}


============================== 21:46:25.362048 | 52192c38-423a-4ba8-8f8d-68abd3000d4e ==============================
[0m21:46:25.362048 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:46:25.364086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:46:27.043221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3D94DB50>]}
[0m21:46:27.191667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D620B5C10>]}
[0m21:46:27.195736 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:46:27.229047 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:46:27.514605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:46:27.514605 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:46:27.717981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D626E9F40>]}
[0m21:46:27.744857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D624635E0>]}
[0m21:46:27.745943 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:46:27.747948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D626741F0>]}
[0m21:46:27.751346 [info ] [MainThread]: 
[0m21:46:27.754840 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:46:27.759008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:46:27.779268 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:46:27.780269 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:46:27.782576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:29.777439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:46:29.779445 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:46:30.380877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:46:30.383121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m21:46:30.399452 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:46:30.406189 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:46:30.407969 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:46:30.409729 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:46:30.410924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:30.412676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:32.279535 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:46:32.281489 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:46:32.459956 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:46:32.462964 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:46:32.811230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_RAW)
[0m21:46:32.822657 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:46:32.824427 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:46:32.826483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:33.113106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m21:46:33.121348 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:46:33.123255 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:46:33.125283 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:34.546319 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:46:34.550171 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:46:35.070816 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:46:35.073901 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:46:35.590726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D627D8850>]}
[0m21:46:35.592693 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:46:35.593752 [info ] [MainThread]: 
[0m21:46:35.600294 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:35.601894 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:35.602940 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:46:35.605138 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:46:35.608590 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:46:35.612233 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:46:35.614309 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:35.616672 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:35.629073 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:46:35.643859 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:46:35.646875 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:46:35.618688 => 21:46:35.645866
[0m21:46:35.648015 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:35.650310 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:46:35.629073 => 21:46:35.649294
[0m21:46:35.694531 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:46:35.695862 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:35.751168 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:46:35.751168 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:46:35.755193 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:46:35.757201 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:46:35.758348 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:46:35.759370 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:46:37.960805 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f79e-0105-3f15-0006-1c6700049112
[0m21:46:37.962254 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 19
invalid identifier 'CREATED_AT'
[0m21:46:37.964255 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:46:35.697980 => 21:46:37.963277
[0m21:46:37.965254 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:46:38.106285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:46:38.145804 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:46:35.650310 => 21:46:38.144795
[0m21:46:38.147174 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:46:38.817903 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 42 at position 19
  invalid identifier 'CREATED_AT'
[0m21:46:38.818926 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D62815820>]}
[0m21:46:38.820870 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 3.21s]
[0m21:46:38.823266 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:46:38.996983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D62A04E50>]}
[0m21:46:38.998616 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 3.39s]
[0m21:46:39.000965 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:46:39.003439 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:39.005746 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:46:39.008744 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:46:39.009750 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:39.018726 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:39.020842 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:46:39.010928 => 21:46:39.020678
[0m21:46:39.023262 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:39.031699 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:39.031699 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:46:39.033822 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:46:41.295234 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:46:41.308910 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:41.314221 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:46:41.642921 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:46:41.650775 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:41.653442 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:46:41.955617 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:46:41.975044 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:41.977887 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:46:42.264322 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:46:42.307764 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:42.312855 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:42.314357 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:46:42.689725 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:46:42.692246 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:42.693702 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:46:43.546783 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:46:43.547786 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:43.548797 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:46:44.330117 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:46:44.347255 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:46:44.356588 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:46:44.357606 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:46:44.646491 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:46:44.650225 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:46:39.024940 => 21:46:44.650225
[0m21:46:44.651686 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:46:45.170587 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52192c38-423a-4ba8-8f8d-68abd3000d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D62B64E20>]}
[0m21:46:45.173184 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 6.16s]
[0m21:46:45.175178 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:46:45.179445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:45.180228 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:46:45.181849 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:46:45.182850 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m21:46:45.183856 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:46:45.185250 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:46:45.188423 [info ] [MainThread]: 
[0m21:46:45.190207 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 17.43 seconds (17.43s).
[0m21:46:45.193781 [debug] [MainThread]: Command end result
[0m21:46:45.220776 [info ] [MainThread]: 
[0m21:46:45.223676 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:46:45.228572 [info ] [MainThread]: 
[0m21:46:45.230939 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 42 at position 19
  invalid identifier 'CREATED_AT'
[0m21:46:45.233809 [info ] [MainThread]: 
[0m21:46:45.235813 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:46:45.239826 [debug] [MainThread]: Command `dbt run` failed at 21:46:45.238839 after 19.97 seconds
[0m21:46:45.240844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3EA808E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D620B5C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D629AADC0>]}
[0m21:46:45.244060 [debug] [MainThread]: Flushing usage events
[0m21:47:13.057582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749CEEC820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749F7131F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749BD9D790>]}


============================== 21:47:13.064857 | 60766ce8-cd85-4815-8b57-a3186d00a3b5 ==============================
[0m21:47:13.064857 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:47:13.067517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:47:14.741787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749BDBD490>]}
[0m21:47:14.882265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C05EAF10>]}
[0m21:47:14.886287 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:47:14.919424 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:47:15.243121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:47:15.244600 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:47:15.250370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C09E3E50>]}
[0m21:47:15.280893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C08DE940>]}
[0m21:47:15.282901 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:47:15.283911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C08DE6A0>]}
[0m21:47:15.287046 [info ] [MainThread]: 
[0m21:47:15.291329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:47:15.295532 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:47:15.320773 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:47:15.322252 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:47:15.323223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:17.296587 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:47:17.306773 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:47:17.863718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m21:47:17.866492 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:47:17.879137 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:47:17.885917 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:47:17.888750 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:47:17.890756 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:47:17.892272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:17.894252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:47:19.737843 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:47:19.740847 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:47:19.770278 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:47:19.774052 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:47:20.314042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m21:47:20.325502 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:47:20.328504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_JAFFLE_SHOP_CORE)
[0m21:47:20.338796 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:47:20.343714 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:47:20.343714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:20.347222 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:47:20.351515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:47:22.258977 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:47:22.260139 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:47:22.263578 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:47:22.266452 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:47:22.898243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C053AF40>]}
[0m21:47:22.900250 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:47:22.903452 [info ] [MainThread]: 
[0m21:47:22.910783 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:47:22.911789 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:47:22.912411 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:47:22.916015 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:47:22.919362 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:47:22.921826 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:47:22.923725 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:47:22.925735 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:47:22.935780 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:47:22.957670 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:47:22.961933 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:47:22.926967 => 21:47:22.960920
[0m21:47:22.963549 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:47:22.964734 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:47:22.936302 => 21:47:22.964566
[0m21:47:23.013829 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:47:23.014148 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:47:23.048442 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:47:23.069307 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:47:23.070494 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:47:23.072498 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


)
select
    *
from filtered_requests_approval
where first_date = created_at
  );
[0m21:47:23.074598 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:47:23.075619 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:47:24.890085 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:47:24.918379 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:47:22.966519 => 21:47:24.918379
[0m21:47:24.919956 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:47:24.925378 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f79f-0105-3f15-0006-1c670004911e
[0m21:47:24.928831 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 42 at position 19
invalid identifier 'CREATED_AT'
[0m21:47:24.930418 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:47:23.015942 => 21:47:24.929952
[0m21:47:24.931421 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:47:25.434058 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C0CDDB20>]}
[0m21:47:25.439080 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.52s]
[0m21:47:25.443137 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:47:25.446483 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:47:25.447847 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:47:25.450434 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 42 at position 19
  invalid identifier 'CREATED_AT'
[0m21:47:25.452632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:47:25.454964 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C0C4B310>]}
[0m21:47:25.457030 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:47:25.460069 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 2.53s]
[0m21:47:25.470930 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:25.472615 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:47:25.477295 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:47:25.461206 => 21:47:25.474969
[0m21:47:25.479009 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:47:25.488013 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:25.489198 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:47:25.490899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:47:27.242802 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:47:27.258649 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:27.260263 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:47:27.553890 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:47:27.559349 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:27.561749 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:47:27.877721 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:47:27.889279 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:27.890295 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:47:28.153556 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:47:28.191224 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:28.203958 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:28.207883 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:47:28.576095 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:47:28.577093 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:28.579089 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:47:29.677644 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:47:29.678490 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:29.680362 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:47:30.141708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:47:30.163054 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:47:30.169946 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:47:30.169946 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:47:30.501351 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:47:30.507055 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:47:25.480442 => 21:47:30.506039
[0m21:47:30.509679 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:47:31.102928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60766ce8-cd85-4815-8b57-a3186d00a3b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C0E8D850>]}
[0m21:47:31.104711 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 5.65s]
[0m21:47:31.108165 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:47:31.112829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:47:31.114833 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:47:31.115975 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m21:47:31.118146 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:47:31.120144 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:47:31.123943 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:47:31.126313 [info ] [MainThread]: 
[0m21:47:31.128545 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 15.84 seconds (15.84s).
[0m21:47:31.131683 [debug] [MainThread]: Command end result
[0m21:47:31.160470 [info ] [MainThread]: 
[0m21:47:31.163288 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:47:31.165612 [info ] [MainThread]: 
[0m21:47:31.168555 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  000904 (42000): SQL compilation error: error line 42 at position 19
  invalid identifier 'CREATED_AT'
[0m21:47:31.170913 [info ] [MainThread]: 
[0m21:47:31.175722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:47:31.180053 [debug] [MainThread]: Command `dbt run` failed at 21:47:31.179486 after 18.22 seconds
[0m21:47:31.182044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002749CEEC820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C05EAF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274C08C7A90>]}
[0m21:47:31.183359 [debug] [MainThread]: Flushing usage events
[0m21:51:07.649096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06F10820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD097421F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD05DBD790>]}


============================== 21:51:07.653566 | b1c19c94-ff0c-4c63-bc69-0f4e1ae96139 ==============================
[0m21:51:07.653566 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:51:07.656633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:51:09.620642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD05DDD490>]}
[0m21:51:09.755079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A61FF10>]}
[0m21:51:09.762152 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:51:09.790445 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:51:10.033313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:51:10.035319 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:51:10.218667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2AB89F10>]}
[0m21:51:10.243650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A902940>]}
[0m21:51:10.244648 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:51:10.246656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2AB22160>]}
[0m21:51:10.249653 [info ] [MainThread]: 
[0m21:51:10.252229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:10.255636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:51:10.278264 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:51:10.282080 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:51:10.283322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:13.370439 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:51:13.378820 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:51:13.921926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:51:13.924921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m21:51:13.935152 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:51:13.944801 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:51:13.946786 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:51:13.948156 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:51:13.949828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:13.951037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:15.754088 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:51:15.763689 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:51:15.837368 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:51:15.839385 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:51:16.285916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_orbit_mds_dev_core)
[0m21:51:16.291151 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:51:16.291151 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:51:16.293146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:16.371483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m21:51:16.375128 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:51:16.382731 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:51:16.384096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:18.142133 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:51:18.147137 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:51:18.154979 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:51:18.158619 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:51:18.727784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A6329A0>]}
[0m21:51:18.729802 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:51:18.732019 [info ] [MainThread]: 
[0m21:51:18.738802 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:51:18.739804 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:51:18.741294 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:51:18.745174 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:51:18.743461 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:51:18.746163 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:51:18.749931 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:51:18.759276 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:51:18.760283 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:51:18.773734 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:51:18.775736 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:51:18.750928 => 21:51:18.774753
[0m21:51:18.777737 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:51:18.787843 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:51:18.761338 => 21:51:18.786805
[0m21:51:18.820435 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:51:18.823408 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:51:18.870078 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:51:18.878302 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:51:18.879791 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2 and first_date = created_at)


)
select
    *
from filtered_requests_approval
--where first_date = created_at
  );
[0m21:51:18.883539 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:51:18.884680 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:51:18.887130 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:51:20.685973 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01b4f7a3-0105-3f1d-0006-1c670004812a
[0m21:51:20.698912 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 22 unexpected 'select'.
syntax error line 42 at position 38 unexpected 'max'.
syntax error line 42 at position 55 unexpected ''1900-01-01''.
syntax error line 45 at position 0 unexpected ')'.
[0m21:51:20.702174 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:51:18.825415 => 21:51:20.701171
[0m21:51:20.703175 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:51:20.841470 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:51:20.868175 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:51:18.778752 => 21:51:20.868175
[0m21:51:20.868175 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:51:21.346125 [debug] [Thread-2  ]: Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 22 unexpected 'select'.
  syntax error line 42 at position 38 unexpected 'max'.
  syntax error line 42 at position 55 unexpected ''1900-01-01''.
  syntax error line 45 at position 0 unexpected ')'.
[0m21:51:21.347889 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2ACAEC40>]}
[0m21:51:21.350267 [error] [Thread-2  ]: 2 of 3 ERROR creating sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[31mERROR[0m in 2.60s]
[0m21:51:21.352889 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:51:21.551671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2AEB2280>]}
[0m21:51:21.552956 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.81s]
[0m21:51:21.554954 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:51:21.556965 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:51:21.557971 [info ] [Thread-2  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:51:21.559962 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:51:21.561965 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:51:21.571439 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:21.574925 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:51:21.563006 => 21:51:21.573924
[0m21:51:21.575925 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:51:21.587069 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:21.588069 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:51:21.589237 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m21:51:23.504594 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:51:23.507984 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:23.507984 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:51:23.820177 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:51:23.829368 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:23.831276 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:51:24.121604 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:51:24.137051 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:24.139149 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:51:24.421996 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:51:24.480369 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:24.485375 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:24.486367 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:51:24.787062 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:51:24.787062 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:24.793830 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:51:26.266209 [debug] [Thread-2  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:51:26.266209 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:26.269217 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:51:26.809010 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:51:26.829760 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:51:26.849565 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:51:26.849565 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:51:27.199040 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:51:27.204709 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:51:21.577088 => 21:51:27.204151
[0m21:51:27.206510 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:51:27.772897 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c19c94-ff0c-4c63-bc69-0f4e1ae96139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B07C160>]}
[0m21:51:27.774327 [info ] [Thread-2  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 6.21s]
[0m21:51:27.776769 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:51:27.782049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:27.784362 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:51:27.786358 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:51:27.787361 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m21:51:27.788398 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.stg_request_approvals' was properly closed.
[0m21:51:27.790175 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:51:27.791166 [info ] [MainThread]: 
[0m21:51:27.793256 [info ] [MainThread]: Finished running 2 incremental models, 1 view model in 0 hours 0 minutes and 17.54 seconds (17.54s).
[0m21:51:27.796700 [debug] [MainThread]: Command end result
[0m21:51:27.821919 [info ] [MainThread]: 
[0m21:51:27.824287 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:51:27.827549 [info ] [MainThread]: 
[0m21:51:27.830326 [error] [MainThread]:   Database Error in model tf_requests_approvals_v2 (models\Flex\tf_requests_approvals_v2.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 22 unexpected 'select'.
  syntax error line 42 at position 38 unexpected 'max'.
  syntax error line 42 at position 55 unexpected ''1900-01-01''.
  syntax error line 45 at position 0 unexpected ')'.
[0m21:51:27.833598 [info ] [MainThread]: 
[0m21:51:27.837940 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:51:27.843972 [debug] [MainThread]: Command `dbt run` failed at 21:51:27.842990 after 20.28 seconds
[0m21:51:27.844984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06F10820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2A61FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2B035F40>]}
[0m21:51:27.847768 [debug] [MainThread]: Flushing usage events
[0m21:53:32.286999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F884001F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F882EAE8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F882EAE9A0>]}


============================== 21:53:32.290813 | 0067e201-b32e-4d82-a5a0-98ffb3106879 ==============================
[0m21:53:32.290813 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:53:32.295049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'send_anonymous_usage_stats': 'True'}
[0m21:53:33.936779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8868DC970>]}
[0m21:53:34.051369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A765E700>]}
[0m21:53:34.068006 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:53:34.101512 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:53:34.355912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:34.355912 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:53:34.550168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7C79FD0>]}
[0m21:53:34.575962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A79F35B0>]}
[0m21:53:34.577184 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:53:34.579702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7C14190>]}
[0m21:53:34.584473 [info ] [MainThread]: 
[0m21:53:34.587616 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:53:34.591688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:53:34.607702 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:53:34.607702 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:53:34.613241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:37.572743 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:53:37.573741 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:53:38.091923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:53:38.093470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:53:38.108893 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:53:38.115313 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:53:38.117437 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:53:38.119660 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:53:38.120781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:38.121788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:39.874277 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:53:39.875296 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:53:39.883904 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:53:39.888903 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:53:40.500430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m21:53:40.508486 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:53:40.508486 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:53:40.511284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:40.536242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m21:53:40.562239 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:53:40.563231 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:53:40.565624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:53:42.305966 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:53:42.309985 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:53:42.339965 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:53:42.343983 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:53:42.862746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7D68820>]}
[0m21:53:42.865759 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:53:42.869156 [info ] [MainThread]: 
[0m21:53:42.874767 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:53:42.875776 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:53:42.878533 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:53:42.881757 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:53:42.885762 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:53:42.887757 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:53:42.889813 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:53:42.892754 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:53:42.901771 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:53:42.913378 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:42.917528 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:53:42.894749 => 21:53:42.916382
[0m21:53:42.918369 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:53:42.919378 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:53:42.902347 => 21:53:42.919378
[0m21:53:42.965382 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:53:42.966392 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:53:43.030528 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:43.034524 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:53:43.037210 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2) and first_date = created_at


)
select
    *
from filtered_requests_approval
--where first_date = created_at
  );
[0m21:53:43.039803 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:53:43.041517 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:53:43.043515 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:53:44.986860 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:53:45.002863 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:45.005803 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:53:45.062830 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:53:45.105021 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:53:42.920374 => 21:53:45.105021
[0m21:53:45.107024 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:53:45.349346 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:53:45.358348 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:45.363358 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2
[0m21:53:45.642277 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7FAB0D0>]}
[0m21:53:45.644280 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.76s]
[0m21:53:45.648208 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:53:45.650250 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:53:45.652261 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:53:45.656610 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:53:45.658257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:53:45.673248 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:45.675259 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:53:45.678254 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS_V2"
[0m21:53:45.689258 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:45.697802 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:53:45.680262 => 21:53:45.696255
[0m21:53:45.700252 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:53:45.710251 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:45.711213 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:53:45.712591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:53:45.998299 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:53:46.058365 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:46.064294 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:46.066298 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
-- back compat for old kwarg name
  
  begin;
[0m21:53:46.455146 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:53:46.456888 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:46.458401 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
merge into orbit_mds_dev.core.tf_requests_approvals_v2 as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:53:47.688536 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:53:47.697532 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:47.700206 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:53:47.798616 [debug] [Thread-2  ]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:53:47.800530 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:47.802516 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
COMMIT
[0m21:53:48.042041 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:53:48.050034 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:48.051038 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:53:48.362974 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:53:48.372966 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:48.374965 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:53:48.465964 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:53:48.484961 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:53:48.497970 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:53:48.499962 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp cascade
[0m21:53:48.670973 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:53:48.689888 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:48.699773 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:48.702815 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:53:48.820417 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:53:48.828097 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:53:42.968383 => 21:53:48.826915
[0m21:53:48.829782 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:53:49.057669 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:53:49.060021 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:49.061661 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:53:49.390960 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7F25910>]}
[0m21:53:49.393590 [info ] [Thread-2  ]: 2 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[32mSUCCESS 2[0m in 6.50s]
[0m21:53:49.396594 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:53:50.292235 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:53:50.294774 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:50.296236 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:53:50.818589 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:53:50.830336 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:53:50.833351 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:53:50.835349 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:53:51.214722 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:53:51.220366 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:53:45.701357 => 21:53:51.219365
[0m21:53:51.222361 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:53:51.736377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0067e201-b32e-4d82-a5a0-98ffb3106879', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A8059EE0>]}
[0m21:53:51.738830 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 6.08s]
[0m21:53:51.741730 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:53:51.745934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:51.747632 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:53:51.749086 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:53:51.750086 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:53:51.751155 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:53:51.753095 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:53:51.756088 [info ] [MainThread]: 
[0m21:53:51.758165 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 17.17 seconds (17.17s).
[0m21:53:51.761100 [debug] [MainThread]: Command end result
[0m21:53:51.896199 [info ] [MainThread]: 
[0m21:53:51.899220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:53:51.901206 [info ] [MainThread]: 
[0m21:53:51.903207 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:53:51.909219 [debug] [MainThread]: Command `dbt run` succeeded at 21:53:51.908214 after 19.71 seconds
[0m21:53:51.911264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F884001F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7C0AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8A7C12040>]}
[0m21:53:51.912224 [debug] [MainThread]: Flushing usage events
[0m21:54:36.026134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CC1162EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CC01BC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CC000D820>]}


============================== 21:54:36.032694 | 358afabd-79f8-4182-a7d0-5b7bcc59db48 ==============================
[0m21:54:36.032694 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:54:36.035578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:54:37.669623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4767B20>]}
[0m21:54:37.801806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE47E2160>]}
[0m21:54:37.805631 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:54:37.832063 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:54:38.071135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:54:38.072134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:54:38.087464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4C53E20>]}
[0m21:54:38.120687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4B43910>]}
[0m21:54:38.123065 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:54:38.125072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4B43640>]}
[0m21:54:38.129916 [info ] [MainThread]: 
[0m21:54:38.133197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:38.137738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:54:38.152962 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:54:38.156818 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:54:38.157978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:40.164062 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m21:54:40.167066 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:54:40.770694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:54:40.775556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_RAW'
[0m21:54:40.799710 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:54:40.807864 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:54:40.810256 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:54:40.811880 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:54:40.813284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:40.816300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:42.666842 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:54:42.669202 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:54:42.719979 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:54:42.724108 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:54:43.243153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_RAW, now list_orbit_mds_dev_core)
[0m21:54:43.247014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m21:54:43.263009 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:54:43.265636 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:54:43.269776 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:54:43.271778 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:54:43.274207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:43.275219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:54:44.958237 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:54:44.958237 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:54:45.039706 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:54:45.039706 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:54:45.686326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4815220>]}
[0m21:54:45.688332 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:54:45.690326 [info ] [MainThread]: 
[0m21:54:45.697315 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:54:45.698336 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:54:45.699697 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:54:45.703681 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:54:45.701675 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:54:45.706808 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:54:45.708897 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:54:45.716544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:54:45.718057 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:54:45.735761 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:45.737860 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:54:45.709899 => 21:54:45.737860
[0m21:54:45.739876 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:54:45.761636 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:54:45.720344 => 21:54:45.761636
[0m21:54:45.782274 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:54:45.783290 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:54:45.831090 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:54:45.836650 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:45.838624 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:54:45.840628 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where created_at > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2)


),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2) and first_date = created_at


)
select
    *
from filtered_requests_approval
--where first_date = created_at
  );
[0m21:54:45.841638 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:54:45.843631 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:54:47.765419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:54:47.766425 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:54:47.798354 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:54:45.740876 => 21:54:47.798254
[0m21:54:47.809344 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:47.812025 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:54:47.813323 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:54:48.161810 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:54:48.169413 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:48.170878 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2
[0m21:54:48.397508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4F4BCA0>]}
[0m21:54:48.398506 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.70s]
[0m21:54:48.401483 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:54:48.403605 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:54:48.406183 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:54:48.409471 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:54:48.410205 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:54:48.421194 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:48.424195 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:54:48.412221 => 21:54:48.423192
[0m21:54:48.425464 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:54:48.435738 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:48.436735 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:54:48.438650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:54:48.451746 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:54:48.462271 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:48.464280 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS_V2"
[0m21:54:48.755487 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:54:48.805875 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:48.809919 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:48.811933 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
-- back compat for old kwarg name
  
  begin;
[0m21:54:49.118699 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:49.121342 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:49.122481 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
merge into orbit_mds_dev.core.tf_requests_approvals_v2 as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:54:50.015488 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:50.016275 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:50.017763 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
COMMIT
[0m21:54:50.253746 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:54:50.257006 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:50.260854 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:54:50.499764 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:50.511474 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:54:50.518040 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:54:50.518040 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp cascade
[0m21:54:50.567326 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:54:50.569621 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:50.569621 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:54:50.863493 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:54:50.864915 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:50.872573 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:50.880335 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:54:45.785273 => 21:54:50.880335
[0m21:54:50.882160 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:54:50.884170 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:54:51.156785 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:54:51.156785 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:51.166989 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:51.168238 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:54:51.410324 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4EF6B50>]}
[0m21:54:51.410324 [info ] [Thread-2  ]: 2 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[32mSUCCESS 1[0m in 5.70s]
[0m21:54:51.415070 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:54:51.501672 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:51.502236 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:51.504240 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:54:52.568897 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:54:52.568897 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:52.582124 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:54:53.015387 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:53.021805 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:54:53.022919 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:54:53.024922 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:54:53.440747 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:54:53.443773 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:54:48.426987 => 21:54:53.443773
[0m21:54:53.445049 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:54:54.046490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358afabd-79f8-4182-a7d0-5b7bcc59db48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4FF8220>]}
[0m21:54:54.047500 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 1[0m in 5.64s]
[0m21:54:54.050194 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:54:54.055282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:54.056276 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:54:54.057715 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:54:54.058721 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m21:54:54.060717 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:54:54.061713 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:54:54.063107 [info ] [MainThread]: 
[0m21:54:54.066488 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 15.93 seconds (15.93s).
[0m21:54:54.069449 [debug] [MainThread]: Command end result
[0m21:54:54.105135 [info ] [MainThread]: 
[0m21:54:54.107964 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:54:54.109753 [info ] [MainThread]: 
[0m21:54:54.111749 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:54:54.115136 [debug] [MainThread]: Command `dbt run` succeeded at 21:54:54.115136 after 18.20 seconds
[0m21:54:54.117175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CC1162EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4C20790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE4FB48B0>]}
[0m21:54:54.118220 [debug] [MainThread]: Flushing usage events
[0m21:58:00.331832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408D471EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408C4CC9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408C30E820>]}


============================== 21:58:00.336772 | c5763e97-c65b-44f3-a0e5-4b447f3c4ce5 ==============================
[0m21:58:00.336772 [info ] [MainThread]: Running with dbt=1.7.11
[0m21:58:00.342637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/flex --vars pass_: password1234', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:02.010097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B0A67B20>]}
[0m21:58:02.111923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B0AE2160>]}
[0m21:58:02.122423 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m21:58:02.153033 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m21:58:02.429757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:02.429757 [debug] [MainThread]: Partial parsing: updated file: dbt_jaffle_shop://models\Flex\tf_requests_approvals_v2.sql
[0m21:58:02.681060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B10C9F40>]}
[0m21:58:02.714077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B0E43610>]}
[0m21:58:02.716048 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m21:58:02.719045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B105B190>]}
[0m21:58:02.722786 [info ] [MainThread]: 
[0m21:58:02.728209 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:02.732408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev'
[0m21:58:02.764538 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev"
[0m21:58:02.766859 [debug] [ThreadPool]: On list_orbit_mds_dev: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev"} */
show terse schemas in database orbit_mds_dev
    limit 10000
[0m21:58:02.769299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:05.695820 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m21:58:05.695820 [debug] [ThreadPool]: On list_orbit_mds_dev: Close
[0m21:58:06.226753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m21:58:06.231207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m21:58:06.236246 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m21:58:06.255704 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m21:58:06.256880 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m21:58:06.258688 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m21:58:06.260305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:06.261680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:08.116739 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m21:58:08.119941 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m21:58:08.121938 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m21:58:08.125366 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m21:58:08.646336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_RAW)
[0m21:58:08.664925 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m21:58:08.666437 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m21:58:08.667437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:08.681209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_CORE)
[0m21:58:08.685147 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m21:58:08.685147 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m21:58:08.691109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:58:10.449603 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m21:58:10.449603 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m21:58:10.460569 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m21:58:10.464639 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m21:58:11.034637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B0C27070>]}
[0m21:58:11.035652 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m21:58:11.038927 [info ] [MainThread]: 
[0m21:58:11.044899 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:58:11.045967 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:58:11.047192 [info ] [Thread-1  ]: 1 of 3 START sql view model orbit_mds_dev.core.stg_request_approvals ........... [RUN]
[0m21:58:11.049459 [info ] [Thread-2  ]: 2 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2 . [RUN]
[0m21:58:11.053201 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_request_approvals'
[0m21:58:11.056032 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2'
[0m21:58:11.058038 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m21:58:11.059717 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:58:11.068530 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:58:11.080674 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:11.083679 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 21:58:11.060734 => 21:58:11.082671
[0m21:58:11.084811 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m21:58:11.085828 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 21:58:11.068530 => 21:58:11.084811
[0m21:58:11.129362 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:58:11.130359 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:58:11.167309 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.stg_request_approvals"
[0m21:58:11.189125 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:11.190621 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.stg_request_approvals"} */
create or replace   view orbit_mds_dev.core.stg_request_approvals
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
)
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval
where first_date = created_at
  );
[0m21:58:11.192664 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
  
   as (
    

with windowed_requests_approval as (
select
    max(created_at) OVER (PARTITION BY request_id) as final_date,
    min(created_at) OVER (PARTITION BY REQUEST_ID) first_date,
    first_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_approval_id,
    last_value(approval_id) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_approval_id,
    first_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) first_action,
    last_value(action) OVER (PARTITION BY REQUEST_ID ORDER BY created_at) last_action,
    ra.*
from orbit_mds_dev.raw.requests_approvals ra
),
filtered_requests_approval as (
select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from windowed_requests_approval


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals_v2) and first_date = created_at


)
select
    *
from filtered_requests_approval
--where first_date = created_at
  );
[0m21:58:11.194420 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m21:58:11.196439 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m21:58:13.081511 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:58:13.081511 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:13.093400 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:58:13.113378 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:58:13.156350 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 21:58:11.086820 => 21:58:13.156350
[0m21:58:13.157767 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.stg_request_approvals: Close
[0m21:58:13.380169 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:58:13.381183 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:13.381183 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table orbit_mds_dev.core.tf_requests_approvals_v2
[0m21:58:13.697303 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B13F33A0>]}
[0m21:58:13.699646 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:58:13.700988 [info ] [Thread-1  ]: 1 of 3 OK created sql view model orbit_mds_dev.core.stg_request_approvals ...... [[32mSUCCESS 1[0m in 2.65s]
[0m21:58:13.717292 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:13.720857 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m21:58:13.722832 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS_V2"
[0m21:58:13.725112 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:58:13.730484 [info ] [Thread-1  ]: 3 of 3 START sql incremental model orbit_mds_dev.core.tf_requests_approvals .... [RUN]
[0m21:58:13.733094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m21:58:13.735275 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:58:13.746308 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:13.749353 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 21:58:13.737084 => 21:58:13.749091
[0m21:58:13.751320 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:58:13.762327 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:13.763331 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
create or replace  temporary view orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
  
   as (
    

select
    first_approval_id, 
    last_approval_id,
    request_id,
    org_id,
    amount,
    first_action,
    last_action,
    first_date,
    final_date,
    datediff(minute, first_date, final_date) as time_to_final_decision,
    user_id
from orbit_mds_dev.core.stg_request_approvals


  -- this filter will only be applied on an incremental run
  -- (uses >= to include records whose timestamp occurred since the last run of this model)
  where final_date > (select coalesce(max(final_date), '1900-01-01') from orbit_mds_dev.core.tf_requests_approvals)


  );
[0m21:58:13.765689 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m21:58:14.015279 [debug] [Thread-2  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:58:14.059116 [debug] [Thread-2  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:14.062860 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:14.063890 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
-- back compat for old kwarg name
  
  begin;
[0m21:58:14.380446 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:58:14.381447 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:14.384036 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
merge into orbit_mds_dev.core.tf_requests_approvals_v2 as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:58:15.367306 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:58:15.367306 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:15.371036 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
COMMIT
[0m21:58:15.462029 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:58:15.462029 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:15.468713 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:58:15.866473 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:58:15.869486 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:15.874033 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table orbit_mds_dev.core.tf_requests_approvals
[0m21:58:15.923101 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:58:15.936221 [debug] [Thread-2  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp
[0m21:58:15.947031 [debug] [Thread-2  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m21:58:15.947031 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals_v2"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals_v2__dbt_tmp cascade
[0m21:58:16.173820 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:58:16.181421 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:16.181421 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
describe table "ORBIT_MDS_DEV"."CORE"."TF_REQUESTS_APPROVALS"
[0m21:58:16.246745 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:58:16.256499 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 21:58:11.132217 => 21:58:16.255500
[0m21:58:16.258121 [debug] [Thread-2  ]: On model.dbt_jaffle_shop.tf_requests_approvals_v2: Close
[0m21:58:16.487867 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 0.0 seconds
[0m21:58:16.487867 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:16.495294 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:16.498769 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
-- back compat for old kwarg name
  
  begin;
[0m21:58:16.784500 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B13C02B0>]}
[0m21:58:16.786362 [info ] [Thread-2  ]: 2 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals_v2  [[32mSUCCESS 1[0m in 5.73s]
[0m21:58:16.788652 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m21:58:16.806347 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:58:16.808184 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:16.810087 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
merge into orbit_mds_dev.core.tf_requests_approvals as DBT_INTERNAL_DEST
        using orbit_mds_dev.core.tf_requests_approvals__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.first_approval_id = DBT_INTERNAL_DEST.first_approval_id
            )

    
    when matched then update set
        last_approval_id = DBT_INTERNAL_SOURCE.last_approval_id,last_action = DBT_INTERNAL_SOURCE.last_action,final_date = DBT_INTERNAL_SOURCE.final_date,time_to_final_decision = DBT_INTERNAL_SOURCE.time_to_final_decision
    

    when not matched then insert
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")
    values
        ("FIRST_APPROVAL_ID", "LAST_APPROVAL_ID", "REQUEST_ID", "ORG_ID", "AMOUNT", "FIRST_ACTION", "LAST_ACTION", "FIRST_DATE", "FINAL_DATE", "TIME_TO_FINAL_DECISION", "USER_ID")

;
[0m21:58:18.158737 [debug] [Thread-1  ]: SQL status: SUCCESS 0 in 1.0 seconds
[0m21:58:18.160729 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:18.161741 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
COMMIT
[0m21:58:18.758585 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:58:18.766554 [debug] [Thread-1  ]: Applying DROP to: orbit_mds_dev.core.tf_requests_approvals__dbt_tmp
[0m21:58:18.768480 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.tf_requests_approvals"
[0m21:58:18.769674 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.tf_requests_approvals"} */
drop view if exists orbit_mds_dev.core.tf_requests_approvals__dbt_tmp cascade
[0m21:58:19.070658 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:58:19.075312 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 21:58:13.752340 => 21:58:19.074760
[0m21:58:19.077400 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.tf_requests_approvals: Close
[0m21:58:19.683457 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5763e97-c65b-44f3-a0e5-4b447f3c4ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B148EE50>]}
[0m21:58:19.683457 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model orbit_mds_dev.core.tf_requests_approvals  [[32mSUCCESS 0[0m in 5.95s]
[0m21:58:19.689762 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m21:58:19.692916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:19.692916 [debug] [MainThread]: Connection 'list_orbit_mds_dev' was properly closed.
[0m21:58:19.695591 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_CORE' was properly closed.
[0m21:58:19.697303 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m21:58:19.698294 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals' was properly closed.
[0m21:58:19.699535 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.tf_requests_approvals_v2' was properly closed.
[0m21:58:19.700557 [info ] [MainThread]: 
[0m21:58:19.702557 [info ] [MainThread]: Finished running 1 view model, 2 incremental models in 0 hours 0 minutes and 16.97 seconds (16.97s).
[0m21:58:19.707305 [debug] [MainThread]: Command end result
[0m21:58:19.833634 [info ] [MainThread]: 
[0m21:58:19.834697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:58:19.837400 [info ] [MainThread]: 
[0m21:58:19.838567 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:58:19.842784 [debug] [MainThread]: Command `dbt run` succeeded at 21:58:19.841778 after 19.60 seconds
[0m21:58:19.843785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002408D471EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024090082460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B1061070>]}
[0m21:58:19.846229 [debug] [MainThread]: Flushing usage events
[0m23:20:44.777583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59F3C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5C787A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5C787B50>]}


============================== 23:20:44.784567 | 837b02dc-61e3-426d-ad96-fd3f7a9f55a9 ==============================
[0m23:20:44.784567 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:20:44.786073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:20:44.788077 [info ] [MainThread]: dbt version: 1.7.11
[0m23:20:44.789641 [info ] [MainThread]: python version: 3.9.13
[0m23:20:44.790661 [info ] [MainThread]: python path: C:\Users\Thinkbook 14\venv\Scripts\python.exe
[0m23:20:44.792645 [info ] [MainThread]: os info: Windows-10-10.0.22000-SP0
[0m23:20:51.005498 [info ] [MainThread]: Using profiles dir at C:\Users\Thinkbook 14\.dbt
[0m23:20:51.011618 [info ] [MainThread]: Using profiles.yml file at C:\Users\Thinkbook 14\.dbt\profiles.yml
[0m23:20:51.013708 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Data Engineering\First DE Project\MDS-for-Quality-Pipelines\dbt_jaffle_shop\dbt_project.yml
[0m23:20:51.016628 [info ] [MainThread]: adapter type: snowflake
[0m23:20:51.018634 [info ] [MainThread]: adapter version: 1.7.3
[0m23:20:51.113209 [info ] [MainThread]: Configuration:
[0m23:20:51.115494 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:20:51.117207 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:20:51.119212 [info ] [MainThread]: Required dependencies:
[0m23:20:51.121208 [debug] [MainThread]: Executing "git --help"
[0m23:20:51.150219 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:20:51.152099 [debug] [MainThread]: STDERR: "b''"
[0m23:20:51.153098 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:20:51.155107 [info ] [MainThread]: Connection:
[0m23:20:51.157097 [info ] [MainThread]:   account: ynb38656.us-east-1
[0m23:20:51.158107 [info ] [MainThread]:   user: AIRBYTE014
[0m23:20:51.160104 [info ] [MainThread]:   database: JAFFLE_SHOP
[0m23:20:51.162099 [info ] [MainThread]:   warehouse: MDS_WAREHOUSE
[0m23:20:51.165156 [info ] [MainThread]:   role: AIRBYTE_ADMIN
[0m23:20:51.167158 [info ] [MainThread]:   schema: RAW
[0m23:20:51.169150 [info ] [MainThread]:   authenticator: None
[0m23:20:51.171150 [info ] [MainThread]:   oauth_client_id: None
[0m23:20:51.172314 [info ] [MainThread]:   query_tag: None
[0m23:20:51.174330 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:20:51.176511 [info ] [MainThread]:   host: None
[0m23:20:51.178314 [info ] [MainThread]:   port: None
[0m23:20:51.180316 [info ] [MainThread]:   proxy_host: None
[0m23:20:51.182315 [info ] [MainThread]:   proxy_port: None
[0m23:20:51.184590 [info ] [MainThread]:   protocol: None
[0m23:20:51.186310 [info ] [MainThread]:   connect_retries: 1
[0m23:20:51.187313 [info ] [MainThread]:   connect_timeout: None
[0m23:20:51.188504 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:20:51.190545 [info ] [MainThread]:   retry_all: False
[0m23:20:51.191533 [info ] [MainThread]:   insecure_mode: False
[0m23:20:51.193262 [info ] [MainThread]:   reuse_connections: None
[0m23:20:51.194537 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m23:20:51.197538 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:20:51.199538 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:20:51.200643 [debug] [MainThread]: On debug: select 1 as id
[0m23:20:51.202544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:20:55.833686 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m23:20:55.833686 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m23:20:55.843864 [debug] [MainThread]: On debug: No close available on handle
[0m23:20:55.844886 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m23:20:55.846876 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:20:55.848987 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ynb38656.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m23:20:55.853793 [debug] [MainThread]: Command `dbt debug` failed at 23:20:55.853793 after 11.18 seconds
[0m23:20:55.854809 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:20:55.855900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB59F3C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB7D5E32E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB5C76E9A0>]}
[0m23:20:55.856762 [debug] [MainThread]: Flushing usage events
[0m23:21:09.964826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136ACA31F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136AF2561C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136AF256220>]}


============================== 23:21:09.970091 | ee7a86b1-cead-41d5-8d18-fff4eb9e06ea ==============================
[0m23:21:09.970091 [info ] [MainThread]: Running with dbt=1.7.11
[0m23:21:09.972262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m23:21:11.492444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee7a86b1-cead-41d5-8d18-fff4eb9e06ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136AF2649A0>]}
[0m23:21:11.565036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee7a86b1-cead-41d5-8d18-fff4eb9e06ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D008EC70>]}
[0m23:21:11.580847 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m23:21:11.628816 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m23:21:11.722514 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m23:21:11.725516 [debug] [MainThread]: previous checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, current checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba
[0m23:21:11.727511 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m23:21:11.729526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee7a86b1-cead-41d5-8d18-fff4eb9e06ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D01D4490>]}
[0m23:21:15.454176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee7a86b1-cead-41d5-8d18-fff4eb9e06ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D08FC0D0>]}
[0m23:21:15.472526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee7a86b1-cead-41d5-8d18-fff4eb9e06ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D0791E80>]}
[0m23:21:15.473732 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m23:21:15.474694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee7a86b1-cead-41d5-8d18-fff4eb9e06ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D0280640>]}
[0m23:21:15.478711 [info ] [MainThread]: 
[0m23:21:15.481499 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:21:15.484498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m23:21:15.498046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_INTERMEDIATE'
[0m23:21:15.496160 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m23:21:15.501052 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m23:21:15.504054 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m23:21:15.505600 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m23:21:15.506577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:15.506577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:17.490493 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m23:21:17.491623 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m23:21:17.492633 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:17.494630 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:17.495654 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:21:17.496651 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:21:17.498669 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:17.499653 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:17.500660 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: No close available on handle
[0m23:21:17.500938 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: No close available on handle
[0m23:21:17.503659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_INTERMEDIATE, now list_JAFFLE_SHOP_RAW)
[0m23:21:17.506242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_orbit_mds_dev_core)
[0m23:21:17.512259 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m23:21:17.513281 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m23:21:17.517830 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m23:21:17.519004 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m23:21:17.520040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:17.521037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:18.929911 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m23:21:18.930998 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:18.932010 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:21:18.932010 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:18.934021 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: No close available on handle
[0m23:21:18.938093 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m23:21:18.938093 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:18.939092 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m23:21:18.940096 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m23:21:18.941110 [debug] [ThreadPool]: On list_orbit_mds_dev_core: No close available on handle
[0m23:21:18.943127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:18.945110 [debug] [MainThread]: Connection 'list_orbit_mds_dev_core' was properly closed.
[0m23:21:18.946106 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m23:21:18.947117 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: ynb38656.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m23:21:18.950100 [debug] [MainThread]: Command `dbt docs generate` failed at 23:21:18.950100 after 9.07 seconds
[0m23:21:18.951102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136ACA31F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D02859A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136D0C0CB80>]}
[0m23:21:18.952098 [debug] [MainThread]: Flushing usage events
[0m15:40:08.541446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244319E1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024434207790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024434207250>]}


============================== 15:40:08.549458 | 8ed1ecd3-877a-4288-ad9c-b35bb103b2dd ==============================
[0m15:40:08.549458 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:40:08.551453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:40:15.408614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ed1ecd3-877a-4288-ad9c-b35bb103b2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024434207A30>]}
[0m15:40:15.496452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ed1ecd3-877a-4288-ad9c-b35bb103b2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002445507D070>]}
[0m15:40:15.500475 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:40:15.547996 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:40:17.600167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:17.601176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:17.608439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ed1ecd3-877a-4288-ad9c-b35bb103b2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244554CB9A0>]}
[0m15:40:17.614766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ed1ecd3-877a-4288-ad9c-b35bb103b2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244553D1AF0>]}
[0m15:40:17.615457 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m15:40:17.617600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed1ecd3-877a-4288-ad9c-b35bb103b2dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244553D1B80>]}
[0m15:40:17.622610 [info ] [MainThread]: 
[0m15:40:17.624585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:17.628103 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m15:40:17.637734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m15:40:17.647862 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m15:40:17.652019 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m15:40:17.653885 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m15:40:17.655102 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m15:40:17.655876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:17.658001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:20.650895 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m15:40:20.652890 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m15:40:20.653885 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:20.654891 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:20.655896 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:40:20.658364 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:40:20.660095 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:20.661102 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:20.662097 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: No close available on handle
[0m15:40:20.663186 [debug] [ThreadPool]: On list_orbit_mds_dev_core: No close available on handle
[0m15:40:20.665091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m15:40:20.667112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m15:40:20.675134 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m15:40:20.679757 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m15:40:20.680752 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m15:40:20.681743 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m15:40:20.683757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:20.683757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:22.273504 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m15:40:22.274501 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:22.275499 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:40:22.276493 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:22.278500 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: No close available on handle
[0m15:40:22.300096 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m15:40:22.301094 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:22.301094 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:40:22.302289 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:40:22.303096 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: No close available on handle
[0m15:40:22.305107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:22.306110 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m15:40:22.307297 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m15:40:22.309164 [error] [MainThread]: Encountered an error:
Database Error
  250001 (08001): Failed to connect to DB: ynb38656.us-east-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m15:40:22.314478 [debug] [MainThread]: Command `dbt docs generate` failed at 15:40:22.313294 after 13.87 seconds
[0m15:40:22.315746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244319E1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244553D1C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244557D20D0>]}
[0m15:40:22.315746 [debug] [MainThread]: Flushing usage events
[0m15:42:30.287466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B04911430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B050CD5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B0713D400>]}


============================== 15:42:30.294466 | 71181c20-f581-4e75-aa14-5dd188fb8bbf ==============================
[0m15:42:30.294466 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:42:30.296632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate --vars pass_: password1234', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:31.726061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B27F51040>]}
[0m15:42:31.816890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B28064400>]}
[0m15:42:31.819916 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m15:42:31.843022 [debug] [MainThread]: checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, vars: {'pass_': 'password1234'}, profile: , target: , version: 1.7.11
[0m15:42:31.943370 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:42:31.945184 [debug] [MainThread]: previous checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba, current checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7
[0m15:42:31.946255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B27F92F10>]}
[0m15:42:33.937742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B287DB0D0>]}
[0m15:42:33.945731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B2869BE20>]}
[0m15:42:33.947810 [info ] [MainThread]: Found 14 models, 12 tests, 7 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m15:42:33.949808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B282BEB20>]}
[0m15:42:33.953830 [info ] [MainThread]: 
[0m15:42:33.956689 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:33.961742 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_orbit_mds_dev_core'
[0m15:42:33.975855 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_JAFFLE_SHOP_CORE'
[0m15:42:33.974845 [debug] [ThreadPool]: Using snowflake connection "list_orbit_mds_dev_core"
[0m15:42:33.981900 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_CORE"
[0m15:42:33.983105 [debug] [ThreadPool]: On list_orbit_mds_dev_core: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_orbit_mds_dev_core"} */
show terse objects in orbit_mds_dev.core limit 10000
[0m15:42:33.984879 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_CORE"} */
show terse objects in JAFFLE_SHOP.CORE limit 10000
[0m15:42:33.986624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:33.987988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:36.412757 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m15:42:36.414757 [debug] [ThreadPool]: On list_JAFFLE_SHOP_CORE: Close
[0m15:42:36.418982 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.0 seconds
[0m15:42:36.422966 [debug] [ThreadPool]: On list_orbit_mds_dev_core: Close
[0m15:42:37.064650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_orbit_mds_dev_core, now list_JAFFLE_SHOP_INTERMEDIATE)
[0m15:42:37.066429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_JAFFLE_SHOP_CORE, now list_JAFFLE_SHOP_RAW)
[0m15:42:37.075454 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_INTERMEDIATE"
[0m15:42:37.080446 [debug] [ThreadPool]: Using snowflake connection "list_JAFFLE_SHOP_RAW"
[0m15:42:37.082446 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_INTERMEDIATE"} */
show terse objects in JAFFLE_SHOP.INTERMEDIATE limit 10000
[0m15:42:37.083536 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "list_JAFFLE_SHOP_RAW"} */
show terse objects in JAFFLE_SHOP.RAW limit 10000
[0m15:42:37.084447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:37.086019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:38.736964 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m15:42:38.739904 [debug] [ThreadPool]: On list_JAFFLE_SHOP_INTERMEDIATE: Close
[0m15:42:38.852067 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 2.0 seconds
[0m15:42:38.854072 [debug] [ThreadPool]: On list_JAFFLE_SHOP_RAW: Close
[0m15:42:39.391045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71181c20-f581-4e75-aa14-5dd188fb8bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B287DB4C0>]}
[0m15:42:39.392797 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m15:42:39.394773 [info ] [MainThread]: 
[0m15:42:39.412310 [debug] [Thread-1  ]: Began running node model.dbt_jaffle_shop.dates
[0m15:42:39.413431 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_customers
[0m15:42:39.415316 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.dates'
[0m15:42:39.418292 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_jaffle_shop.stg_customers'
[0m15:42:39.420456 [debug] [Thread-1  ]: Began compiling node model.dbt_jaffle_shop.dates
[0m15:42:39.422305 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_customers
[0m15:42:39.433248 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_jaffle_shop.dates"
[0m15:42:39.438931 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_customers"
[0m15:42:39.440920 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "node_id": "model.dbt_jaffle_shop.dates"} */
select datediff(
        day,
        cast('2018-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m15:42:39.442935 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:42:39.443911 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (compile): 15:42:39.434174 => 15:42:39.443911
[0m15:42:39.449745 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_customers
[0m15:42:39.451475 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_customers (execute): 15:42:39.450487 => 15:42:39.450487
[0m15:42:39.454476 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_customers
[0m15:42:39.455545 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_products
[0m15:42:39.457854 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_customers, now model.dbt_jaffle_shop.stg_products)
[0m15:42:39.458621 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_products
[0m15:42:39.464626 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_products"
[0m15:42:39.466858 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (compile): 15:42:39.459617 => 15:42:39.466261
[0m15:42:39.468794 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_products
[0m15:42:39.469873 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_products (execute): 15:42:39.469796 => 15:42:39.469796
[0m15:42:39.472805 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_products
[0m15:42:39.473804 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_request_approvals
[0m15:42:39.475807 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_products, now model.dbt_jaffle_shop.stg_request_approvals)
[0m15:42:39.476808 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_request_approvals
[0m15:42:39.481851 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_request_approvals"
[0m15:42:39.484129 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (compile): 15:42:39.478054 => 15:42:39.484129
[0m15:42:39.485842 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_request_approvals
[0m15:42:39.486760 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_request_approvals (execute): 15:42:39.486760 => 15:42:39.486760
[0m15:42:39.489311 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_request_approvals
[0m15:42:39.490307 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_salesorders
[0m15:42:39.493413 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_request_approvals, now model.dbt_jaffle_shop.stg_salesorders)
[0m15:42:39.494314 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_salesorders
[0m15:42:39.502320 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_salesorders"
[0m15:42:39.504409 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (compile): 15:42:39.495320 => 15:42:39.503414
[0m15:42:39.505316 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_salesorders
[0m15:42:39.506328 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_salesorders (execute): 15:42:39.506328 => 15:42:39.506328
[0m15:42:39.509677 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_salesorders
[0m15:42:39.511687 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_stores
[0m15:42:39.513689 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_salesorders, now model.dbt_jaffle_shop.stg_stores)
[0m15:42:39.515155 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_stores
[0m15:42:39.521684 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_stores"
[0m15:42:39.524677 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (compile): 15:42:39.515718 => 15:42:39.523669
[0m15:42:39.525686 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_stores
[0m15:42:39.526684 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_stores (execute): 15:42:39.526684 => 15:42:39.526684
[0m15:42:39.528687 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_stores
[0m15:42:39.530328 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.stg_supplies
[0m15:42:39.531675 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_stores, now model.dbt_jaffle_shop.stg_supplies)
[0m15:42:39.532718 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.stg_supplies
[0m15:42:39.539334 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.stg_supplies"
[0m15:42:39.541231 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (compile): 15:42:39.533831 => 15:42:39.540228
[0m15:42:39.542566 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.stg_supplies
[0m15:42:39.544441 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.stg_supplies (execute): 15:42:39.543236 => 15:42:39.543236
[0m15:42:39.546230 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.stg_supplies
[0m15:42:39.547227 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m15:42:39.549225 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.stg_supplies, now model.dbt_jaffle_shop.tf_requests_approvals_v2)
[0m15:42:39.550229 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m15:42:39.560367 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals_v2"
[0m15:42:39.563363 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (compile): 15:42:39.551232 => 15:42:39.562362
[0m15:42:39.564364 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m15:42:39.565368 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals_v2 (execute): 15:42:39.564364 => 15:42:39.564364
[0m15:42:39.566370 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals_v2
[0m15:42:39.567621 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m15:42:39.569643 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals_v2, now test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d)
[0m15:42:39.570643 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m15:42:39.578191 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d"
[0m15:42:39.581314 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d (compile): 15:42:39.571639 => 15:42:39.580205
[0m15:42:39.582385 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m15:42:39.584219 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d (execute): 15:42:39.583213 => 15:42:39.583213
[0m15:42:39.587285 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d
[0m15:42:39.588390 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_customers
[0m15:42:39.590262 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.source_relationships_jaffle_shop_raw_orders_customer__id__source_jaffle_shop_raw_customers_.10dbe1954d, now model.dbt_jaffle_shop.dim_customers)
[0m15:42:39.592256 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_customers
[0m15:42:39.599261 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_customers"
[0m15:42:39.601261 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (compile): 15:42:39.593261 => 15:42:39.601261
[0m15:42:39.603263 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_customers
[0m15:42:39.604362 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_customers (execute): 15:42:39.604362 => 15:42:39.604362
[0m15:42:39.606270 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_customers
[0m15:42:39.607356 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_products
[0m15:42:39.610308 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_customers, now model.dbt_jaffle_shop.dim_products)
[0m15:42:39.611303 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_products
[0m15:42:39.618335 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_products"
[0m15:42:39.620327 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (compile): 15:42:39.612310 => 15:42:39.619326
[0m15:42:39.621335 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_products
[0m15:42:39.622325 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_products (execute): 15:42:39.622325 => 15:42:39.622325
[0m15:42:39.624338 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_products
[0m15:42:39.625329 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:42:39.628372 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_products, now model.dbt_jaffle_shop.tf_requests_approvals)
[0m15:42:39.629372 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:42:39.636829 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.tf_requests_approvals"
[0m15:42:39.639587 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (compile): 15:42:39.630389 => 15:42:39.639033
[0m15:42:39.641272 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:42:39.642373 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.tf_requests_approvals (execute): 15:42:39.641835 => 15:42:39.641835
[0m15:42:39.644685 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.tf_requests_approvals
[0m15:42:39.645755 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.fact_orders
[0m15:42:39.648123 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.tf_requests_approvals, now model.dbt_jaffle_shop.fact_orders)
[0m15:42:39.649315 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.fact_orders
[0m15:42:39.660917 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.fact_orders"
[0m15:42:39.662635 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.fact_orders (compile): 15:42:39.650474 => 15:42:39.662037
[0m15:42:39.663797 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.fact_orders
[0m15:42:39.664880 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.fact_orders (execute): 15:42:39.664361 => 15:42:39.664361
[0m15:42:39.667173 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.fact_orders
[0m15:42:39.668960 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_stores
[0m15:42:39.671348 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.fact_orders, now model.dbt_jaffle_shop.dim_stores)
[0m15:42:39.672496 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_stores
[0m15:42:39.679746 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_stores"
[0m15:42:39.682001 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (compile): 15:42:39.673725 => 15:42:39.681428
[0m15:42:39.683130 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_stores
[0m15:42:39.684205 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_stores (execute): 15:42:39.683691 => 15:42:39.683691
[0m15:42:39.685940 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_stores
[0m15:42:39.687112 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m15:42:39.689549 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_jaffle_shop.dim_stores, now test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411)
[0m15:42:39.690687 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m15:42:39.703808 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411"
[0m15:42:39.705421 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (compile): 15:42:39.691350 => 15:42:39.705421
[0m15:42:39.707092 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m15:42:39.708268 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411 (execute): 15:42:39.707647 => 15:42:39.708209
[0m15:42:39.711128 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411
[0m15:42:39.712842 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m15:42:39.714702 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_customers_customer_key.4bebfb3411, now test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e)
[0m15:42:39.715250 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m15:42:39.725558 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e"
[0m15:42:39.727820 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (compile): 15:42:39.715850 => 15:42:39.727226
[0m15:42:39.729255 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m15:42:39.729792 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e (execute): 15:42:39.729792 => 15:42:39.729792
[0m15:42:39.732396 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e
[0m15:42:39.733433 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m15:42:39.735453 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_customers_customer_key.ad8156656e, now test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a)
[0m15:42:39.736609 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m15:42:39.744604 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a"
[0m15:42:39.746491 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (compile): 15:42:39.737523 => 15:42:39.746193
[0m15:42:39.747511 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m15:42:39.748662 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a (execute): 15:42:39.748508 => 15:42:39.748508
[0m15:42:39.750392 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a
[0m15:42:39.752159 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m15:42:39.754466 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_products_product_key.a98dfddb9a, now test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652)
[0m15:42:39.754978 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m15:42:39.762622 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652"
[0m15:42:39.764606 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (compile): 15:42:39.756001 => 15:42:39.763981
[0m15:42:39.766337 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m15:42:39.767901 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652 (execute): 15:42:39.766860 => 15:42:39.766860
[0m15:42:39.769532 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652
[0m15:42:39.770897 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m15:42:39.772143 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_products_product_key.5837b56652, now test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259)
[0m15:42:39.774174 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m15:42:39.782292 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259"
[0m15:42:39.784388 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259 (compile): 15:42:39.774174 => 15:42:39.784095
[0m15:42:39.785299 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m15:42:39.787006 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259 (execute): 15:42:39.786298 => 15:42:39.786298
[0m15:42:39.789284 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259
[0m15:42:39.790032 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m15:42:39.792028 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_fact_orders_orders_key.52aad58259, now test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94)
[0m15:42:39.793029 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m15:42:39.804858 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94"
[0m15:42:39.807866 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (compile): 15:42:39.794031 => 15:42:39.807132
[0m15:42:39.809524 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m15:42:39.810507 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94 (execute): 15:42:39.810507 => 15:42:39.810507
[0m15:42:39.812521 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94
[0m15:42:39.813783 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m15:42:39.815503 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_customer_key__customer_key__ref_dim_customers_.27f3f75b94, now test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36)
[0m15:42:39.816500 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m15:42:39.824499 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36"
[0m15:42:39.826871 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (compile): 15:42:39.816500 => 15:42:39.826073
[0m15:42:39.828245 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m15:42:39.829884 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36 (execute): 15:42:39.828909 => 15:42:39.828909
[0m15:42:39.831891 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36
[0m15:42:39.832885 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m15:42:39.834890 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_product_key__product_key__ref_dim_products_.bc8e7ded36, now test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b)
[0m15:42:39.836886 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m15:42:39.843504 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b"
[0m15:42:39.846716 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b (compile): 15:42:39.837519 => 15:42:39.845568
[0m15:42:39.848700 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m15:42:39.850695 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b (execute): 15:42:39.849818 => 15:42:39.849818
[0m15:42:39.852693 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b
[0m15:42:39.853746 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m15:42:39.855702 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_fact_orders_orders_key.98d19fe28b, now test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e)
[0m15:42:39.856908 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m15:42:39.863899 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e"
[0m15:42:39.866339 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (compile): 15:42:39.858246 => 15:42:39.865781
[0m15:42:39.867917 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m15:42:39.868911 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e (execute): 15:42:39.868911 => 15:42:39.868911
[0m15:42:39.870913 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e
[0m15:42:39.872372 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m15:42:39.873992 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.not_null_dim_stores_store_key.5820f7371e, now test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5)
[0m15:42:39.874983 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m15:42:39.883190 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5"
[0m15:42:39.885194 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (compile): 15:42:39.874983 => 15:42:39.884505
[0m15:42:39.887218 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m15:42:39.887893 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5 (execute): 15:42:39.887893 => 15:42:39.887893
[0m15:42:39.890613 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5
[0m15:42:39.891899 [debug] [Thread-2  ]: Began running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m15:42:39.893909 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.relationships_fact_orders_store_key__store_key__ref_dim_stores_.8077f277e5, now test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53)
[0m15:42:39.895088 [debug] [Thread-2  ]: Began compiling node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m15:42:39.903890 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53"
[0m15:42:39.906211 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (compile): 15:42:39.895895 => 15:42:39.905700
[0m15:42:39.907790 [debug] [Thread-2  ]: Began executing node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m15:42:39.909197 [debug] [Thread-2  ]: Timing info for test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53 (execute): 15:42:39.908805 => 15:42:39.908805
[0m15:42:39.911797 [debug] [Thread-2  ]: Finished running node test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53
[0m15:42:41.724475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:42:41.746422 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dates"
[0m15:42:41.748987 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (compile): 15:42:39.423325 => 15:42:41.748381
[0m15:42:41.750073 [debug] [Thread-1  ]: Began executing node model.dbt_jaffle_shop.dates
[0m15:42:41.751170 [debug] [Thread-1  ]: Timing info for model.dbt_jaffle_shop.dates (execute): 15:42:41.751039 => 15:42:41.751039
[0m15:42:41.752237 [debug] [Thread-1  ]: On model.dbt_jaffle_shop.dates: Close
[0m15:42:42.269382 [debug] [Thread-1  ]: Finished running node model.dbt_jaffle_shop.dates
[0m15:42:42.270545 [debug] [Thread-2  ]: Began running node model.dbt_jaffle_shop.dim_date
[0m15:42:42.272366 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_jaffle_shop.unique_dim_stores_store_key.d146828e53, now model.dbt_jaffle_shop.dim_date)
[0m15:42:42.274381 [debug] [Thread-2  ]: Began compiling node model.dbt_jaffle_shop.dim_date
[0m15:42:42.280398 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_jaffle_shop.dim_date"
[0m15:42:42.281484 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (compile): 15:42:42.275381 => 15:42:42.281484
[0m15:42:42.282399 [debug] [Thread-2  ]: Began executing node model.dbt_jaffle_shop.dim_date
[0m15:42:42.283396 [debug] [Thread-2  ]: Timing info for model.dbt_jaffle_shop.dim_date (execute): 15:42:42.283396 => 15:42:42.283396
[0m15:42:42.285402 [debug] [Thread-2  ]: Finished running node model.dbt_jaffle_shop.dim_date
[0m15:42:42.287406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:42.289418 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_INTERMEDIATE' was properly closed.
[0m15:42:42.290783 [debug] [MainThread]: Connection 'list_JAFFLE_SHOP_RAW' was properly closed.
[0m15:42:42.291402 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dates' was properly closed.
[0m15:42:42.292412 [debug] [MainThread]: Connection 'model.dbt_jaffle_shop.dim_date' was properly closed.
[0m15:42:42.297053 [debug] [MainThread]: Command end result
[0m15:42:42.464397 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m15:42:42.464397 [info ] [MainThread]: Building catalog
[0m15:42:42.473463 [debug] [ThreadPool]: Acquiring new snowflake connection 'JAFFLE_SHOP.information_schema'
[0m15:42:42.475408 [debug] [ThreadPool]: Acquiring new snowflake connection 'orbit_mds_dev.information_schema'
[0m15:42:42.498079 [debug] [ThreadPool]: Using snowflake connection "JAFFLE_SHOP.information_schema"
[0m15:42:42.505726 [debug] [ThreadPool]: Using snowflake connection "orbit_mds_dev.information_schema"
[0m15:42:42.507764 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "JAFFLE_SHOP.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_products')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_stores')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_date')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_products')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_items')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_products')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_salesorders')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('fact_orders')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_stores')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dates')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_stores')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_customers')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from JAFFLE_SHOP.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_products')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_stores')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_date')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_orders')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_products')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_customers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_items')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('raw_products')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_salesorders')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_supplies')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('fact_orders')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_stores')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dates')
                )
             or 
                (
                    upper("table_schema") = upper('INTERMEDIATE')
                    and upper("table_name") = upper('stg_stores')
                )
             or 
                (
                    upper("table_schema") = upper('CORE')
                    and upper("table_name") = upper('dim_customers')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m15:42:42.509763 [debug] [ThreadPool]: On orbit_mds_dev.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_jaffle_shop", "target_name": "RAW", "connection_name": "orbit_mds_dev.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from orbit_mds_dev.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('core')
                    and upper("table_name") = upper('tf_requests_approvals')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('requests_approvals')
                )
             or 
                (
                    upper("table_schema") = upper('core')
                    and upper("table_name") = upper('tf_requests_approvals_v2')
                )
             or 
                (
                    upper("table_schema") = upper('core')
                    and upper("table_name") = upper('stg_request_approvals')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from orbit_mds_dev.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('core')
                    and upper("table_name") = upper('tf_requests_approvals')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('requests_approvals')
                )
             or 
                (
                    upper("table_schema") = upper('core')
                    and upper("table_name") = upper('tf_requests_approvals_v2')
                )
             or 
                (
                    upper("table_schema") = upper('core')
                    and upper("table_name") = upper('stg_request_approvals')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m15:42:42.511767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:42.512802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:46.617046 [debug] [ThreadPool]: SQL status: SUCCESS 40 in 4.0 seconds
[0m15:42:46.628671 [debug] [ThreadPool]: On orbit_mds_dev.information_schema: Close
[0m15:42:47.766548 [debug] [ThreadPool]: SQL status: SUCCESS 177 in 5.0 seconds
[0m15:42:48.890696 [debug] [ThreadPool]: On JAFFLE_SHOP.information_schema: Close
[0m15:42:49.459893 [info ] [MainThread]: Catalog written to C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Data Engineering\First DE Project\MDS-for-Quality-Pipelines\dbt_jaffle_shop\target\catalog.json
[0m15:42:49.464898 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:42:49.463893 after 19.25 seconds
[0m15:42:49.464898 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:42:49.466491 [debug] [MainThread]: Connection 'JAFFLE_SHOP.information_schema' was properly closed.
[0m15:42:49.466735 [debug] [MainThread]: Connection 'orbit_mds_dev.information_schema' was properly closed.
[0m15:42:49.468527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B04911430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B28ABACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B27F51040>]}
[0m15:42:49.469522 [debug] [MainThread]: Flushing usage events
[0m16:05:30.619763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6405BD8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F642DEFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F63F46EB50>]}


============================== 16:05:30.625761 | fc0e1a43-ecdc-4af9-a35b-7d3edb093ccd ==============================
[0m16:05:30.625761 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:05:30.628209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Thinkbook 14\\.dbt', 'log_path': 'C:\\Users\\Thinkbook 14\\OneDrive - University of Lagos\\My Docs\\Data Engineering\\First DE Project\\MDS-for-Quality-Pipelines\\dbt_jaffle_shop\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:32.040307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc0e1a43-ecdc-4af9-a35b-7d3edb093ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F63F483730>]}
[0m16:05:32.166844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc0e1a43-ecdc-4af9-a35b-7d3edb093ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F663C52070>]}
[0m22:34:49.967427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206C1C87220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206C4470D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206C4470DC0>]}


============================== 22:34:49.975892 | c2e22612-d839-46f0-9d0c-403cdb768d46 ==============================
[0m22:34:49.975892 [info ] [MainThread]: Running with dbt=1.7.11
[0m22:34:49.980261 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt docs generate --profiles-dir ./dbt_autocheck --project-dir ./dbt_autocheck', 'log_path': 'dbt_autocheck\\logs', 'indirect_selection': 'eager', 'profiles_dir': './dbt_autocheck', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True'}
[0m22:34:53.390053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206C0E28430>]}
[0m22:34:53.767813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5359A30>]}
[0m22:34:53.779577 [info ] [MainThread]: Registered adapter: snowflake=1.7.3
[0m22:34:53.854841 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m22:34:54.012774 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m22:34:54.015794 [debug] [MainThread]: previous checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, current checksum: 1dc45497f44b89f86089ce57776dd02606c5e822f839572748e1735eebfd69ba
[0m22:34:54.017936 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:34:54.021072 [info ] [MainThread]: Unable to do partial parsing because env vars used in profiles.yml have changed
[0m22:34:54.024043 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:34:54.027171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E531A4C0>]}
[0m22:35:00.484616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5C4D0D0>]}
[0m22:35:00.498284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5ABCD30>]}
[0m22:35:00.502091 [info ] [MainThread]: Found 11 models, 8 tests, 4 sources, 0 exposures, 0 metrics, 677 macros, 0 groups, 0 semantic models
[0m22:35:00.506265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E53FFCD0>]}
[0m22:35:00.516583 [info ] [MainThread]: 
[0m22:35:00.521207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:35:00.532365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AUTOCHECK_RAW'
[0m22:35:00.571366 [debug] [ThreadPool]: Using snowflake connection "list_AUTOCHECK_RAW"
[0m22:35:00.574534 [debug] [ThreadPool]: On list_AUTOCHECK_RAW: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_autocheck", "target_name": "RAW", "connection_name": "list_AUTOCHECK_RAW"} */
show terse objects in AUTOCHECK.RAW limit 10000
[0m22:35:00.577453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:06.335742 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 6.0 seconds
[0m22:35:06.338730 [debug] [ThreadPool]: On list_AUTOCHECK_RAW: Close
[0m22:35:06.912281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2e22612-d839-46f0-9d0c-403cdb768d46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E5C5C250>]}
[0m22:35:06.916518 [info ] [MainThread]: Concurrency: 2 threads (target='RAW')
[0m22:35:06.919823 [info ] [MainThread]: 
[0m22:35:06.932662 [debug] [Thread-1  ]: Began running node model.dbt_autocheck.dates
[0m22:35:06.935555 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.stg_borrowers
[0m22:35:06.940889 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.dbt_autocheck.dates'
[0m22:35:06.944443 [debug] [Thread-2  ]: Acquiring new snowflake connection 'model.dbt_autocheck.stg_borrowers'
[0m22:35:06.949293 [debug] [Thread-1  ]: Began compiling node model.dbt_autocheck.dates
[0m22:35:06.952364 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.stg_borrowers
[0m22:35:06.981122 [debug] [Thread-1  ]: Using snowflake connection "model.dbt_autocheck.dates"
[0m22:35:06.984147 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.stg_borrowers"
[0m22:35:06.993962 [debug] [Thread-1  ]: On model.dbt_autocheck.dates: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_autocheck", "target_name": "RAW", "node_id": "model.dbt_autocheck.dates"} */
select datediff(
        day,
        cast('2021-01-01' as timestamp),
        cast('2025-12-31' as timestamp)
        )
[0m22:35:06.997843 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m22:35:07.006374 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_borrowers (compile): 22:35:06.982158 => 22:35:07.006071
[0m22:35:07.008960 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.stg_borrowers
[0m22:35:07.011968 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_borrowers (execute): 22:35:07.010960 => 22:35:07.010960
[0m22:35:07.012966 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.stg_borrowers
[0m22:35:07.018698 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.stg_loan_repayments
[0m22:35:07.022713 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.stg_borrowers, now model.dbt_autocheck.stg_loan_repayments)
[0m22:35:07.023713 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.stg_loan_repayments
[0m22:35:07.035205 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.stg_loan_repayments"
[0m22:35:07.038063 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_loan_repayments (compile): 22:35:07.023713 => 22:35:07.038063
[0m22:35:07.040650 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.stg_loan_repayments
[0m22:35:07.043623 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_loan_repayments (execute): 22:35:07.041656 => 22:35:07.042649
[0m22:35:07.048006 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.stg_loan_repayments
[0m22:35:07.053011 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.stg_loan_schedule
[0m22:35:07.055866 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.stg_loan_repayments, now model.dbt_autocheck.stg_loan_schedule)
[0m22:35:07.058672 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.stg_loan_schedule
[0m22:35:07.068010 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.stg_loan_schedule"
[0m22:35:07.075811 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_loan_schedule (compile): 22:35:07.061775 => 22:35:07.074815
[0m22:35:07.078065 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.stg_loan_schedule
[0m22:35:07.080090 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_loan_schedule (execute): 22:35:07.080090 => 22:35:07.080090
[0m22:35:07.084384 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.stg_loan_schedule
[0m22:35:07.086737 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.stg_loans
[0m22:35:07.088779 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.stg_loan_schedule, now model.dbt_autocheck.stg_loans)
[0m22:35:07.092403 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.stg_loans
[0m22:35:07.105124 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.stg_loans"
[0m22:35:07.109714 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_loans (compile): 22:35:07.093398 => 22:35:07.107378
[0m22:35:07.111554 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.stg_loans
[0m22:35:07.116275 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.stg_loans (execute): 22:35:07.114016 => 22:35:07.115034
[0m22:35:07.122687 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.stg_loans
[0m22:35:07.125677 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.int_borrower_repayments
[0m22:35:07.131608 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.stg_loans, now model.dbt_autocheck.int_borrower_repayments)
[0m22:35:07.134382 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.int_borrower_repayments
[0m22:35:07.150046 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.int_borrower_repayments"
[0m22:35:07.156361 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.int_borrower_repayments (compile): 22:35:07.137088 => 22:35:07.154334
[0m22:35:07.159536 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.int_borrower_repayments
[0m22:35:07.163294 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.int_borrower_repayments (execute): 22:35:07.161589 => 22:35:07.161589
[0m22:35:07.168377 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.int_borrower_repayments
[0m22:35:07.171373 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.int_borrower_loans
[0m22:35:07.174395 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.int_borrower_repayments, now model.dbt_autocheck.int_borrower_loans)
[0m22:35:07.176602 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.int_borrower_loans
[0m22:35:07.187617 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.int_borrower_loans"
[0m22:35:07.192000 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.int_borrower_loans (compile): 22:35:07.178170 => 22:35:07.190874
[0m22:35:07.194007 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.int_borrower_loans
[0m22:35:07.197927 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.int_borrower_loans (execute): 22:35:07.196102 => 22:35:07.196636
[0m22:35:07.202825 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.int_borrower_loans
[0m22:35:07.206368 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.fct_repayments
[0m22:35:07.209853 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.int_borrower_loans, now model.dbt_autocheck.fct_repayments)
[0m22:35:07.213156 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.fct_repayments
[0m22:35:07.234829 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.fct_repayments"
[0m22:35:07.239107 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.fct_repayments (compile): 22:35:07.214991 => 22:35:07.238109
[0m22:35:07.241161 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.fct_repayments
[0m22:35:07.254754 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.fct_repayments (execute): 22:35:07.246625 => 22:35:07.246625
[0m22:35:07.256557 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.fct_repayments
[0m22:35:07.261841 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.int_missed_payments
[0m22:35:07.265503 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.fct_repayments, now model.dbt_autocheck.int_missed_payments)
[0m22:35:07.266514 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.int_missed_payments
[0m22:35:07.278916 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.int_missed_payments"
[0m22:35:07.295580 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.int_missed_payments (compile): 22:35:07.269875 => 22:35:07.293576
[0m22:35:07.298581 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.int_missed_payments
[0m22:35:07.301581 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.int_missed_payments (execute): 22:35:07.300580 => 22:35:07.300580
[0m22:35:07.306112 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.int_missed_payments
[0m22:35:07.307142 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.dim_loans
[0m22:35:07.313611 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.int_missed_payments, now model.dbt_autocheck.dim_loans)
[0m22:35:07.316619 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.dim_loans
[0m22:35:07.332928 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.dim_loans"
[0m22:35:07.342854 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.dim_loans (compile): 22:35:07.318235 => 22:35:07.341605
[0m22:35:07.345873 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.dim_loans
[0m22:35:07.346867 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.dim_loans (execute): 22:35:07.346867 => 22:35:07.346867
[0m22:35:07.351696 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.dim_loans
[0m22:35:07.351696 [debug] [Thread-2  ]: Began running node test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f
[0m22:35:07.357900 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.dim_loans, now test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f)
[0m22:35:07.360453 [debug] [Thread-2  ]: Began compiling node test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f
[0m22:35:07.383744 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f"
[0m22:35:07.394856 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f (compile): 22:35:07.362582 => 22:35:07.392782
[0m22:35:07.399328 [debug] [Thread-2  ]: Began executing node test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f
[0m22:35:07.401337 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f (execute): 22:35:07.400330 => 22:35:07.400330
[0m22:35:07.405344 [debug] [Thread-2  ]: Finished running node test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f
[0m22:35:07.408314 [debug] [Thread-2  ]: Began running node test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f
[0m22:35:07.413388 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_autocheck.not_null_fct_repayments_schedule_payments_key.60d799714f, now test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f)
[0m22:35:07.417188 [debug] [Thread-2  ]: Began compiling node test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f
[0m22:35:07.431562 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f"
[0m22:35:07.440754 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f (compile): 22:35:07.418213 => 22:35:07.439744
[0m22:35:07.443751 [debug] [Thread-2  ]: Began executing node test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f
[0m22:35:07.447545 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f (execute): 22:35:07.446746 => 22:35:07.446746
[0m22:35:07.451620 [debug] [Thread-2  ]: Finished running node test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f
[0m22:35:07.453464 [debug] [Thread-2  ]: Began running node test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c
[0m22:35:07.456644 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_autocheck.unique_fct_repayments_schedule_payments_key.a7b3b4290f, now test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c)
[0m22:35:07.458239 [debug] [Thread-2  ]: Began compiling node test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c
[0m22:35:07.480557 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c"
[0m22:35:07.484922 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c (compile): 22:35:07.461249 => 22:35:07.483946
[0m22:35:07.488733 [debug] [Thread-2  ]: Began executing node test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c
[0m22:35:07.491747 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c (execute): 22:35:07.490748 => 22:35:07.490748
[0m22:35:07.494831 [debug] [Thread-2  ]: Finished running node test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c
[0m22:35:07.497655 [debug] [Thread-2  ]: Began running node test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0
[0m22:35:07.501464 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_autocheck.not_null_dim_loans_loan_key.dc2e1daa8c, now test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0)
[0m22:35:07.501464 [debug] [Thread-2  ]: Began compiling node test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0
[0m22:35:07.524172 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0"
[0m22:35:07.529145 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0 (compile): 22:35:07.505127 => 22:35:07.528138
[0m22:35:07.532732 [debug] [Thread-2  ]: Began executing node test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0
[0m22:35:07.534493 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0 (execute): 22:35:07.533742 => 22:35:07.533742
[0m22:35:07.539497 [debug] [Thread-2  ]: Finished running node test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0
[0m22:35:07.541494 [debug] [Thread-2  ]: Began running node test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a
[0m22:35:07.546495 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_autocheck.relationships_fct_repayments_loan_key__loan_key__ref_dim_loans_.6ef41ed3a0, now test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a)
[0m22:35:07.549467 [debug] [Thread-2  ]: Began compiling node test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a
[0m22:35:07.567341 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a"
[0m22:35:07.572550 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a (compile): 22:35:07.551472 => 22:35:07.571033
[0m22:35:07.575791 [debug] [Thread-2  ]: Began executing node test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a
[0m22:35:07.580352 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a (execute): 22:35:07.578878 => 22:35:07.578878
[0m22:35:07.585559 [debug] [Thread-2  ]: Finished running node test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a
[0m22:35:09.262104 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:35:09.335153 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_autocheck.dates"
[0m22:35:09.340435 [debug] [Thread-1  ]: Timing info for model.dbt_autocheck.dates (compile): 22:35:06.954543 => 22:35:09.339424
[0m22:35:09.343601 [debug] [Thread-1  ]: Began executing node model.dbt_autocheck.dates
[0m22:35:09.346355 [debug] [Thread-1  ]: Timing info for model.dbt_autocheck.dates (execute): 22:35:09.345343 => 22:35:09.345343
[0m22:35:09.349586 [debug] [Thread-1  ]: On model.dbt_autocheck.dates: Close
[0m22:35:09.899262 [debug] [Thread-1  ]: Finished running node model.dbt_autocheck.dates
[0m22:35:09.906365 [debug] [Thread-2  ]: Began running node model.dbt_autocheck.dim_date
[0m22:35:09.910144 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.dbt_autocheck.unique_dim_loans_loan_key.e700ab298a, now model.dbt_autocheck.dim_date)
[0m22:35:09.912714 [debug] [Thread-2  ]: Began compiling node model.dbt_autocheck.dim_date
[0m22:35:09.916354 [debug] [Thread-2  ]: Writing injected SQL for node "model.dbt_autocheck.dim_date"
[0m22:35:09.927625 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.dim_date (compile): 22:35:09.914338 => 22:35:09.927625
[0m22:35:09.933760 [debug] [Thread-2  ]: Began executing node model.dbt_autocheck.dim_date
[0m22:35:09.935128 [debug] [Thread-2  ]: Timing info for model.dbt_autocheck.dim_date (execute): 22:35:09.935128 => 22:35:09.935128
[0m22:35:09.939758 [debug] [Thread-2  ]: Finished running node model.dbt_autocheck.dim_date
[0m22:35:09.943074 [debug] [Thread-1  ]: Began running node test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6
[0m22:35:09.946233 [debug] [Thread-2  ]: Began running node test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9
[0m22:35:09.949484 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.dates, now test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6)
[0m22:35:09.952503 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.dbt_autocheck.dim_date, now test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9)
[0m22:35:09.955233 [debug] [Thread-1  ]: Began compiling node test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6
[0m22:35:09.957878 [debug] [Thread-2  ]: Began compiling node test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9
[0m22:35:09.970426 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6"
[0m22:35:09.983241 [debug] [Thread-2  ]: Writing injected SQL for node "test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9"
[0m22:35:09.993343 [debug] [Thread-1  ]: Timing info for test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6 (compile): 22:35:09.959892 => 22:35:09.992334
[0m22:35:09.993343 [debug] [Thread-1  ]: Began executing node test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6
[0m22:35:10.001734 [debug] [Thread-1  ]: Timing info for test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6 (execute): 22:35:10.000728 => 22:35:10.000728
[0m22:35:10.003556 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9 (compile): 22:35:09.970426 => 22:35:10.001734
[0m22:35:10.007993 [debug] [Thread-1  ]: Finished running node test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6
[0m22:35:10.010525 [debug] [Thread-2  ]: Began executing node test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9
[0m22:35:10.014113 [debug] [Thread-1  ]: Began running node test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c
[0m22:35:10.016933 [debug] [Thread-2  ]: Timing info for test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9 (execute): 22:35:10.016203 => 22:35:10.016203
[0m22:35:10.020968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_autocheck.not_null_dim_date_date_key.881d0a31b6, now test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c)
[0m22:35:10.025353 [debug] [Thread-2  ]: Finished running node test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9
[0m22:35:10.029321 [debug] [Thread-1  ]: Began compiling node test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c
[0m22:35:10.034429 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c"
[0m22:35:10.051130 [debug] [Thread-1  ]: Timing info for test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c (compile): 22:35:10.032330 => 22:35:10.034429
[0m22:35:10.055429 [debug] [Thread-1  ]: Began executing node test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c
[0m22:35:10.057277 [debug] [Thread-1  ]: Timing info for test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c (execute): 22:35:10.056449 => 22:35:10.056449
[0m22:35:10.061239 [debug] [Thread-1  ]: Finished running node test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c
[0m22:35:10.065546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:10.068525 [debug] [MainThread]: Connection 'list_AUTOCHECK_RAW' was properly closed.
[0m22:35:10.070546 [debug] [MainThread]: Connection 'test.dbt_autocheck.relationships_fct_repayments_date_key__date_key__ref_dim_date_.6dcf809b9c' was properly closed.
[0m22:35:10.072011 [debug] [MainThread]: Connection 'test.dbt_autocheck.unique_dim_date_date_key.0869fd48f9' was properly closed.
[0m22:35:10.076870 [debug] [MainThread]: Command end result
[0m22:35:10.136967 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m22:35:10.138969 [info ] [MainThread]: Building catalog
[0m22:35:10.152108 [debug] [ThreadPool]: Acquiring new snowflake connection 'AUTOCHECK.information_schema'
[0m22:35:10.206883 [debug] [ThreadPool]: Using snowflake connection "AUTOCHECK.information_schema"
[0m22:35:10.210584 [debug] [ThreadPool]: On AUTOCHECK.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_autocheck", "target_name": "RAW", "connection_name": "AUTOCHECK.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AUTOCHECK.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('repayment_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_loan_schedule')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('int_borrower_repayments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_loan_repayments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('fct_repayments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_borrowers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dim_date')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dim_loans')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('loan_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_loans')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('int_borrower_loans')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('int_missed_payments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('schedule_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('borrower_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dates')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AUTOCHECK.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('repayment_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_loan_schedule')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('int_borrower_repayments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_loan_repayments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('fct_repayments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_borrowers')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dim_date')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dim_loans')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('loan_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('stg_loans')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('int_borrower_loans')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('int_missed_payments')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('schedule_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('borrower_data')
                )
             or 
                (
                    upper("table_schema") = upper('RAW')
                    and upper("table_name") = upper('dates')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m22:35:10.216644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:17.000051 [debug] [ThreadPool]: SQL status: SUCCESS 176 in 7.0 seconds
[0m22:35:19.969906 [debug] [ThreadPool]: On AUTOCHECK.information_schema: Close
[0m22:35:20.929733 [info ] [MainThread]: Catalog written to C:\Users\Thinkbook 14\OneDrive - University of Lagos\My Docs\Interview\Autocheck\autocheck-data-model\dbt_autocheck\target\catalog.json
[0m22:35:20.935735 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:35:20.935735 after 31.19 seconds
[0m22:35:20.938728 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:35:20.940188 [debug] [MainThread]: Connection 'AUTOCHECK.information_schema' was properly closed.
[0m22:35:20.942211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206C1C87220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206C0E28430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206E544FC40>]}
[0m22:35:20.945346 [debug] [MainThread]: Flushing usage events
